import{a as E,C as I,L as N,b as V,c as j,P,T as W,p as Q}from"./chart.f4078cab.js";import{t as s}from"./index.d6f7bcbe.js";import{p as U}from"./index.33f7786c.js";import{ao as n,bA as m,ch as z,ci as J,aa as Z,r as G,aY as K,c as h,bh as X,aZ as ee,bF as te,ak as re,n as w}from"./index.89815c99.js";import{a as S,g as B,i as ae,f as ne}from"./index.00406d60.js";import{a as se}from"./index.4ec6b070.js";import{a as Y}from"./index.5ca940f4.js";import{a as F}from"./index.8803d505.js";import{c as y,d as q}from"./index.3f3e6c05.js";import{s as ie}from"./index.15c058f2.js";import{B as oe}from"./BitsightSummaryOverview.8a4adacf.js";import{C as ue}from"./CisToCmmcMappingDisplay.78192ba2.js";import{R as le}from"./RiskVectorSummary.ebf80e92.js";var ce=36e5;function de(e,t){n(2,arguments);var r=m(t);return S(e,r*ce)}function $(e,t){var r,a,i,o,l,d,g,c;n(1,arguments);var u=B(),v=m((r=(a=(i=(o=t==null?void 0:t.weekStartsOn)!==null&&o!==void 0?o:t==null||(l=t.locale)===null||l===void 0||(d=l.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&i!==void 0?i:u.weekStartsOn)!==null&&a!==void 0?a:(g=u.locale)===null||g===void 0||(c=g.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&r!==void 0?r:0);if(!(v>=0&&v<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var f=s(e),p=f.getDay(),k=(p<v?7:0)+p-v;return f.setDate(f.getDate()-k),f.setHours(0,0,0,0),f}var fe=6e4;function ve(e,t){n(2,arguments);var r=m(t);return S(e,r*fe)}function ge(e,t){n(2,arguments);var r=m(t),a=r*3;return Y(e,a)}function pe(e,t){n(2,arguments);var r=m(t);return S(e,r*1e3)}function me(e,t){n(2,arguments);var r=m(t),a=r*7;return F(e,a)}function he(e,t){n(2,arguments);var r=s(e),a=s(t),i=r.getFullYear()-a.getFullYear(),o=r.getMonth()-a.getMonth();return i*12+o}function ye(e,t){n(2,arguments);var r=s(e),a=s(t);return r.getFullYear()-a.getFullYear()}function b(e,t){return n(2,arguments),s(e).getTime()-s(t).getTime()}var D={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(t){return t<0?Math.ceil(t):Math.floor(t)}},_e="trunc";function O(e){return e?D[e]:D[_e]}function Me(e,t,r){n(2,arguments);var a=b(e,t)/z;return O(r==null?void 0:r.roundingMethod)(a)}function Oe(e,t,r){n(2,arguments);var a=b(e,t)/J;return O(r==null?void 0:r.roundingMethod)(a)}function H(e){n(1,arguments);var t=s(e);return t.setHours(23,59,59,999),t}function A(e){n(1,arguments);var t=s(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function Se(e){n(1,arguments);var t=s(e);return H(t).getTime()===A(t).getTime()}function L(e,t){n(2,arguments);var r=s(e),a=s(t),i=y(r,a),o=Math.abs(he(r,a)),l;if(o<1)l=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-i*o);var d=y(r,a)===-i;Se(s(e))&&o===1&&y(e,a)===1&&(d=!1),l=i*(o-Number(d))}return l===0?0:l}function be(e,t,r){n(2,arguments);var a=L(e,t)/3;return O(r==null?void 0:r.roundingMethod)(a)}function ke(e,t,r){n(2,arguments);var a=b(e,t)/1e3;return O(r==null?void 0:r.roundingMethod)(a)}function we(e,t,r){n(2,arguments);var a=q(e,t)/7;return O(r==null?void 0:r.roundingMethod)(a)}function Ce(e,t){n(2,arguments);var r=s(e),a=s(t),i=y(r,a),o=Math.abs(ye(r,a));r.setFullYear(1584),a.setFullYear(1584);var l=y(r,a)===-i,d=i*(o-Number(l));return d===0?0:d}function $e(e){n(1,arguments);var t=s(e);return t.setSeconds(0,0),t}function De(e){n(1,arguments);var t=s(e),r=t.getMonth(),a=r-r%3;return t.setMonth(a,1),t.setHours(0,0,0,0),t}function Re(e){n(1,arguments);var t=s(e);return t.setDate(1),t.setHours(0,0,0,0),t}function Te(e){n(1,arguments);var t=s(e),r=t.getFullYear();return t.setFullYear(r+1,0,0),t.setHours(23,59,59,999),t}function xe(e){n(1,arguments);var t=s(e),r=new Date(0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function Ie(e){n(1,arguments);var t=s(e);return t.setMinutes(59,59,999),t}function Be(e,t){var r,a,i,o,l,d,g,c;n(1,arguments);var u=B(),v=m((r=(a=(i=(o=t==null?void 0:t.weekStartsOn)!==null&&o!==void 0?o:t==null||(l=t.locale)===null||l===void 0||(d=l.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&i!==void 0?i:u.weekStartsOn)!==null&&a!==void 0?a:(g=u.locale)===null||g===void 0||(c=g.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&r!==void 0?r:0);if(!(v>=0&&v<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var f=s(e),p=f.getDay(),k=(p<v?-7:0)+6-(p-v);return f.setDate(f.getDate()+k),f.setHours(23,59,59,999),f}function Ye(e){n(1,arguments);var t=s(e);return t.setSeconds(59,999),t}function Fe(e){n(1,arguments);var t=s(e),r=t.getMonth(),a=r-r%3+3;return t.setMonth(a,0),t.setHours(23,59,59,999),t}function qe(e){n(1,arguments);var t=s(e);return t.setMilliseconds(999),t}function He(e){n(1,arguments);var t=s(e);return t.setMinutes(0,0,0),t}function Ae(e){n(1,arguments);var t=s(e);return t.setMilliseconds(0),t}/*!
 * chartjs-adapter-date-fns v2.0.0
 * https://www.chartjs.org
 * (c) 2021 chartjs-adapter-date-fns Contributors
 * Released under the MIT license
 */const Le={datetime:"MMM d, yyyy, h:mm:ss aaaa",millisecond:"h:mm:ss.SSS aaaa",second:"h:mm:ss aaaa",minute:"h:mm aaaa",hour:"ha",day:"MMM d",week:"PP",month:"MMM yyyy",quarter:"qqq - yyyy",year:"yyyy"};E._date.override({_id:"date-fns",formats:function(){return Le},parse:function(e,t){if(e===null||typeof e>"u")return null;const r=typeof e;return r==="number"||e instanceof Date?e=s(e):r==="string"&&(typeof t=="string"?e=U(e,t,new Date,this.options):e=Z(e,this.options)),ae(e)?e.getTime():null},format:function(e,t){return ne(e,t,this.options)},add:function(e,t,r){switch(r){case"millisecond":return S(e,t);case"second":return pe(e,t);case"minute":return ve(e,t);case"hour":return de(e,t);case"day":return F(e,t);case"week":return me(e,t);case"month":return Y(e,t);case"quarter":return ge(e,t);case"year":return se(e,t);default:return e}},diff:function(e,t,r){switch(r){case"millisecond":return b(e,t);case"second":return ke(e,t);case"minute":return Oe(e,t);case"hour":return Me(e,t);case"day":return q(e,t);case"week":return we(e,t);case"month":return L(e,t);case"quarter":return be(e,t);case"year":return Ce(e,t);default:return 0}},startOf:function(e,t,r){switch(t){case"second":return Ae(e);case"minute":return $e(e);case"hour":return He(e);case"day":return ie(e);case"week":return $(e);case"isoWeek":return $(e,{weekStartsOn:+r});case"month":return Re(e);case"quarter":return De(e);case"year":return xe(e);default:return e}},endOf:function(e,t){switch(t){case"second":return qe(e);case"minute":return Ye(e);case"hour":return Ie(e);case"day":return H(e);case"week":return Be(e);case"month":return A(e);case"quarter":return Fe(e);case"year":return Te(e);default:return e}}});I.register(N,V,j,P,W,Q);const C=re({inheritAttrs:!1});C.props={ratingsOverTime:{key:"ratingsOverTime",required:!0,type:Array},width:{key:"width",required:!1,type:Number},height:{key:"height",required:!1,type:Number},options:{key:"options",required:!0,type:Object}};C.setup=(e,t)=>{const r=e,a=t.emit,i=G(),o=K(),l=h(()=>({width:r.width?`${r.width}px`:"100%",height:r.height?`${r.height}px`:"100%"})),d=h(()=>{var v,f;const c=(v=r.ratingsOverTime)==null?void 0:v.map(p=>p.date),u=(f=r.ratingsOverTime)==null?void 0:f.map(p=>p.score);return{labels:c,datasets:[{label:"Ratings Over Time",data:u}]}}),g=h(()=>({scales:{xAxis:{title:{display:!0,text:"Date"},type:"time",time:{unit:"month"}},yAxis:{title:{display:!0,text:"Rating"},min:250,max:900,grid:{color(c){const{value:u}=c.tick;if(u>=250&&u<=639)return"#ef4444";if(u>=640&&u<=739)return"#eab308";if(u>=740&&u<=900)return"#22c55e"}},ticks:{color(c){const{value:u}=c.tick;if(u>=250&&u<=639)return"#991b1b";if(u>=640&&u<=739)return"#854d0e";if(u>=740&&u<=900)return"#166534"},stepSize:50}}},elements:{point:{radius:2,hoverRadius:6,backgroundColor:"#3b82f6"},line:{stepped:!0,borderColor:"#bfdbfe",borderWidth:8,borderJoinStyle:"round"}},animation:{onComplete:()=>{i.value&&a("animation-complete",i.value)}},...r.options}));return X(()=>{ee(()=>{const c=i.value;!c||(o.value=new I(c,{type:"line",data:d.value,options:g.value}))})}),te(()=>{var c;(c=o.value)==null||c.destroy()}),{canvas:i,parentStyle:l}};var Ee=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"relative",style:e.parentStyle},[r("canvas",e._b({ref:"canvas",attrs:{role:"img","aria-label":"Ratings Over Time chart"}},"canvas",e.$attrs,!1))])},Ne=[];const R={};var Ve=w(C,Ee,Ne,!1,je,null,null,null);function je(e){for(let t in R)this[t]=R[t]}const Pe=function(){return Ve.exports}(),_={};_.props={value:{key:"value",required:!0,type:Array}};_.setup=(e,t)=>{const r=e;return{ratingsOverTime:h(()=>r.value.map(({rating_date:o,rating:l})=>({date:o,score:l}))),bitsightBadges:[{label:"Basic",range:"250-640",color:"bg-red-100 text-red-800"},{label:"Intermediate",range:"640-740",color:"bg-yellow-100 text-yellow-800"},{label:"Advanced",range:"740-900",color:"bg-green-100 text-green-800"}]}};_.components=Object.assign({BitsightRatingsChart:Pe},_.components);var We=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"flex flex-col p-4"},[r("div",{staticClass:"grid grid-cols-3 gap-4"},e._l(e.bitsightBadges,function(a){return r("div",{key:a.label,staticClass:"flex flex-col items-center"},[r("span",{staticClass:"inline-flex items-center rounded px-2",class:a.color},[r("BaseTypography",{staticClass:"uppercase",attrs:{variant:"subtitle2"}},[e._v(" "+e._s(a.label)+" ")])],1),r("BaseTypography",{staticClass:"text-gray-500",attrs:{variant:"p2"}},[e._v(" "+e._s(a.range)+" ")])],1)}),0),r("div",{staticClass:"h-96"},[r("BitsightRatingsChart",{attrs:{"ratings-over-time":e.ratingsOverTime,options:{maintainAspectRatio:!1,devicePixelRatio:1}}})],1)])},Qe=[];const T={};var Ue=w(_,We,Qe,!1,ze,null,null,null);function ze(e){for(let t in T)this[t]=T[t]}const Je=function(){return Ue.exports}(),M={};M.props={value:{key:"value",required:!0,type:null},mapping:{key:"mapping",required:!1,type:null}};M.setup=(e,t)=>{const r=e;return{riskVectors:h(()=>{const i={};for(const o of Object.entries(r.value.analysis)){const[l,d]=o,{grade:g}=d;i[l]={grade:g}}return i})}};M.components=Object.assign({BitsightSummaryOverview:oe,RiskVectorSummary:le,BitsightRatingsDisplay:Je,CisToCmmcMappingDisplay:ue},M.components);var Ze=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"flex flex-col space-y-6"},[r("BitsightSummaryOverview",{attrs:{rating:e.value,company:e.value.supplier.name,"show-badges":!1}}),r("BaseSimpleCard",{staticClass:"divide-y xl:col-span-1"},[r("BaseTypography",{staticClass:"p-4",attrs:{variant:"subtitle3",component:"h3"}},[e._v(" Risk Vector Analysis ")]),r("div",[r("RiskVectorSummary",{attrs:{value:e.riskVectors}})],1)],1),r("BaseSimpleCard",{staticClass:"divide-y xl:col-span-2"},[r("BaseTypography",{staticClass:"p-4",attrs:{variant:"subtitle3",component:"h3"}},[e._v(" Security Ratings Over Time ")]),r("BitsightRatingsDisplay",{attrs:{value:e.value.ratings}})],1),e.mapping?r("BaseSimpleCard",{staticClass:"divide-y overflow-auto"},[r("BaseTypography",{staticClass:"p-4",attrs:{variant:"subtitle3",component:"h3"}},[e._v(" CIS Controls Mapped to CMMC Maturity Levels ")]),r("CisToCmmcMappingDisplay",{staticClass:"w-full",attrs:{value:e.mapping}})],1):e._e()],1)},Ge=[];const x={};var Ke=w(M,Ze,Ge,!1,Xe,null,null,null);function Xe(e){for(let t in x)this[t]=x[t]}const vt=function(){return Ke.exports}();export{vt as P};
