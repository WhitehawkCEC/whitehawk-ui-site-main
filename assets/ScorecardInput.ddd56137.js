import{C as et}from"./CisToCmmcMappingDisplay.c04b9583.js";import{C as ce}from"./CollapsibleSection.ffdf6ad1.js";import{R as tt}from"./arrow-path.24b87f73.js";import{R as st}from"./RiskVectorSummary.47b3bd8c.js";import{ah as at,d as o,aP as qe,aQ as je,r as rt,bF as nt,aB as X,n as g,ax as S,az as se,ab as ot}from"./index.57286342.js";import{G as it}from"./GradeLetterDisplay.604b8eac.js";import{B as ct}from"./BitsightLevelBadge.3a0fd3bc.js";import{A as lt}from"./AnalystSelect.1447c504.js";import{T as Ne}from"./ToolTip.091d88da.js";import{O as Le}from"./ObjectDisplay.a69207a8.js";import{e as E}from"./attributeValue.ea53a720.js";import{a as ut}from"./ratingScoreDescription.3b48b1ea.js";import{h as pt,m as ge,f as dt,g as mt}from"./index.70d17be3.js";import{d as vt}from"./index.94b03143.js";import{t as _e}from"./index.89eb35cc.js";import{g as xe}from"./index.87e44ac4.js";const yt={list(e,a){return at(["companies",e,"bitsight","companies",a,"performance-evaluation"],()=>qe.get(`${je}/companies/${e.value}/bitsight/companies/${a.value}/performance-evaluation`).then(t=>t.data),{enabled:o(()=>a.value!==void 0&&e.value!==void 0)})}};function ft(e,a,t){var s,r,d,l,p,i,c,u,f,D;rt(2,arguments);var w=_e(e),T=_e(a),O=mt(),b=(s=(r=t==null?void 0:t.locale)!==null&&r!==void 0?r:O.locale)!==null&&s!==void 0?s:pt,F=nt((d=(l=(p=(i=t==null?void 0:t.weekStartsOn)!==null&&i!==void 0?i:t==null||(c=t.locale)===null||c===void 0||(u=c.options)===null||u===void 0?void 0:u.weekStartsOn)!==null&&p!==void 0?p:O.weekStartsOn)!==null&&l!==void 0?l:(f=O.locale)===null||f===void 0||(D=f.options)===null||D===void 0?void 0:D.weekStartsOn)!==null&&d!==void 0?d:0);if(!b.localize)throw new RangeError("locale must contain localize property");if(!b.formatLong)throw new RangeError("locale must contain formatLong property");if(!b.formatRelative)throw new RangeError("locale must contain formatRelative property");var x=vt(w,T);if(isNaN(x))throw new RangeError("Invalid time value");var C;x<-6?C="other":x<-1?C="lastWeek":x<0?C="yesterday":x<1?C="today":x<2?C="tomorrow":x<7?C="nextWeek":C="other";var G=ge(w,xe(w)),V=ge(T,xe(T)),Z=b.formatRelative(C,G,V,{locale:b,weekStartsOn:F});return dt(w,Z,{locale:b,weekStartsOn:F})}const le={};le.props={value:{key:"value",required:!1,type:null},options:{key:"options",required:!0,type:Array}};le.setup=(e,a)=>{const t=e,s=a.emit;return{proxy:X(t,s)}};var gt=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"flex flex-col xl:col-span-2"},[t("BaseSelect",{model:{value:e.proxy,callback:function(s){e.proxy=s},expression:"proxy"}},[t("option",{domProps:{value:null}}),e._l(e.options,function(s){return t("option",{key:s.name,domProps:{value:s}},[e._v(" "+e._s(s.name)+" ")])})],2)],1)},_t=[];const he={};var xt=g(le,gt,_t,!1,ht,null,null,null);function ht(e){for(let a in he)this[a]=he[a]}const Ct=function(){return xt.exports}(),q={};q.props={value:{key:"value",required:!0,type:Object},options:{key:"options",required:!0,type:Array}};q.setup=(e,a)=>{const t=e,s=a.emit;return{proxy:S(t,s)}};q.components=Object.assign({FocusAreaInput:Ct},q.components);var kt=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"grid divide-y xl:col-span-2"},e._l(e.proxy,function(s,r){return t("BaseLabel",{key:r,staticClass:"flex flex-col p-4 lg:grid lg:items-center xl:grid-cols-3"},[e._v(" Focus Area "+e._s(r.split("num")[1])+" "),t("div",{staticClass:"xl:col-span-2"},[t("FocusAreaInput",{staticClass:"w-full",attrs:{options:e.options},model:{value:e.proxy[r],callback:function(d){e.$set(e.proxy,r,d)},expression:"proxy[i]"}})],1)])}),1)},bt=[];const Ce={};var St=g(q,kt,bt,!1,$t,null,null,null);function $t(e){for(let a in Ce)this[a]=Ce[a]}const At=function(){return St.exports}(),ue={};ue.props={value:{key:"value",required:!1,type:String,default:""}};ue.setup=(e,a)=>{const t=e,s=a.emit;return{proxy:X(t,s)}};var Dt=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("BaseLabel",{staticClass:"flex flex-col p-4 lg:grid lg:grid-cols-3 lg:items-center"},[t("span",{staticClass:"block text-sm font-medium leading-5 text-gray-700"},[e._v(" Industry Description ")]),t("div",{staticClass:"flex flex-col lg:col-span-2"},[t("BaseTextarea",{attrs:{rows:"2"},model:{value:e.proxy,callback:function(s){e.proxy=s},expression:"proxy"}})],1)])},Bt=[];const ke={};var It=g(ue,Dt,Bt,!1,Pt,null,null,null);function Pt(e){for(let a in ke)this[a]=ke[a]}const wt=function(){return It.exports}(),pe={};pe.props={value:{key:"value",required:!1,type:null},products:{key:"products",required:!0,type:Array}};pe.setup=(e,a)=>{const t=e,s=a.emit,r=S(t,s),d=o(()=>{const c=new Map;for(const f of t.products)c.set(f.manufacturer.id,{id:f.manufacturer.id,name:f.manufacturer.name});return[...c.values()].sort((f,D)=>f.name.localeCompare(D.name))}),l=o(()=>r.value.manufacturer?t.products.filter(c=>c.manufacturer.name===r.value.manufacturer):t.products),p=o({get(){return r.value.manufacturer},set(c){r.value.manufacturer=c,r.value.product=void 0,r.value.description=void 0}}),i=o({get(){return r.value.product},set(c){r.value.product=c;const u=l.value.find(f=>f.name===c);r.value.id=u==null?void 0:u.id,r.value.description=u==null?void 0:u.description}});return{proxy:r,filteredManufacturers:d,filteredProducts:l,manufacturer:p,product:i}};var Ot=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("section",{staticClass:"flex flex-col space-y-3"},[t("BaseLabel",{staticClass:"flex flex-col space-y-1"},[e._v(" Manufacturer "),t("BaseSelect",{staticClass:"w-full",model:{value:e.manufacturer,callback:function(s){e.manufacturer=s},expression:"manufacturer"}},[t("option",{domProps:{value:null}}),e._l(e.filteredManufacturers,function(s){return t("option",{key:s.id,domProps:{value:s.name}},[e._v(" "+e._s(s.name)+" ")])})],2)],1),t("BaseLabel",{staticClass:"flex flex-col space-y-1"},[e._v(" Product "),t("BaseSelect",{staticClass:"w-full",model:{value:e.product,callback:function(s){e.product=s},expression:"product"}},[t("option",{domProps:{value:null}}),e._l(e.filteredProducts,function(s){return t("option",{key:s.id,domProps:{value:s.name}},[e._v(" "+e._s(s.name)+" ")])})],2)],1),t("BaseLabel",{staticClass:"flex flex-col space-y-1"},[e._v(" Product Description "),t("BaseTextarea",{staticClass:"block w-full resize-none",attrs:{rows:"5"},model:{value:e.proxy.description,callback:function(s){e.$set(e.proxy,"description",s)},expression:"proxy.description"}})],1)],1)},Rt=[];const be={};var Tt=g(pe,Ot,Rt,!1,Ft,null,null,null);function Ft(e){for(let a in be)this[a]=be[a]}const Mt=function(){return Tt.exports}(),j={};j.props={value:{key:"value",required:!1,type:null},title:{key:"title",required:!0,type:String},productCategories:{key:"productCategories",required:!0,type:Array},products:{key:"products",required:!0,type:Array}};j.setup=(e,a)=>{const t=e,s=a.emit,r=S(t,s),d=o({get(){return r.value.category},set(p){r.value.category=p,r.value.main=void 0,r.value.option=void 0}}),l=o(()=>r.value.category?t.products.filter(p=>p.categories.some(i=>{var c;return i.id===((c=r.value.category)==null?void 0:c.id)})):[]);return{proxy:r,category:d,productsWithSelectedCategory:l}};j.components=Object.assign({ProductInput:Mt},j.components);var Et=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("section",{staticClass:"flex flex-col divide-y"},[t("BaseTypography",{staticClass:"p-4 text-gray-600",attrs:{variant:"p1"}},[e._v(" "+e._s(e.title)+" ")]),t("BaseLabel",{staticClass:"p-4"},[e._v(" Category "),t("BaseSelect",{staticClass:"w-full",model:{value:e.category,callback:function(s){e.category=s},expression:"category"}},[t("option",{domProps:{value:null}}),e._l(e.productCategories,function(s){return t("option",{key:s.id,domProps:{value:s}},[e._v(" "+e._s(s.name)+" ")])})],2)],1),t("div",{staticClass:"flex flex-col space-y-4 divide-y lg:flex-row lg:items-center lg:justify-between lg:space-y-0 lg:divide-y-0 lg:divide-x"},[t("div",{staticClass:"flex-1 p-4"},[t("fieldset",{staticClass:"space-y-2"},[t("legend",{staticClass:"font-display font-semibold"},[e._v("Main")]),t("ProductInput",{attrs:{products:e.productsWithSelectedCategory},model:{value:e.proxy.main,callback:function(s){e.$set(e.proxy,"main",s)},expression:"proxy.main"}})],1)]),t("div",{staticClass:"flex-1 p-4"},[t("fieldset",{staticClass:"space-y-2"},[t("legend",{staticClass:"font-display font-semibold"},[e._v("Option")]),t("ProductInput",{attrs:{products:e.productsWithSelectedCategory},model:{value:e.proxy.option,callback:function(s){e.$set(e.proxy,"option",s)},expression:"proxy.option"}})],1)])])],1)},qt=[];const Se={};var jt=g(j,Et,qt,!1,Nt,null,null,null);function Nt(e){for(let a in Se)this[a]=Se[a]}const Lt=function(){return jt.exports}(),N={};N.props={value:{key:"value",required:!0,type:null},productCategories:{key:"productCategories",required:!0,type:Array},products:{key:"products",required:!0,type:Array},title:{key:"title",required:!0,type:String},numProducts:{key:"numProducts",required:!0,type:Number}};N.setup=(e,a)=>{const t=e,s=a.emit;return{proxy:S(t,s)}};N.components=Object.assign({CollapsibleSection:ce,ProductPair:Lt},N.components);var Ut=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("CollapsibleSection",{scopedSlots:e._u([{key:"title",fn:function(){return[t("BaseTypography",{staticClass:"py-4 pl-4",attrs:{component:"h3",variant:"subtitle3"}},[e._v(" "+e._s(e.title)+" Product Options ")])]},proxy:!0},{key:"content",fn:function(){return[t("div",{staticClass:"divide-y"},e._l(e.numProducts,function(s){return t("ProductPair",{key:s,attrs:{"product-categories":e.productCategories,products:e.products,title:`Product ${s}`},model:{value:e.proxy[s],callback:function(r){e.$set(e.proxy,s,r)},expression:"proxy[num]"}})}),1)]},proxy:!0}])})},Wt=[];const $e={};var Ht=g(N,Ut,Wt,!1,zt,null,null,null);function zt(e){for(let a in $e)this[a]=$e[a]}const Qt=function(){return Ht.exports}(),de={};de.props={value:{key:"value",required:!1,type:null}};de.setup=(e,a)=>{const t=e,s=a.emit;return{proxy:S(t,s)}};var Gt=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"flex flex-col justify-between space-y-2 p-4 lg:flex-row lg:space-x-4 lg:space-y-0"},[t("BaseLabel",{staticClass:"flex-1"},[t("span",{staticClass:"block text-sm font-medium leading-5 text-gray-700"},[e._v(" Standard Note: ")]),t("BaseTextarea",{staticClass:"w-full",attrs:{rows:"5",placeholder:"Canned description based on the grade"},model:{value:e.proxy.standard,callback:function(s){e.$set(e.proxy,"standard",s)},expression:"proxy.standard"}})],1),t("BaseLabel",{staticClass:"flex-1"},[t("span",{staticClass:"block text-sm font-medium leading-5 text-gray-700"},[e._v(" Custom Note: ")]),t("BaseTextarea",{staticClass:"w-full",attrs:{rows:"5",placeholder:"Custom description starting with selected canned note"},model:{value:e.proxy.custom,callback:function(s){e.$set(e.proxy,"custom",s)},expression:"proxy.custom"}})],1)],1)},Vt=[];const Ae={};var Kt=g(de,Gt,Vt,!1,Yt,null,null,null);function Yt(e){for(let a in Ae)this[a]=Ae[a]}const Jt=function(){return Kt.exports}(),L={};L.props={value:{key:"value",required:!0,type:Object}};L.setup=(e,a)=>{const t=e,s=a.emit;return{proxy:S(t,s)}};L.components=Object.assign({GradeLetterDisplay:it,RiskVectorNotes:Jt},L.components);var Xt=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("section",{staticClass:"divide-y"},e._l(e.proxy,function(s,r){return t("div",{key:r,staticClass:"divide-y"},[t("div",{staticClass:"flex flex-row justify-start space-x-2 p-4"},[t("BaseTypography",{staticClass:"text-gray-700",attrs:{component:"h4",variant:"p1"}},[e._v(" "+e._s(r)+": ")]),s.grade?t("GradeLetterDisplay",{attrs:{grade:s.grade}}):e._e()],1),t("RiskVectorNotes",{model:{value:e.proxy[r],callback:function(d){e.$set(e.proxy,r,d)},expression:"proxy[type]"}})],1)}),0)},Zt=[];const De={};var es=g(L,Xt,Zt,!1,ts,null,null,null);function ts(e){for(let a in De)this[a]=De[a]}const ss=function(){return es.exports}(),U={};U.props={score:{key:"score",required:!1,type:Number},ipv4Count:{key:"ipv4Count",required:!1,type:Number},monitoringCompanyCount:{key:"monitoringCompanyCount",required:!1,type:String}};U.setup=(e,a)=>{const t=e;return{ipv4CountDisplay:o(()=>new Number(t.ipv4Count).toLocaleString())}};U.components=Object.assign({BitsightLevelBadge:ct},U.components);var as=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"grid divide-y lg:grid-cols-3 lg:gap-4 lg:divide-x lg:divide-y-0"},[t("dl",{staticClass:"space-y-2 overflow-hidden px-4 py-5"},[t("dt",{staticClass:"truncate"},[t("BaseTypography",{staticClass:"text-gray-500",attrs:{variant:"subtitle2"}},[e._v(" Rating Score ")])],1),t("dd",{staticClass:"flex items-center space-x-4"},[t("BaseTypography",{attrs:{variant:"h3"}},[e._v(" "+e._s(e.score||"???")+" ")]),e.score?t("BitsightLevelBadge",{attrs:{value:e.score}}):e._e()],1)]),t("dl",{staticClass:"space-y-2 overflow-hidden px-4 py-5"},[t("dt",{staticClass:"truncate"},[t("BaseTypography",{staticClass:"text-gray-500",attrs:{variant:"subtitle2"}},[e._v(" # IP Addresses ")])],1),t("dd",[t("BaseTypography",{attrs:{variant:"h3"}},[e._v(" "+e._s(e.ipv4CountDisplay||"???")+" ")])],1)]),t("dl",{staticClass:"space-y-2 overflow-hidden px-4 py-5"},[t("dt",{staticClass:"truncate"},[t("BaseTypography",{staticClass:"text-gray-500",attrs:{variant:"subtitle2"}},[e._v(" Monitoring Company Count ")])],1),t("dd",{staticClass:"text-3xl font-semibold leading-9 text-gray-900"},[t("BaseTypography",{attrs:{variant:"h3"}},[e._v(" "+e._s(e.monitoringCompanyCount||"???")+" ")])],1)])])},rs=[];const Be={};var ns=g(U,as,rs,!1,os,null,null,null);function os(e){for(let a in Be)this[a]=Be[a]}const is=function(){return ns.exports}(),W={};W.props={value:{key:"value",required:!1,type:null},options:{key:"options",required:!0,type:Array}};W.setup=(e,a)=>{const t=e,s=a.emit;return{proxy:X(t,s)}};W.components=Object.assign({ToolTip:Ne,ObjectDisplay:Le},W.components);var cs=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("BaseLabel",{staticClass:"flex flex-col p-4 lg:grid lg:grid-cols-3 lg:items-center"},[t("div",{staticClass:"flex flex-row items-center space-x-1"},[t("span",{staticClass:"block text-sm font-medium leading-5 text-gray-700"},[e._v(" Buyer Company ")]),e.value?t("ToolTip",[t("ObjectDisplay",{attrs:{value:e.value}})],1):e._e()],1),t("div",{staticClass:"flex flex-col lg:col-span-2"},[t("BaseSelect",{model:{value:e.proxy,callback:function(s){e.proxy=s},expression:"proxy"}},[t("option",{domProps:{value:null}}),e._l(e.options,function(s){return t("option",{key:s.id,domProps:{value:s}},[e._v(" "+e._s(s.name)+" ")])})],2)],1)])},ls=[];const Ie={};var us=g(W,cs,ls,!1,ps,null,null,null);function ps(e){for(let a in Ie)this[a]=Ie[a]}const ds=function(){return us.exports}(),H={};H.props={value:{key:"value",required:!1,type:null},options:{key:"options",required:!0,type:Array}};H.setup=(e,a)=>{const t=e,s=a.emit;return{proxy:X(t,s)}};H.components=Object.assign({ToolTip:Ne,ObjectDisplay:Le},H.components);var ms=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("BaseLabel",{staticClass:"flex flex-col p-4 lg:grid lg:grid-cols-3 lg:items-center lg:gap-1"},[t("div",{staticClass:"flex flex-row items-center space-x-1"},[t("span",[e._v("Supplier")]),e.value?t("ToolTip",[t("ObjectDisplay",{attrs:{value:e.value}})],1):e._e()],1),t("div",{staticClass:"flex flex-col lg:col-span-2"},[t("BaseSelect",{model:{value:e.proxy,callback:function(s){e.proxy=s},expression:"proxy"}},[t("option",{domProps:{value:null}}),e._l(e.options,function(s){return t("option",{key:s.id,domProps:{value:s}},[e._v(" "+e._s(s.name)+" ")])})],2)],1)])},vs=[];const Pe={};var ys=g(H,ms,vs,!1,fs,null,null,null);function fs(e){for(let a in Pe)this[a]=Pe[a]}const gs=function(){return ys.exports}();function we(e){return Math.floor(Math.random()*e.length)}function*_s(e){if(e.length<2)throw new Error(`Cannot pick 2 from array with only ${e.length} elements`);const a=we(e);for(yield e[a];;){const t=we(e);if(t!==a){yield e[t];return}}}const ae=[{name:"Compromised Systems",text:"Compromised Systems risk vectors make up 55% of the Risk Rating. It contains information based on Botnet Infections, Spam Propagation, Malware Servers, Unsolicited Communications, and Potentially Exploited Devices. The total grade of all Compromised Systems risk vectors, configurations, and event durations factor into the entire Compromised Systems risk category. We then normalize them to account for company size."},{name:"Public Disclosure",text:"Public Disclosure risk vectors are based on collected data breach information from verifiable news sources both domestic and international and by filing Freedom of Information Act (FOIA) requests. Information obtained through these research processes include a range of security events. Though these events do not necessarily result in direct data loss to you, the relevant interruptions to business continuity can be used to make informed decisions to improve your security preparedness."},{name:"System Patching",text:"System Patching risk vectors evaluate how vulnerabilities affect how many systems in an organization's network infrastructure and how quickly the company resolves any issues."},{name:"Application Security",text:"Application Security risk vectors track security holes and liabilities introduced by out-of-date or unsupported server software and business applications. These vectors also track outgoing communications from desktop devices including metadata about the device's operating system and its browser version. WhiteHawk compares that information with currently released versions or software updates available for those systems."},{name:"Communications Encryption",text:"Communications Encryption risk vectors analyze server configurations to determine if a server's security protocol libraries are correctly configured and supporting strong encryption when making connections to other machines. Incorrect configurations may make servers vulnerable to POODLE and Heartbleed attacks that can lead to attackers obtaining sensitive data. WhiteHawk checks TLS/SSL connections with servers and collects the certificate chain during the session negotiation process, allowing us to review and establish which hosts need updating."},{name:"Email Security",text:"Email Security risk vectors track the use of SPF, DKIM and DMARC DNS records. SPF on its own isn't enough to prevent domain name spoofing. Email has two possible \u201CFrom\u201D Address Fields (Envelope From, Header From.) SPF checks are done on the Envelope From, so it's not a preventative measure against all spoofing. Legitimate services do use this approach, for example, newsletters, but it is also used in spoofing. DKIM and DMARC both seek to get around this vulnerability. DKIM signs the email with a signature that a recipient server can verify against the Published DNS record. DMARC is used in conjunction with SPF; it aims to match the Header From domain name with the Envelope From used during the SPF check."},{name:"User Behavior",text:"User Behavior risk vectors focus on employee activities that may introduce risks into an organization's networks. User behavior risk examples include sharing files over BitTorrent and determining if employees are re-using corporate login credentials in external websites outside of the corporate network."}],re={"Application Security":{essential:["Application Security","Access Control"],balanced:["Web Services Security","Traffic Analysis","Denial of Service Mitigation"],premier:["Orchestration","Security Information and Event Management","Network Intrusion Prevention System","Threat Intelligence"]},"Communications Encryption":{essential:["Encrypted Communication","Virtual Private Network"],balanced:["Secure Managed File Transfer","Traffic Analysis","Data Leak Prevention"],premier:["Security Network Engineering","Security Information and Event Management","Managed Security Services","Compliance Reporting"]},"Compromised Systems":{essential:["Antimalware","Access Control"],balanced:["Incident Response","Network Intrusion Detection System","Malware Analysis"],premier:["Host-Based Intrusion Prevention System","Security Information and Event Management","Managed Security Services","Compliance Reporting"]},"Email Security":{essential:["Email Filter","Training"],balanced:["Web Filter","Traffic Analysis","Incident Response"],premier:["Threat Intelligence","Security Information and Event Management","Orchestration","Managed Security Services"]},"Public Disclosure":{essential:["Training","Data Leak Prevention"],balanced:["Incident Response","Host-Based Intrusion Prevention System","Network Intrusion Detection System"],premier:["Managed Security Services","Compliance Reporting","Forensics","Security Information and Event Management"]},"System Patching":{essential:["Patch Management","Network Discovery"],balanced:["Encrypted Storage","Backup","Threat Manager"],premier:["Virtualization Security Endpoint Protection","Host-Based Intrusion Prevention System","Security Information and Event Management","Vulnerability Assessment"]},"User Behavior":{essential:["Web Filter","Training"],balanced:["Threat Manager","Insider Threat Analytics","Data Leak Prevention"],premier:["Threat Intelligence","Security Information and Event Management","Orchestration","Compliance Reporting"]}},Ue=["Compromised Systems","Public Disclosure","System Patching","Application Security","User Behavior","Email Security"],xs=["Communications Encryption"];function Oe(e,a,t){const s=`${t} ${a}`;return{grade:e[t]||"",standard:e[`${s} Description`]||"",custom:e[`${s} Analyst Note`]||""}}function hs(e){const a={};for(const t of Ue)a[t]=Oe(e,"Risk Vector Grade",t);for(const t of xs)a[t]=Oe(e,"Risk Vector",t);return a}function Cs(e){if(!e)return{};const a={};for(const t of Object.entries(e)){const[s,r]=t,d=Ue.includes(s)?`${s} Risk Vector Grade`:`${s} Risk Vector`;a[s]=r.grade,a[`${d} Description`]=r.standard,a[`${d} Analyst Note`]=r.custom}return a}const Re=["Compromised Systems","Public Disclosure","System Patching","Application Security","Communications Encryption","Email Security","User Behavior"],ie={};for(let e=0;e<Re.length;e++){const a=Re[e];a&&(ie[a]=e)}const Te=e=>{const a=Object.entries(e).map(([t,s])=>({name:t,grade:s.grade})).filter(({grade:t})=>t&&t!=="N/A");return a.sort((t,s)=>{const r=s.grade.localeCompare(t.grade);if(r!==0)return r;const d=ie[t.name]||0,l=ie[s.name]||0;return d-l}),a.map(t=>({name:t.name}))};function ne(e,a,t){const s={};for(let r=0;r<t;r++){const d=r+1,l=`${a} Product ${d}`;s[d]={category:{id:e[`${l} - categoryId`],name:e[`${l} - Category`]},main:{id:e[`${l} - mainId`],manufacturer:e[`${l} - Vendor Option 1`],product:e[`${l} - Product Option 1`],description:e[`${l} - Description Option 1`]},option:{id:e[`${l} - optionId`],manufacturer:e[`${l} - Vendor Option 2`],product:e[`${l} - Product Option 2`],description:e[`${l} - Description Option 2`]}}}return s}function oe(e,a){return e?Object.entries(e).reduce((t,s)=>{const[r,d]=s,{category:l,main:p,option:i}=d,c=`${a} Product ${r}`;return t[`${c} - categoryId`]=l==null?void 0:l.id,t[`${c} - Category`]=l==null?void 0:l.name,t[`${c} - mainId`]=p==null?void 0:p.id,t[`${c} - Vendor Option 1`]=p==null?void 0:p.manufacturer,t[`${c} - Product Option 1`]=p==null?void 0:p.product,t[`${c} - Description Option 1`]=p==null?void 0:p.description,t[`${c} - optionId`]=i==null?void 0:i.id,t[`${c} - Vendor Option 2`]=i==null?void 0:i.manufacturer,t[`${c} - Product Option 2`]=i==null?void 0:i.product,t[`${c} - Description Option 2`]=i==null?void 0:i.description,t},{}):{}}const z={};z.props={value:{key:"value",required:!1,type:null},products:{key:"products",required:!0,type:Array},users:{key:"users",required:!0,type:Array},companyAccess:{key:"companyAccess",required:!0,type:Array},companies:{key:"companies",required:!0,type:Array},companyBitsightCompanies:{key:"companyBitsightCompanies",required:!0,type:Array},status:{key:"status",required:!0,type:String}};z.setup=(e,a)=>{const t=e,s=a.emit,r=S(t,s),d=o({get(){return{id:r.value.buyerId}},set(n){n&&n.id&&(r.value.buyerId=n.id)}}),l=o({get(){return{id:r.value.analystId||"",name:r.value["WhiteHawk Analyst Name"]||"",title:r.value["WhiteHawk Analyst Title"]||"",email:r.value["WhiteHawk Analyst Email"]||""}},set(n){const{id:m,name:v,title:y,email:$}=n;n&&(r.value.analystId=m,r.value["WhiteHawk Analyst Name"]=v,r.value["WhiteHawk Analyst Title"]=y,r.value["WhiteHawk Analyst Email"]=$)}}),p=o({get(){return{id:r.value["Buyer Company Id"]==null?r.value.buyerId||"":r.value["Buyer Company Id"]||"",name:r.value["Buyer Company Name"]||""}},set(n){n&&(r.value["Buyer Company Id"]=n.id,r.value["Buyer Company Name"]=n.name)}}),i=o({get(){return r.value["Rating Score Description"]},set(n){n&&(r.value["Rating Score Description"]=n)}}),c=o({get(){return r.value["Industry Comparison Description"]},set(n){n&&(r.value["Industry Comparison Description"]=n)}}),u=o({get(){return{num1:{name:r.value["Focus Area 1 Title"]||""},num2:{name:r.value["Focus Area 2 Title"]||""},num3:{name:r.value["Focus Area 3 Title"]||""}}},set(n){const{num1:m,num2:v,num3:y}=n;n&&m&&v&&y&&(r.value["Focus Area 1 Title"]=m.name,r.value["Focus Area 2 Title"]=v.name,r.value["Focus Area 3 Title"]=y.name)}}),f=o({get(){return hs(r.value)},set(n){const m=Cs(n);for(const[v,y]of Object.entries(m))r.value[v]=y}}),D=o(()=>{var n;return u.value.num1&&u.value.num1.name?(n=f.value[u.value.num1.name])==null?void 0:n.standard:""});se(D,n=>{n&&(r.value["Focus Area 1 Description"]=n)});const w=o(()=>{var n;return u.value.num2&&u.value.num2.name?(n=f.value[u.value.num2.name])==null?void 0:n.standard:""});se(w,n=>{n&&(r.value["Focus Area 2 Description"]=n)});const T=o(()=>{var n;return u.value.num3&&u.value.num3.name?(n=f.value[u.value.num3.name])==null?void 0:n.standard:""});se(T,n=>{n&&(r.value["Focus Area 3 Description"]=n)});const O=o({get(){if(r.value["# IP Address"])return+r.value["# IP Address"]},set(n){n&&(r.value["# IP Address"]=n.toString())}}),b=o({get(){return r.value["Monitoring company count"]},set(n){n&&(r.value["Monitoring company count"]=n)}}),F=o({get(){if(r.value["Security Rating"])return+r.value["Security Rating"]},set(n){n&&(r.value["Security Rating"]=n.toString())}}),x=o({get(){return{id:r.value.supplierId||"",name:r.value["Supplier Name"]||"",domain:r.value.Domain||""}},set(n){n&&n.id&&n.name&&n.domain&&(r.value.supplierId=n.id,r.value["Supplier Name"]=n.name,r.value.Domain=n.domain)}}),C=o({get(){return ne(r.value,"Basic",2)},set(n){if(n){const m=oe(n,"Basic");for(const[v,y]of Object.entries(m))r.value[v]=y}}}),G=o({get(){return ne(r.value,"Balanced",3)},set(n){if(n){const m=oe(n,"Balanced");for(const[v,y]of Object.entries(m))r.value[v]=y}}}),V=o({get(){return ne(r.value,"Advanced",4)},set(n){if(n){const m=oe(n,"Advanced");for(const[v,y]of Object.entries(m))r.value[v]=y}}}),Z=o(()=>t.users.filter(n=>E(n,"email").includes("@whitehawk")).map(n=>({id:E(n,"sub"),name:E(n,"name"),title:E(n,"custom:title"),email:E(n,"email")})).sort((n,m)=>n.email.localeCompare(m.email))),We=o(()=>t.companies.filter(n=>n.status==="ACTIVE").map(n=>({id:n.id,name:n.name}))),He=o(()=>{const n={};for(const v of t.products)for(const y of v.categories||[])n[y.id]=y;return Object.values(n).sort((v,y)=>v.name.localeCompare(y.name))}),ve=o(()=>{var m;const n={};for(const v of t.products)for(const y of v.categories||[]){const{name:$}=y;n[$]?(m=n[$])==null||m.push(v):n[$]=[v]}return n}),ze=o(()=>t.companyBitsightCompanies.map(n=>({id:n.data.guid,name:n.data.name,domain:n.data.primary_domain})).sort((n,m)=>n.name.localeCompare(m.name))),Qe=o(()=>Te(f.value)),Ge=o(()=>{const n=[];return x.value.id||n.push("Select a supplier"),t.status==="Delivered"&&n.push('The status of this scorecard has already been marked as "Delivered."'),{allowed:n.length===0,reasons:n}}),Ve=o(()=>d.value.id),Ke=o(()=>x.value.id),Ye=yt.list(Ve,Ke),B=o(()=>Ye.data.value);function Je(){var n,m,v,y,$;if(B.value){const ye=B.value.customerMonitoringCount;O.value=B.value.ipv4Count,b.value=ye===1?"1":`${ye}`,F.value=B.value.bitsightScore||0,i.value=ut(x.value.name,B.value.bitsightScore),c.value=B.value.industryComparison.join(`

`);const ee={};for(const h of Object.entries(B.value.analysis)){const[_,R]=h,{customNote:A,standardNote:I,grade:P}=R;let M="";for(let k=0;k<ae.length;k++)((n=ae[k])==null?void 0:n.name)===_&&(M=((m=ae[k])==null?void 0:m.text)||"");ee[_]={grade:P,description:M,custom:A.join(" "),standard:I.join(" ")}}f.value=ee;const[K,Y,J]=Te(ee);u.value={num1:K,num2:Y,num3:J};const fe=h=>{var _;return{id:h.id,manufacturer:(_=h.manufacturer)==null?void 0:_.name,product:h.name,description:h.description}},Xe=h=>{if(!(h in ve.value))return[void 0,void 0];const _=ve.value[h];if(_){if(_.length===1){const I=_[0];return[I,I]}const[R,A]=_s(_);return[R,A]}return[void 0,void 0]},te=h=>{var R;const _={};for(let A=0;A<h.length;A++){const I=h[A]||"",[P,M]=Xe(I),k=(R=P==null?void 0:P.categories)==null?void 0:R.find(Ze=>Ze.name===I);_[A+1]={category:{id:k==null?void 0:k.id,name:k==null?void 0:k.name},main:P?fe(P):void 0,option:M?fe(M):void 0}}return _};C.value=te(((v=re[(K==null?void 0:K.name)||""])==null?void 0:v.essential)||[]),G.value=te(((y=re[(Y==null?void 0:Y.name)||""])==null?void 0:y.balanced)||[]),V.value=te((($=re[(J==null?void 0:J.name)||""])==null?void 0:$.premier)||[]),s("update-data")}else throw new Error("Performance Evaluation is undefined")}return{analyst:l,buyerCompany:p,ratingScoreDescription:i,industryComparisonDescription:c,focusAreas:u,riskVectors:f,ipv4Count:O,monitoringCompanyCount:b,bitSightRatingScore:F,supplier:x,essential:C,balanced:G,premier:V,analystOptions:Z,companyOptions:We,productCategories:He,supplierOptions:ze,worstRiskVectorsFirst:Qe,canUpdateData:Ge,updateData:Je}};z.components=Object.assign({CompanySelect:ds,AnalystSelect:lt,SupplierSelect:gs,RefreshSvg:tt,SupplierStats:is,IndustryDescription:wt,RiskVectorSummary:st,FocusAreasInput:At,CollapsibleSection:ce,RiskVectorPerformance:ss,ProductGroup:Qt},z.components);var ks=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("section",{staticClass:"flex flex-col divide-y"},[t("div",{staticClass:"divide-y"},[t("BaseTypography",{staticClass:"p-4",attrs:{component:"h3",variant:"subtitle3"}},[e._v(" Buyer Information ")]),t("CompanySelect",{attrs:{options:e.companyOptions},model:{value:e.buyerCompany,callback:function(s){e.buyerCompany=s},expression:"buyerCompany"}})],1),t("div",{staticClass:"divide-y"},[t("BaseTypography",{staticClass:"p-4",attrs:{component:"h3",variant:"subtitle3"}},[e._v(" Analyst Information ")]),t("AnalystSelect",{attrs:{options:e.analystOptions},model:{value:e.analyst,callback:function(s){e.analyst=s},expression:"analyst"}})],1),t("div",{staticClass:"divide-y"},[t("BaseTypography",{staticClass:"p-4",attrs:{component:"h3",variant:"subtitle3"}},[e._v(" Supplier Information ")]),t("SupplierSelect",{attrs:{options:e.supplierOptions},model:{value:e.supplier,callback:function(s){e.supplier=s},expression:"supplier"}})],1),t("div",{staticClass:"divide-y"},[t("BaseTypography",{staticClass:"p-4",attrs:{component:"h3",variant:"subtitle3"}},[e._v(" Update Data ")]),e.canUpdateData.allowed?t("div",{staticClass:"p-4"},[t("BaseButton",{staticClass:"space-x-2",attrs:{type:"button","display-type":"info",disabled:!e.canUpdateData.allowed},on:{click:e.updateData}},[t("RefreshSvg",{staticClass:"-ml-1 w-5"}),t("span",[e._v("Update")])],1)],1):t("div",[t("BaseAlert",{staticClass:"rounded-none shadow-none",attrs:{type:"warn"},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("Update Unavailable")]},proxy:!0},{key:"message",fn:function(){return[t("ul",{staticClass:"flex list-inside list-disc flex-col space-y-1"},e._l(e.canUpdateData.reasons,function(s){return t("li",{key:s},[e._v(" "+e._s(s)+" ")])}),0)]},proxy:!0}],null,!1,4159848379)})],1)],1),t("div",{staticClass:"divide-y"},[t("BaseTypography",{staticClass:"p-4",attrs:{component:"h3",variant:"subtitle3"}},[e._v(" Performance Evaluation ")]),t("div",{staticClass:"divide-y"},[t("SupplierStats",{attrs:{score:e.bitSightRatingScore,"ipv4-count":e.ipv4Count,"monitoring-company-count":e.monitoringCompanyCount}}),t("BaseLabel",{staticClass:"flex flex-col p-4 lg:grid lg:grid-cols-3 lg:items-center"},[e._v(" Rating Score Description "),t("div",{staticClass:"flex flex-col lg:col-span-2"},[t("BaseTextarea",{attrs:{rows:"3"},model:{value:e.ratingScoreDescription,callback:function(s){e.ratingScoreDescription=s},expression:"ratingScoreDescription"}})],1)])],1)],1),t("div",{staticClass:"divide-y"},[t("BaseTypography",{staticClass:"p-4",attrs:{component:"h3",variant:"subtitle3"}},[e._v(" Industry Comparison ")]),t("IndustryDescription",{model:{value:e.industryComparisonDescription,callback:function(s){e.industryComparisonDescription=s},expression:"industryComparisonDescription"}})],1),t("div",{staticClass:"divide-y"},[t("BaseTypography",{staticClass:"p-4",attrs:{component:"h3",variant:"subtitle3"}},[e._v(" Recommended Focus Areas ")]),t("div",{staticClass:"flex flex-col divide-y lg:grid lg:grid-cols-2 lg:divide-x lg:divide-y-0 xl:grid-cols-3"},[t("RiskVectorSummary",{attrs:{value:e.riskVectors}}),t("FocusAreasInput",{attrs:{options:e.worstRiskVectorsFirst},model:{value:e.focusAreas,callback:function(s){e.focusAreas=s},expression:"focusAreas"}})],1)],1),t("CollapsibleSection",{scopedSlots:e._u([{key:"title",fn:function(){return[t("BaseTypography",{staticClass:"py-4 pl-4",attrs:{component:"h3",variant:"subtitle3"}},[e._v(" Risk Vector Performance ")])]},proxy:!0},{key:"content",fn:function(){return[e.riskVectors?t("RiskVectorPerformance",{model:{value:e.riskVectors,callback:function(s){e.riskVectors=s},expression:"riskVectors"}}):e._e()]},proxy:!0}])}),t("ProductGroup",{attrs:{"product-categories":e.productCategories,products:e.products,title:"Essential","num-products":2},model:{value:e.essential,callback:function(s){e.essential=s},expression:"essential"}}),t("ProductGroup",{attrs:{"product-categories":e.productCategories,products:e.products,title:"Balanced","num-products":3},model:{value:e.balanced,callback:function(s){e.balanced=s},expression:"balanced"}}),t("ProductGroup",{attrs:{"product-categories":e.productCategories,products:e.products,title:"Premier","num-products":4},model:{value:e.premier,callback:function(s){e.premier=s},expression:"premier"}})],1)},bs=[];const Fe={};var Ss=g(z,ks,bs,!1,$s,null,null,null);function $s(e){for(let a in Fe)this[a]=Fe[a]}const As=function(){return Ss.exports}(),me={};me.props={value:{key:"value",required:!1,type:null}};me.setup=(e,a)=>{const t=e,s=a.emit,r=S(t,s),d=["In Progress","Products Needed","Ready For QA","Complete","Delivered"],l=["Q1","Q2","Q3","Q4","Other"],p=o(()=>{const i=[],c=new Date().getFullYear();for(let u=c-1;u<=c+5;u++)i.push(u);return i});return{proxy:r,statusOptions:d,quarterOptions:l,yearOptions:p}};var Ds=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"grid divide-y lg:grid-cols-4 lg:divide-y-0"},[t("div",{staticClass:"p-4 lg:col-span-2"},[t("BaseLabel",{staticClass:"grid grid-cols-1 gap-1 sm:grid-cols-3 sm:items-center sm:gap-4 lg:grid-cols-1 lg:gap-1"},[t("span",{staticClass:"block text-sm font-medium leading-5 text-gray-700"},[e._v(" Status ")]),t("div",{staticClass:"flex flex-col sm:col-span-2 lg:col-span-1"},[t("BaseSelect",{model:{value:e.proxy.status,callback:function(s){e.$set(e.proxy,"status",s)},expression:"proxy.status"}},[t("option",{domProps:{value:null}}),e._l(e.statusOptions,function(s){return t("option",{key:s},[e._v(" "+e._s(s)+" ")])})],2)],1)])],1),t("div",{staticClass:"p-4 lg:col-span-1"},[t("BaseLabel",{staticClass:"grid grid-cols-1 gap-1 sm:grid-cols-3 sm:items-center sm:gap-4 lg:grid-cols-1 lg:gap-1"},[t("span",{staticClass:"block text-sm font-medium leading-5 text-gray-700"},[e._v(" Year ")]),t("div",{staticClass:"flex flex-col sm:col-span-2 lg:col-span-1"},[t("BaseSelect",{model:{value:e.proxy.year,callback:function(s){e.$set(e.proxy,"year",s)},expression:"proxy.year"}},[t("option",{domProps:{value:null}}),e._l(e.yearOptions,function(s){return t("option",{key:s},[e._v(" "+e._s(s)+" ")])})],2)],1)])],1),t("div",{staticClass:"p-4 lg:col-span-1"},[t("BaseLabel",{staticClass:"grid grid-cols-1 gap-1 sm:grid-cols-3 sm:items-center sm:gap-4 lg:grid-cols-1 lg:gap-1"},[t("span",{staticClass:"block text-sm font-medium leading-5 text-gray-700"},[e._v(" Quarter ")]),t("div",{staticClass:"flex flex-col sm:col-span-2 lg:col-span-1"},[t("BaseSelect",{model:{value:e.proxy.quarter,callback:function(s){e.$set(e.proxy,"quarter",s)},expression:"proxy.quarter"}},[t("option",{domProps:{value:null}}),e._l(e.quarterOptions,function(s){return t("option",{key:s},[e._v(" "+e._s(s)+" ")])})],2)],1)])],1)])},Bs=[];const Me={};var Is=g(me,Ds,Bs,!1,Ps,null,null,null);function Ps(e){for(let a in Me)this[a]=Me[a]}const ws=function(){return Is.exports}(),Q={};Q.props={value:{key:"value",required:!1,type:null},products:{key:"products",required:!0,type:Array},users:{key:"users",required:!0,type:Array},companyAccess:{key:"companyAccess",required:!0,type:Array},companies:{key:"companies",required:!0,type:Array},companyBitsightCompanies:{key:"companyBitsightCompanies",required:!0,type:Array}};Q.setup=(e,a)=>{const t=e,s=a.emit,r=S(t,s),d=o({get(){const i=r.value.yearQuarterValue.split("/")||[],[c,u]=i;return{status:r.value.status,year:c,quarter:u}},set(i){r.value.status=i.status,r.value.yearQuarterValue=`${i.year}/${i.quarter}`}}),l=o(()=>{const i=r.value.data.updatedAt;return i?ft(ot(i),new Date):"???"});async function p(){if(r.value.data.buyerId&&r.value.data.supplierId){const i=encodeURIComponent(r.value.data.buyerId),c=encodeURIComponent(r.value.data.supplierId),{data:u}=await qe.get(`${je}/companies/${i}/bitsight/companies/${c}/cis-to-cmmc-mapping`);r.value.mapping=u}}return{proxy:r,status:d,updatedAtDisplay:l,updateData:p}};Q.components=Object.assign({ScorecardDataInput:As,CollapsibleSection:ce,CisToCmmcMappingDisplay:et,ScorecardStatus:ws},Q.components);var Os=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("section",{staticClass:"divide-y"},[t("ScorecardDataInput",{attrs:{products:e.products,users:e.users,"company-access":e.companyAccess,companies:e.companies,"company-bitsight-companies":e.companyBitsightCompanies,status:e.status.status},on:{"update-data":e.updateData},model:{value:e.proxy.data,callback:function(s){e.$set(e.proxy,"data",s)},expression:"proxy.data"}}),t("CollapsibleSection",{scopedSlots:e._u([{key:"title",fn:function(){return[t("BaseTypography",{staticClass:"py-4 pl-4",attrs:{component:"h3",variant:"subtitle3"}},[e._v(" CIS Controls Mapped to CMMC Maturity Levels ")])]},proxy:!0},{key:"content",fn:function(){return[e.proxy.mapping?t("CisToCmmcMappingDisplay",{staticClass:"rounded-none shadow-none",attrs:{value:e.proxy.mapping}}):t("BaseAlert",{attrs:{type:"warn"},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("No Data Found")]},proxy:!0},{key:"message",fn:function(){return[e._v("Update required.")]},proxy:!0}])})]},proxy:!0}])}),t("div",{staticClass:"grid divide-y"},[t("div",{staticClass:"flex flex-col items-start p-4 sm:flex-row sm:items-center sm:justify-between"},[t("BaseTypography",{attrs:{component:"h3",variant:"subtitle3"}},[e._v(" Status ")]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.proxy.data.updatedAt,expression:"proxy.data.updatedAt"}],staticClass:"inline-flex justify-center px-2 py-1 text-gray-500"},[t("BaseOverline",{staticClass:"uppercase"},[e._v(" Last updated: "),t("time",{attrs:{datetime:e.proxy.data.updatedAt}},[e._v(" "+e._s(e.updatedAtDisplay)+" ")])])],1)],1),t("ScorecardStatus",{model:{value:e.status,callback:function(s){e.status=s},expression:"status"}})],1)],1)},Rs=[];const Ee={};var Ts=g(Q,Os,Rs,!1,Fs,null,null,null);function Fs(e){for(let a in Ee)this[a]=Ee[a]}const Xs=function(){return Ts.exports}();export{Xs as S};
