import{F as N}from"./FormButton.8ea903a2.js";import{aB as $,n as x,d as c,b1 as g,ax as U,bs as G,ca as H,b as z,bH as w,aK as K,aP as W,aQ as J}from"./index.1543f442.js";import{T as X}from"./ToolTip.e2aa5ce3.js";import{O as Z}from"./ObjectDisplay.b91f3921.js";import{A as ee}from"./AnalystSelect.095c9b2a.js";import{D as te}from"./DynamicForm.96efdff6.js";import{e as i}from"./attributeValue.ea53a720.js";import{s as j}from"./index.68aaa7db.js";import{u as ae}from"./useBitsightCompanies.b2d983c3.js";import{u as se}from"./useBatchScorecards.96577b70.js";import{u as ne}from"./useUsers.b99a3af0.js";import"./arrow-down-on-square.bf61cdc5.js";import"./trash.78f57a7a.js";const B={};B.props={value:{key:"value",required:!1,type:Array},options:{key:"options",required:!0,type:Array}};B.setup=(e,n)=>{const t=e,a=n.emit;return{proxy:$(t,a)}};var re=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("BaseLabel",{staticClass:"flex flex-col p-4 lg:grid lg:grid-cols-3 lg:items-center lg:gap-1"},[t("span",{staticClass:"after:ml-0.5 after:text-red-700 after:content-['*']"},[e._v(" Companies ")]),t("BaseSelect",{staticClass:"lg:col-span-2",attrs:{multiple:"",required:""},model:{value:e.proxy,callback:function(a){e.proxy=a},expression:"proxy"}},e._l(e.options,function(a){return t("option",{key:a.id,domProps:{value:a}},[e._v(" "+e._s(a.name)+" ("+e._s(a.domain)+") ")])}),0)],1)},oe=[];const A={};var le=x(B,re,oe,!1,ie,null,null,null);function ie(e){for(let n in A)this[n]=A[n]}const ce=function(){return le.exports}(),d={};d.props={value:{key:"value",required:!1,type:null},options:{key:"options",required:!0,type:Array}};d.setup=(e,n)=>{const t=e,a=n.emit;return{proxy:$(t,a)}};d.components=Object.assign({ToolTip:X,ObjectDisplay:Z},d.components);var ue=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("BaseLabel",{staticClass:"flex flex-col p-4 lg:grid lg:grid-cols-3 lg:items-center"},[t("div",{staticClass:"flex flex-row items-center space-x-1"},[t("span",{staticClass:"after:ml-0.5 after:text-red-700 after:content-['*']"},[e._v(" Buyer Company ")]),e.value?t("ToolTip",[t("ObjectDisplay",{attrs:{value:e.value}})],1):e._e()],1),t("BaseSelect",{staticClass:"lg:col-span-2",attrs:{required:""},model:{value:e.proxy,callback:function(a){e.proxy=a},expression:"proxy"}},e._l(e.options,function(a){return t("option",{key:a.id,domProps:{value:a}},[e._v(" "+e._s(a.name)+" ")])}),0)],1)},pe=[];const D={};var me=x(d,ue,pe,!1,ve,null,null,null);function ve(e){for(let n in D)this[n]=D[n]}const ye=function(){return me.exports}(),f={};f.props={value:{key:"value",required:!1,type:null}};f.setup=(e,n)=>{const t=e,a=n.emit,o=$(t,a),u=c(()=>new Date().getFullYear()),p=c(()=>new Array(10).fill(u.value).map((v,s)=>u.value-5+s)),m=[{name:"state",label:"State",component:{is:g,attrs:{required:!0,options:[{text:"",value:null},{text:"In Progress",value:"IN_PROGRESS"},{text:"Products Needed",value:"PRODUCTS_NEEDED"},{text:"Ready for QA",value:"READY_FOR_QA"},{text:"Delivered",value:"DELIVERED"},{text:"Complete",value:"COMPLETE"}]}}},{name:"year",label:"Year",component:{is:g,attrs:{required:!0,options:[{text:"",value:null},...p.value.map(v=>({value:v}))]}}},{name:"quarter",label:"Quarter",component:{is:g,attrs:{required:!0,options:[{text:"",value:null},{value:"Q1"},{value:"Q2"},{value:"Q3"},{value:"Q4"},{text:"Other",value:"OTHER"}]}}}];return{proxy:o,schema:m}};f.components=Object.assign({DynamicForm:te},f.components);var de=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("DynamicForm",{attrs:{schema:e.schema},model:{value:e.proxy,callback:function(a){e.proxy=a},expression:"proxy"}})},fe=[];const T={};var _e=x(f,de,fe,!1,xe,null,null,null);function xe(e){for(let n in T)this[n]=T[n]}const he=function(){return _e.exports}(),_={};_.props={value:{key:"value",required:!1,type:null},id:{key:"id",required:!0,type:String},users:{key:"users",required:!0,type:Array},companies:{key:"companies",required:!0,type:Array},bitsightCompanies:{key:"bitsightCompanies",required:!0,type:Array}};_.setup=(e,n)=>{const t=e,a=n.emit,o=U(t,a),u=c(()=>t.companies.filter(s=>s.status==="ACTIVE")),p=c(()=>t.users.filter(s=>i(s,"email").includes("@whitehawk")).map(s=>({id:i(s,"sub"),name:i(s,"name"),title:i(s,"custom:title"),phone:i(s,"phone_number"),email:i(s,"email")})).sort((s,h)=>s.email.localeCompare(h.email))),m=c(()=>t.bitsightCompanies.map(s=>({id:s.data.guid,name:s.data.name,domain:s.data.primary_domain}))),v=j(c(()=>({year:o.value.status.year,quarter:o.value.status.quarter,state:o.value.status.state})));return{proxy:o,consumerOptions:u,analystOptions:p,bitsightCompanyOptions:m,status:v}};_.components=Object.assign({BatchCompanySelect:ye,AnalystSelect:ee,StatusInput:he,BatchBitsightCompaniesSelect:ce},_.components);var Ce=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("section",{staticClass:"flex flex-col divide-y"},[t("div",{staticClass:"divide-y"},[t("BaseTypography",{staticClass:"p-4",attrs:{variant:"subtitle3",component:"h3"}},[e._v(" Buyer Information ")]),t("BatchCompanySelect",{attrs:{options:e.consumerOptions},model:{value:e.proxy.buyerCompany,callback:function(a){e.$set(e.proxy,"buyerCompany",a)},expression:"proxy.buyerCompany"}})],1),t("div",{staticClass:"divide-y"},[t("BaseTypography",{staticClass:"p-4",attrs:{variant:"subtitle3",component:"h3"}},[e._v(" Analyst Information ")]),t("AnalystSelect",{attrs:{options:e.analystOptions},model:{value:e.proxy.analystInfo,callback:function(a){e.$set(e.proxy,"analystInfo",a)},expression:"proxy.analystInfo"}})],1),t("div",{staticClass:"divide-y"},[t("BaseTypography",{staticClass:"p-4",attrs:{variant:"subtitle3",component:"h3"}},[e._v(" Status ")]),t("StatusInput",{model:{value:e.status,callback:function(a){e.status=a},expression:"status"}})],1),t("div",{staticClass:"divide-y"},[t("BaseTypography",{staticClass:"p-4",attrs:{variant:"subtitle3",component:"h3"}},[e._v(" Select Companies ")]),t("BatchBitsightCompaniesSelect",{attrs:{options:e.bitsightCompanyOptions},model:{value:e.proxy.supplierInfos,callback:function(a){e.$set(e.proxy,"supplierInfos",a)},expression:"proxy.supplierInfos"}})],1)])},be=[];const F={};var ge=x(_,Ce,be,!1,$e,null,null,null);function $e(e){for(let n in F)this[n]=F[n]}const Be=function(){return ge.exports}(),b={};b.setup=(e,n)=>{const t=H("id"),a=z(!1),o=[w.list(),ae.list(t)],u=w.read(t),p=c(()=>u.data.value),m=ne.list(),v=c(()=>{var l;return(l=m.data.value)==null?void 0:l.map(r=>({id:i(r,"sub"),email:i(r,"email"),name:i(r,"name"),phone:i(r,"phone_number"),title:i(r,"custom:title")})).find(r=>r.email==="consultingservices@whitehawk.com")}),s=j(c(()=>{const l=new Date,r=l.getUTCFullYear(),y=Math.ceil((l.getMonth()+1)/4);return{buyerCompany:p.value,analystInfo:v.value,yearQuarterValue:`${r}/${y}`,status:{year:r,quarter:"Q"+y,state:"IN_PROGRESS"},supplierInfos:[]}})),h=c(()=>!!(s.value&&s.value.buyerCompany&&s.value.analystInfo&&s.value.status&&s.value.yearQuarterValue&&s.value.supplierInfos.length>0)),Q=se.create(t);async function M(){var y,C,S,k,q,I,O,E,R;a.value=!0;const l={id:t.value,buyerCompany:(y=s.value)==null?void 0:y.buyerCompany,analystInfo:(C=s.value)==null?void 0:C.analystInfo,status:{year:(S=s.value)==null?void 0:S.status.year,quarter:(k=s.value)==null?void 0:k.status.quarter,state:(q=s.value)==null?void 0:q.status.state},includeCmmc:(I=s.value)!=null&&I.includeCmmc?(O=s.value)==null?void 0:O.includeCmmc:!0,template:(E=s.value)==null?void 0:E.template,supplierInfos:(R=s.value)==null?void 0:R.supplierInfos},r=await Q.mutateAsync(l);r&&L(r.id)}const V=K();async function L(l){await Y(l),a.value=!1,V.push(`/admin/companies/${t.value}/scorecards/batch/rating-service-1/${l}`)}async function Y(l){let r=!0;do(await W.get(`${J}/companies/${t.value}/scorecards/docx/${l}/status`)).data.length===0?r=!1:await new Promise(C=>setTimeout(C,2e3));while(r)}return{id:t,queries:o,users:m,batch:s,isValidForm:h,createBatch:M}};b.components=Object.assign({BackButton:G,BatchScorecardInput:Be,FormButton:N},b.components);var Se=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"space-y-6"},[t("div",{staticClass:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4"},[t("BackButton"),t("div",{staticClass:"flex flex-col -space-y-1"},[t("BaseTypography",{staticClass:"uppercase text-gray-500",attrs:{variant:"overline"}},[e._v(" Bitsight ")]),t("BaseTypography",{attrs:{variant:"h5",component:"h2"}},[e._v(" Batch Scorecard ")])],1)],1),t("BaseSimpleCard",[t("form",{staticClass:"divide-y",on:{submit:function(a){return a.preventDefault(),e.createBatch.apply(null,arguments)}}},[t("BaseVueQueries",{attrs:{queries:e.queries},scopedSlots:e._u([{key:"success",fn:function(a){var o=a[0],u=a[1];return[t("BatchScorecardInput",{attrs:{id:e.id,users:e.users.data.value||[],companies:o,"bitsight-companies":u},model:{value:e.batch,callback:function(p){e.batch=p},expression:"batch"}})]}}])}),t("FormButton",{attrs:{action:"create","is-valid-form":e.isValidForm}})],1)])],1)},ke=[];const P={};var qe=x(b,Se,ke,!1,Ie,null,null,null);function Ie(e){for(let n in P)this[n]=P[n]}const Le=function(){return qe.exports}();export{Le as default};
