import{B as A}from"./BackButton.4c09ccad.js";import{A as $}from"./AppTanStackTable.8ce5ab19.js";import{u as B,c as P,i,r as I,h as V,g as j,a as O,f as q,e as G,d as U,b as E}from"./createOnChangeFn.d6f04069.js";import{c as N,v as u,n as S,g as z,h as H}from"./index.c995162a.js";import{m as x}from"./multiSet.dcd15b85.js";import"./chevron-left.0808b01b.js";import"./magnifying-glass.b7cbe8fe.js";import"./TransitionExpand.c572906e.js";import"./chevron-up.736f4142.js";const L=[{text:"0-1",isInRange(e){return e>=0&&e<=1}},{text:"2-5",isInRange(e){return e>=2&&e<=5}},{text:"6 and more",isInRange(e){return e>=6}}],p={};p.props={products:{key:"products",required:!0,type:Array}};p.setup=(e,o)=>{const n=e,g=N(()=>n.products.map(t=>{const{id:r,name:a,manufacturer:c,categories:s,type:T,price:b}=t,w=m(c.id),f=L.find(_=>_.isInRange(w));return{id:r,product:{name:a,productCount:w,countGroup:f==null?void 0:f.text},manufacturer:c,categories:s.map(({name:_})=>_),type:T,price:b}}).sort((t,r)=>t.product.name.localeCompare(r.product.name)));function m(t){const r=[];for(const a of n.products)t===a.manufacturer.id&&r.push(a);return r.length}const l=P(),k=[l.accessor("product",{header:()=>"Product",cell:t=>t.getValue().name,filterFn(t,r,a){return t.original.product.countGroup===a}}),l.accessor(t=>t.manufacturer.name,{id:"manufacturer",header:()=>"Manufacturer"}),l.accessor("categories",{header:()=>"Categories",cell:t=>t.getValue().join(", "),filterFn:"arrIncludes"}),l.accessor(t=>t.type.name,{id:"type",header:()=>"Product Type"}),l.accessor("price",{header:()=>"Price Range",filterFn:"equalsString"})],h=u([]),v=u({pageIndex:0,pageSize:10}),R=u(""),F=u([]),C=u({});return{instance:B({get data(){return g.value},columns:k,state:{get sorting(){return h.value},get pagination(){return v.value},get globalFilter(){return R.value},get columnFilters(){return F.value},get rowSelection(){return C.value}},onSortingChange:i(h),onPaginationChange:i(v),onColumnFiltersChange:i(F),onGlobalFilterChange:i(R),globalFilterFn:(t,r,a,c)=>{const s=I(t.getValue(r),a,{threshold:V.CONTAINS});return c(s),s.passed},onRowSelectionChange:i(C),getCoreRowModel:j(),getFacetedRowModel:O(),getSortedRowModel:q(),getFacetedUniqueValues(t,r){const a=E();return r==="product"?()=>{const c=t.getColumn(r).getFacetedRowModel();return x(c.flatRows.flatMap(s=>s.original.product.countGroup?[s.original.product.countGroup]:[]))}:r==="categories"?()=>{const c=t.getColumn(r).getFacetedRowModel();return x(c.flatRows.flatMap(s=>s.original.categories?s.original.categories:[]))}:a(t,r)},getPaginationRowModel:G(),getFilteredRowModel:U()})}};p.components=Object.assign({AppTanStackTable:$},p.components);var D=function(){var e=this,o=e.$createElement,n=e._self._c||o;return n("AppTanStackTable",{attrs:{table:e.instance}})},J=[];const M={};var K=S(p,D,J,!1,Q,null,null,null);function Q(e){for(let o in M)this[o]=M[o]}const W=function(){return K.exports}(),d={};d.setup=(e,o)=>({promises:Promise.all([z.get(`${H}/products`)])});d.components=Object.assign({BackButton:A,AdminAdhocMarketplaceTable:W},d.components);var X=function(){var e=this,o=e.$createElement,n=e._self._c||o;return n("section",{staticClass:"space-y-8"},[n("div",{staticClass:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:space-x-4 sm:space-y-0"},[n("BackButton",{attrs:{link:"/admin/reports"}}),n("div",{staticClass:"flex flex-col"},[n("BaseTypography",{attrs:{component:"h2",variant:"h5"}},[e._v("Marketplace")]),n("BaseTypography",{staticClass:"uppercase text-gray-600",attrs:{variant:"overline"}},[e._v(" Adhoc Report ")])],1)],1),e.promises?n("BasePromise",{attrs:{promise:e.promises},scopedSlots:e._u([{key:"success",fn:function(g){var m=g.result,l=m[0];return[n("AdminAdhocMarketplaceTable",{attrs:{products:l.data}})]}}],null,!1,486391857)}):e._e()],1)},Y=[];const y={};var Z=S(d,X,Y,!1,ee,null,null,null);function ee(e){for(let o in y)this[o]=y[o]}const pe=function(){return Z.exports}();export{pe as default};
