import{aT as h,aD as k,aP as S,aQ as B,d as c,aS as _,br as C,n as g,bs as $,c7 as y}from"./index.26316912.js";import{A as x,T}from"./AppTanStackTable.ff78a220.js";import{B as I}from"./BitsightLevelBadge.a7c3d66d.js";import{c as w}from"./createOnChangeFn.9cab1532.js";import{u as F}from"./createSimpleTable.4e220709.js";import{f as A}from"./index.fcf0a8ca.js";import{u as L}from"./useBitsightCompanies.ba9e2dfe.js";import"./magnifying-glass.b7cbe8fe.js";import"./TransitionExpand.ac6964cd.js";import"./chevron-up.736f4142.js";import"./index.b719de00.js";import"./index.7a54c9f6.js";const D={set(e){const n=h();return k(()=>S.post(`${B}/companies/${e.value}/bitsight/sync`).then(t=>t.data),{onSuccess(){n.invalidateQueries(["companies",e,"bitsight","sync"],{exact:!0})}})}},u={};u.props={id:{key:"id",required:!0,type:String},subId:{key:"subId",required:!1,type:String},companies:{key:"companies",required:!0,type:Array}};u.setup=(e,n)=>{const t=e,l=c(()=>t.id),r=c(()=>t.subId),i=c(()=>t.companies.map(a=>{const{data:s}=a,d=A(new Date(s.rating_date));return{id:s.guid,name:s.name,domain:s.primary_domain,score:s.rating,lastUpdated:d,industry:s.industry,network:s.network_size_v4}})),o=w(),m=[o.accessor("name",{header:()=>"Name",enableColumnFilter:!1}),o.accessor("domain",{header:()=>"Domain",enableColumnFilter:!1}),o.accessor("score",{header:()=>"Score",cell:a=>_(I,{props:{value:a.getValue()}}),enableColumnFilter:!1}),o.accessor("lastUpdated",{header:()=>"LastUpdated",cell:a=>_(C,{props:{value:a.getValue(),format:"date"}}),enableColumnFilter:!1}),o.accessor("industry",{header:()=>"Industry",enableColumnFilter:!1}),o.accessor("network",{header:()=>"Network Size",enableColumnFilter:!1}),o.display({id:"actions",header:"Actions",cell:({row:a})=>_(T,{props:{actions:[{id:"view",to:r.value?`/admin/companies/${l.value}/subscriptions/${r.value}/integrations/1/companies/${a.original.id}/cyber-risk`:`/admin/companies/${l.value}/cyber-risk-rating/rating-service-1/companies/${a.original.id}`}]}})})];return{instance:F(i,m)}};u.components=Object.assign({AppTanStackTable:x},u.components);var U=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("AppTanStackTable",{attrs:{table:e.instance}})},j=[];const b={};var q=g(u,U,j,!1,z,null,null,null);function z(e){for(let n in b)this[n]=b[n]}const E=function(){return q.exports}(),p={};p.setup=(e,n)=>{const t=y("id"),l=y("subscriptionId"),r=L.list(t),i=D.set(t),o=c(()=>{var a,s;return((s=(a=i.data.value)==null?void 0:a.companies)==null?void 0:s.map(d=>({data:d})))||r.data.value}),m=c(()=>r.isLoading.value||i.isLoading.value);async function f(){await i.mutateAsync()}return{id:t,subscriptionId:l,companiesToShow:o,isLoading:m,createSync:f}};p.components=Object.assign({BackButton:$,BitsightCompaniesTable:E},p.components);var M=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("BaseTablePageLayout",{scopedSlots:e._u([{key:"backButton",fn:function(){return[t("BackButton",{attrs:{link:".."}})]},proxy:!0},{key:"overline",fn:function(){return[e._v("Bitsight")]},proxy:!0},{key:"title",fn:function(){return[e._v("Companies")]},proxy:!0},{key:"button",fn:function(){return[t("BaseButton",{staticClass:"self-start",attrs:{shape:"rectangle",type:"button",disabled:e.isLoading},on:{click:e.createSync}},[e._v(" Update ")])]},proxy:!0},{key:"table",fn:function(){return[e.companiesToShow?t("BitsightCompaniesTable",{attrs:{id:e.id,"sub-id":e.subscriptionId,companies:e.companiesToShow}}):e._e()]},proxy:!0}])})},O=[];const v={};var P=g(p,M,O,!1,Q,null,null,null);function Q(e){for(let n in v)this[n]=v[n]}const te=function(){return P.exports}();export{te as default};
