import{aB as m,c as i,bA as P,n as f,cH as D,b4 as N,ak as X,L as H,c8 as z,cF as G,c0 as U,b$ as J,cG as W}from"./index.9af642c0.js";import{D as Y}from"./DynamicForm.578cfef7.js";const S={};S.props={value:{key:"value",required:!1,type:Array},options:{key:"options",required:!0,type:Array}};S.setup=(e,s)=>{const t=e,o=s.emit,a=m(t,o),l=i(()=>{var u;const r=new Map;for(const c of t.options){const p=(u=c.id)==null?void 0:u.value;p&&!r.has(p)&&r.set(p,c)}return r}),v=i({get(){return t.value},set(r){r&&(a.value=r)}}),n=P(r=>{const u=[],c=Array.from(r.target.selectedOptions);for(const p of c){const _=p.value,d=l.value.get(_);u.push({id:{value:_},label:(d==null?void 0:d.label)||"",value:(d==null?void 0:d.value)||"",riskScore:(d==null?void 0:d.riskScore)||0})}a.value=u},1600);return{multiselected:v,debouncedMultiselect:n}};var Z=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("BaseSelect",{staticClass:"w-full max-h-44",attrs:{"model-value":e.multiselected,multiple:""},on:{input:e.debouncedMultiselect}},[t("option",{attrs:{label:""},domProps:{value:void 0}}),e._l(e.options,function(o,a){return t("option",{key:a,staticClass:"whitespace-normal",attrs:{label:o.label},domProps:{value:o.id?o.id.value:void 0}})})],2)},V=[];const j={};var ee=f(S,Z,V,!1,te,null,null,null);function te(e){for(let s in j)this[s]=j[s]}const se=function(){return ee.exports}(),y={};y.props={value:{key:"value",required:!1,type:null},options:{key:"options",required:!0,type:Array}};y.setup=(e,s)=>{const t=e,o=s.emit,a=m(t,o),l=i(()=>{var r;const n=new Map;for(const u of t.options){const c=(r=u.id)==null?void 0:r.value;c&&!n.has(c)&&n.set(c,u)}return n});return{multiselected:i({get(){var u;const n=[],r=(u=t.value)==null?void 0:u.answer;if((r==null?void 0:r.oneofKind)==="answerText"){const c=r.answerText.split(",");for(const p of c){const _=l.value.get(p);n.push({id:{value:p},label:(_==null?void 0:_.label)||"",value:(_==null?void 0:_.value)||"",riskScore:(_==null?void 0:_.riskScore)||0})}return n}},set(n){if(n){const r=n.map(c=>{var p;return(p=c.id)==null?void 0:p.value}).join(),u=n.map(c=>c.riskScore).reduce((c,p)=>c+p,0);a.value={answer:{oneofKind:"answerText",answerText:r},riskScore:u}}else a.value={answer:{oneofKind:void 0},riskScore:0}}})}};y.components=Object.assign({QuestionTypeCheckboxEntryInput:se},y.components);var ne=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("QuestionTypeCheckboxEntryInput",{attrs:{options:e.options},model:{value:e.multiselected,callback:function(o){e.multiselected=o},expression:"multiselected"}})},oe=[];const R={};var re=f(y,ne,oe,!1,ae,null,null,null);function ae(e){for(let s in R)this[s]=R[s]}const ce=function(){return re.exports}(),b={};b.props={value:{key:"value",required:!1,type:null},options:{key:"options",required:!0,type:Array}};b.setup=(e,s)=>{const t=e,o=s.emit,a=m(t,o),l=i(()=>{var r;const n=new Map;for(const u of t.options){const c=(r=u.id)==null?void 0:r.value;c&&!n.has(c)&&n.set(c,u)}return n});return{selected:i({get(){var r;const n=(r=t.value)==null?void 0:r.answer;if((n==null?void 0:n.oneofKind)==="answerId"){const u=n.answerId.value;return l.value.get(u)}},set(n){n&&n.id?a.value={answer:{oneofKind:"answerId",answerId:n.id},riskScore:n.riskScore}:a.value={answer:{oneofKind:void 0},riskScore:0}}})}};var ue=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("BaseSelect",{staticClass:"w-full",model:{value:e.selected,callback:function(o){e.selected=o},expression:"selected"}},[t("option",{attrs:{label:""},domProps:{value:void 0}}),e._l(e.options,function(o){return t("option",{key:o.value,staticClass:"whitespace-normal",attrs:{label:o.label},domProps:{value:o}})})],2)},le=[];const E={};var ie=f(b,ue,le,!1,pe,null,null,null);function pe(e){for(let s in E)this[s]=E[s]}const ve=function(){return ie.exports}(),q={};q.props={value:{key:"value",required:!1,type:null}};q.setup=(e,s)=>{const t=e,o=s.emit,a=m(t,o),l=i({get(){var r;const n=(r=t.value)==null?void 0:r.answer;if((n==null?void 0:n.oneofKind)==="answerText")return n.answerText},set(n){n?a.value={answer:{oneofKind:"answerText",answerText:n},riskScore:0}:a.value={answer:{oneofKind:void 0},riskScore:0}}}),v=P(n=>{a.value={...a.value,answer:{oneofKind:"answerText",answerText:n.target.value},riskScore:0}},6200);return{input:l,debouncedInput:v}};var _e=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("BaseTextarea",{staticClass:"w-full",attrs:{"model-value":e.input,rows:"3"},on:{input:e.debouncedInput}})},de=[];const M={};var fe=f(q,_e,de,!1,me,null,null,null);function me(e){for(let s in M)this[s]=M[s]}const ye=function(){return fe.exports}(),x={};x.props={type:{key:"type",required:!0,type:String},value:{key:"value",required:!1,type:null},options:{key:"options",required:!1,type:Array}};x.setup=(e,s)=>{const t=e,o=s.emit,a=m(t,o),l=i(()=>t.type),v=i(()=>l.value==="TEXTAREA"),n=i(()=>l.value==="LIST"),r=i(()=>l.value==="CHECKBOX"),u=i({get(){return t.value},set(c){c&&(a.value=c)}});return{isTextarea:v,isSelect:n,isMultiselect:r,answer:u}};x.components=Object.assign({QuestionTypeTextareaInput:ye,QuestionTypeListInput:ve,QuestionTypeCheckboxInput:ce},x.components);var xe=function(){var e=this,s=e.$createElement,t=e._self._c||s;return e.isTextarea?t("div",[t("QuestionTypeTextareaInput",{model:{value:e.answer,callback:function(o){e.answer=o},expression:"answer"}})],1):e.isSelect?t("div",[t("QuestionTypeListInput",{attrs:{options:e.options||[]},model:{value:e.answer,callback:function(o){e.answer=o},expression:"answer"}})],1):e.isMultiselect?t("div",[t("QuestionTypeCheckboxInput",{attrs:{options:e.options||[]},model:{value:e.answer,callback:function(o){e.answer=o},expression:"answer"}})],1):t("div",[e._v("FIXME: Uncaught exception")])},we=[];const Q={};var $e=f(x,xe,we,!1,ke,null,null,null);function ke(e){for(let s in Q)this[s]=Q[s]}const he=function(){return $e.exports}(),w={};w.props={value:{key:"value",required:!1,type:null},answers:{key:"answers",required:!0,type:Array}};w.setup=(e,s)=>{const t=e,o=s.emit;m(t,o);const a=i(()=>t.answers.find(n=>{var r,u,c;return((r=n.questionAnswerId)==null?void 0:r.value)===((c=(u=t.value)==null?void 0:u.id)==null?void 0:c.value)})),l=i({get(){var n,r;return(r=(n=a.value)==null?void 0:n.questionAnswerId)!=null&&r.value?a.value:D.create()},set(n){var r,u;(u=(r=a.value)==null?void 0:r.questionAnswerId)!=null&&u.value?console.log("update",n):console.log("create",n)}}),v=i(()=>{var n,r;return((r=(n=t.value)==null?void 0:n.answerSet)==null?void 0:r.answers)||[]});return{answer:l,options:v}};w.components=Object.assign({AnswerListEntryInput:he},w.components);var ge=function(){var e=this,s=e.$createElement,t=e._self._c||s;return e.value?t("BaseLabel",[t("span",[e._v(e._s(e.value.text))]),t("AnswerListEntryInput",{attrs:{type:e.value.questionType,options:e.options},model:{value:e.answer,callback:function(o){e.answer=o},expression:"answer"}})],1):e._e()},Se=[];const B={};var be=f(w,ge,Se,!1,qe,null,null,null);function qe(e){for(let s in B)this[s]=B[s]}const Ie=function(){return be.exports}(),$={};$.props={value:{key:"value",required:!1,type:null},answers:{key:"answers",required:!0,type:Array}};$.setup=(e,s)=>{const t=e,o=s.emit;return{proxy:m(t,o)}};$.components=Object.assign({CustomAssessmentQuestionInput:Ie},$.components);var Te=function(){var e=this,s=e.$createElement,t=e._self._c||s;return e.value?t("div",e._l(e.value.questions,function(o,a){return t("BaseSimpleCard",{key:a,staticClass:"p-5 space-y-6"},[t("BaseTypography",{staticClass:"text-gray-500 uppercase",attrs:{variant:"overline"}},[e._v(" Question "+e._s(a+1)+" of "+e._s(e.value.questions.length)+" ")]),t("CustomAssessmentQuestionInput",{attrs:{answers:e.answers},model:{value:e.proxy.questions[a],callback:function(l){e.$set(e.proxy.questions,a,l)},expression:"proxy.questions[i]"}})],1)}),1):e._e()},Ce=[];const F={};var Ae=f($,Te,Ce,!1,je,null,null,null);function je(e){for(let s in F)this[s]=F[s]}const Re=function(){return Ae.exports}(),k={};k.props={value:{key:"value",required:!0,type:Array},answers:{key:"answers",required:!0,type:Array}};k.setup=(e,s)=>{const t=e,o=s.emit,a=m(t,o),l=N("section"),v=i(()=>l.value?parseInt(l.value.toString()):0),n=i(()=>t.value.length),r=i(()=>v.value<n.value),u=i(()=>v.value>0),c=X();function p(d){return{query:{...c.value.query,section:d.toString()}}}function _(){window.scrollTo(0,0)}return{proxy:a,sectionIndex:v,totalSections:n,hasNextSection:r,hasPrevSection:u,changeSection:p,scrollToTop:_}};k.components=Object.assign({CustomAssessmentSectionInput:Re},k.components);var Ee=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",e._l(e.value,function(o,a){return t("div",{key:a},[t("fieldset",{directives:[{name:"show",rawName:"v-show",value:a===e.sectionIndex,expression:"i === sectionIndex"}],staticClass:"flex flex-col space-y-6"},[t("legend",{staticClass:"-space-y-2"},[t("BaseTypography",{staticClass:"text-gray-500 uppercase",attrs:{variant:"overline"}},[e._v(" Section "+e._s(a+1)+" of "+e._s(e.totalSections)+" ")]),t("BaseTypography",{attrs:{variant:"h5",component:"h2"}},[e._v(" "+e._s(o.name)+" ")])],1),t("CustomAssessmentSectionInput",{staticClass:"space-y-6",attrs:{answers:e.answers},model:{value:e.proxy[a],callback:function(l){e.$set(e.proxy,a,l)},expression:"proxy[i]"}}),t("div",{staticClass:"flex flex-col space-y-2 lg:flex lg:flex-row lg:justify-between lg:items-center"},[t("BaseButton",{staticClass:"lg:col-span-1 lg:justify-self-start",attrs:{type:"button",action:"secondary",disabled:!e.hasPrevSection,to:e.changeSection(e.sectionIndex-1)},nativeOn:{click:function(l){return e.scrollToTop.apply(null,arguments)}}},[e._v(" Previous Section ")]),e.hasNextSection?t("BaseButton",{staticClass:"lg:col-span-1 lg:justify-self-end",attrs:{type:"button",disabled:!e.hasNextSection,to:e.changeSection(e.sectionIndex+1)},nativeOn:{click:function(l){return e.scrollToTop.apply(null,arguments)}}},[e._v(" Next Section ")]):t("BaseButton",{staticClass:"lg:col-span-1 lg:justify-self-end",attrs:{type:"button",to:`/client/companies/${e.id}/journey/custom-assessments/${e.questionnaireId}/review`}},[e._v(" Review ")])],1)],1)])}),0)},Me=[];const L={};var Qe=f(k,Ee,Me,!1,Be,null,null,null);function Be(e){for(let s in L)this[s]=L[s]}const Fe=function(){return Qe.exports}(),h={};h.props={value:{key:"value",required:!0,type:null},answers:{key:"answers",required:!0,type:Array}};h.setup=(e,s)=>{const t=e,o=s.emit,a=m(t,o),l=i(()=>t.answers),v=[{name:"sections",label:"",component:{is:Fe,attrs:{answers:l.value}}}];return{proxy:a,schema:v}};h.components=Object.assign({DynamicForm:Y},h.components);var Le=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("DynamicForm",{attrs:{schema:e.schema},model:{value:e.proxy,callback:function(o){e.proxy=o},expression:"proxy"}})},Oe=[];const O={};var Ke=f(h,Le,Oe,!1,Pe,null,null,null);function Pe(e){for(let s in O)this[s]=O[s]}const De=function(){return Ke.exports}(),g={};g.setup=(e,s)=>{const t=z("takenId"),o=G.read(t),a=i(()=>o.data.value),l=i(()=>{var c,p;return(p=(c=a.value)==null?void 0:c.questionnaireId)==null?void 0:p.value}),v=U.read(l),n=i(()=>v.data.value||J.CustomQuestionnaire.create()),r=W.list(t),u=i(()=>{var c;return((c=r.data.value)==null?void 0:c.sort((p,_)=>{var I,T,C,A;const d=((T=(I=p.meta)==null?void 0:I.updatedAt)==null?void 0:T.value)||"";return(((A=(C=_.meta)==null?void 0:C.updatedAt)==null?void 0:A.value)||"").localeCompare(d)}))||[]});return{takenRead:o,questionnaireRead:v,questionnaire:n,answersList:r,answers:u}};g.components=Object.assign({LoadingSpinner:H,CustomAssessmentInput:De},g.components);var Ne=function(){var e=this,s=e.$createElement,t=e._self._c||s;return e.takenRead.isLoading.value||e.questionnaireRead.isLoading.value||e.answersList.isLoading.value?t("LoadingSpinner"):t("section",[t("CustomAssessmentInput",{attrs:{answers:e.answers},model:{value:e.questionnaire,callback:function(o){e.questionnaire=o},expression:"questionnaire"}})],1)},Xe=[];const K={};var He=f(g,Ne,Xe,!1,ze,null,null,null);function ze(e){for(let s in K)this[s]=K[s]}const We=function(){return He.exports}();export{We as default};
