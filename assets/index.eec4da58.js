import{bR as F,aI as I,aS as A,n as N,ao as D,bQ as h,c as p,aF as R,r as x}from"./index.3cac3a76.js";import{B as V}from"./BasicConfirmModal.62f7f75b.js";import{A as j,T as E}from"./AppTanStackTable.781950fc.js";import{I as W}from"./IsoDateTimeDisplay.21edd812.js";import{c as Q}from"./createOnChangeFn.59e837a0.js";import{u as q}from"./createSimpleTable.269105f3.js";import"./exclamation-triangle.54812a62.js";import"./BasicModal.72770391.js";import"./magnifying-glass.b7cbe8fe.js";import"./TransitionExpand.7f844c71.js";import"./chevron-up.736f4142.js";const f={};f.props={categories:{key:"categories",required:!0,type:Array}};f.setup=(e,s)=>{const a=e,{categories:g}=F(a),y=s.emit,C=I(),o=Q(),v=[o.accessor(n=>{var r;return(r=n.id)==null?void 0:r.value},{id:"id",header:()=>"ID",enableColumnFilter:!1}),o.accessor("name",{header:()=>"Name",enableColumnFilter:!1}),o.accessor(n=>{var r;return(r=n.meta)==null?void 0:r.updatedAt},{id:"updatedAt",header:()=>"Last Updated",cell:n=>A(W,{props:{value:n.getValue(),format:"date"}}),enableColumnFilter:!1}),o.accessor("description",{header:()=>"Description",enableColumnFilter:!1}),o.display({id:"actions",header:"Actions",cell:({row:n})=>A(E,{props:{actions:[{id:"edit",action(){var r;C.push(`/admin/products/categories/${(r=n.original.id)==null?void 0:r.value}`)}},{id:"delete",action(){y("delete",n.original)}}]}})})];return{instance:q(g,v)}};f.components=Object.assign({AppTanStackTable:j},f.components);var H=function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("AppTanStackTable",{attrs:{table:e.instance}})},L=[];const $={};var O=N(f,H,L,!1,z,null,null,null);function z(e){for(let s in $)this[s]=$[s]}const U=function(){return O.exports}(),_={};_.setup=(e,s)=>{const a=h.list(),g=p(()=>a.data.value?a.data.value.sort((t,c)=>t.name.localeCompare(c.name)):[]),y=R(),C=h.delete(),o=x(),v=x();function P(t){var c;o.value={category:{...t}},v.value=(c=t==null?void 0:t.id)==null?void 0:c.value,b.value=!0}const n=p(()=>h.listIsolatedBundlesAndProducts(v.value)),r=p(()=>{var u,d,m,l;const t=(m=(d=(u=n.value)==null?void 0:u.data)==null?void 0:d.value)==null?void 0:m.bundleSets;return(l=t==null?void 0:t.map(i=>i==null?void 0:i.name))==null?void 0:l.sort((i,k)=>i.localeCompare(k))}),w=p(()=>{var u,d,m;const t=(m=(d=(u=n.value)==null?void 0:u.data)==null?void 0:d.value)==null?void 0:m.products;return t==null?void 0:t.map(l=>l==null?void 0:l.name).sort((l,i)=>l.localeCompare(i))}),S=p(()=>{var t,c;return(c=(t=o==null?void 0:o.value)==null?void 0:t.category)==null?void 0:c.name});async function B(){if(o.value)await C.mutateAsync(o.value),T(),y.success(`Category ${S.value}successfully deleted`);else throw new Error("Invalid request.")}const b=x(!1);function T(){b.value=!1}return{categories:g,setPayload:P,bundlesWithoutCategory:r,productsWithoutCategory:w,categoryName:S,deleteCategory:B,isModalVisible:b,closeModal:T}};_.components=Object.assign({PlusSvg:D,ProductCategoriesTable:U,BasicConfirmModal:V},_.components);var G=function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("section",[a("BaseTablePageLayout",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v("Product Categories")]},proxy:!0},{key:"button",fn:function(){return[a("BaseButton",{staticClass:"space-x-1",attrs:{to:"/admin/products/categories/new"}},[a("PlusSvg",{staticClass:"mr-1 w-5 xl:w-5"}),e._v(" Category ")],1)]},proxy:!0},{key:"table",fn:function(){return[a("ProductCategoriesTable",{attrs:{categories:e.categories},on:{delete:e.setPayload}})]},proxy:!0}])}),a("BasicConfirmModal",{directives:[{name:"show",rawName:"v-show",value:e.isModalVisible,expression:"isModalVisible"}],attrs:{name:e.categoryName,"bundles-template":e.bundlesWithoutCategory,products:e.productsWithoutCategory},on:{click:e.deleteCategory,close:e.closeModal}})],1)},J=[];const M={};var K=N(_,G,J,!1,X,null,null,null);function X(e){for(let s in M)this[s]=M[s]}const ie=function(){return K.exports}();export{ie as default};
