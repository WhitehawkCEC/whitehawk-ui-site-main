import{R as K}from"./arrow-path.24b87f73.js";import{c,aS as I,n as k,L as x,aF as B,cF as A,cG as T,cH as F,cI as D,cJ as L,b$ as j,cK as q,cL as w,cM as V}from"./index.eb77c430.js";import{A as N}from"./AppTanStackTable.61bc5099.js";import{S as R,V as G,a as M}from"./SyncStatusDisplay.bae8f763.js";import{c as H}from"./createOnChangeFn.7bcf0cbf.js";import{u as Y}from"./createSimpleTable.32b9af3d.js";import"./magnifying-glass.b7cbe8fe.js";import"./TransitionExpand.71396fec.js";import"./check-circle.48e4a9f5.js";import"./chevron-up.736f4142.js";const f={};f.props={value:{key:"value",required:!0,type:Array}};f.setup=(e,n)=>{const t=e,y=c(()=>t.value),i=H(),u=[i.accessor("toBeSynced",{header:()=>"To Be Synced",cell:r=>I(R,{props:{value:r.getValue()}}),enableColumnFilter:!1}),i.group({id:"supplier",header:()=>"Supplier",columns:[i.accessor(r=>r.supplier.name,{id:"name",header:()=>"Name",enableColumnFilter:!1}),i.accessor(r=>r.supplier.name,{id:"domain",header:()=>"Domain",enableColumnFilter:!1})]}),i.accessor("syncedFromBlackKite",{header:()=>"Synced From Black Kite?",cell:r=>I(R,{props:{value:r.getValue()}}),enableColumnFilter:!1}),i.accessor("syncedFromCyberOne",{header:()=>"Synced From CyberOne?",cell:r=>I(R,{props:{value:r.getValue()}}),enableColumnFilter:!1})];return{instance:Y(y,u)}};f.components=Object.assign({AppTanStackTable:N},f.components);var z=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("AppTanStackTable",{attrs:{table:e.instance}})},J=[];const h={};var P=k(f,z,J,!1,Q,null,null,null);function Q(e){for(let n in h)this[n]=h[n]}const U=function(){return P.exports}(),b={};b.props={accountId:{key:"accountId",required:!0,type:String},vrmSync:{key:"vrmSync",required:!0,type:null},assets:{key:"assets",required:!0,type:Array},entities:{key:"entities",required:!0,type:Array}};b.setup=(e,n)=>{const t=e,y=c(()=>t.accountId),i=c(()=>t.entities.map(({domain:s})=>s)),u=c(()=>t.assets.map(({domain:s})=>s)),m=c(()=>t.assets.map(({referenceId:s,name:a,domain:o})=>{var l;return{blackKiteId:(l=t.entities.find(d=>d.domain===o))==null?void 0:l.id,cyberOneId:s,name:a,domain:o}})),r=c(()=>m.value.map(s=>({supplier:s,syncedFromBlackKite:s.domain?i.value.includes(s.domain):void 0,syncedFromCyberOne:s.domain?u.value.includes(s.domain):void 0,toBeSynced:s.domain?i.value.includes(s.domain)&&u.value.includes(s.domain):void 0}))),_=c(()=>{const s=[];return r.value.forEach(a=>{if(a.toBeSynced){const{blackKiteId:o,cyberOneId:l}=a.supplier;o&&s.push({target:{oneofKind:"cyberOneAssetId",cyberOneAssetId:l},source:{oneofKind:"blackKiteEntityId",blackKiteEntityId:o}})}}),s}),v=B(),S=A.create(y);async function p(){const s={syncType:T.SyncType.BLACK_KITE_TO_CYBER_ONE,entries:_.value},a=await S.mutateAsync(s);if(a){const o=a.response.syncId;v.success(`Sync ID: ${o}`)}}return{rows:r,mappings:_,syncCreate:S,createSync:p}};b.components=Object.assign({VrmSyncStatusDisplay:G,LoadingSpinner:x,SyncSvg:K,CyberRiskRatingSyncTable:U},b.components);var W=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("section",{staticClass:"space-y-6"},[t("div",{staticClass:"flex flex-col space-y-4 md:flex-row md:items-center md:justify-between md:space-y-0"},[t("VrmSyncStatusDisplay",{attrs:{header:"Cyber Risk Rating Sync",sync:e.vrmSync}}),t("BaseButton",{staticClass:"space-x-1",attrs:{disabled:e.mappings.length===0,shape:"rectangle"},on:{click:e.createSync}},[e.syncCreate.isLoading.value?t("LoadingSpinner"):t("SyncSvg",{staticClass:"w-4 xl:w-5"}),t("span",[e._v("Sync")])],1)],1),t("CyberRiskRatingSyncTable",{attrs:{value:e.rows}})],1)},X=[];const E={};var Z=k(b,W,X,!1,ee,null,null,null);function ee(e){for(let n in E)this[n]=E[n]}const te=function(){return Z.exports}(),g={};g.props={accountId:{key:"accountId",required:!0,type:String},syncType:{key:"syncType",required:!0,type:null},mappedEcosystem:{key:"mappedEcosystem",required:!1,type:Number}};g.setup=(e,n)=>{const t=e,y=c(()=>t.accountId),i=F.get(y),u=c(()=>i.data.value),m=D.get(y),r=c(()=>{var p;return(p=m.data.value)==null?void 0:p.mappedAssetId}),_=L.get(y),v=c(()=>_.data.value);return{syncStatus:c(()=>{var p,s,a,o,l,d;return{source:{mappedSource:t.mappedEcosystem,syncDate:(s=(p=u.value)==null?void 0:p.lastSynced)==null?void 0:s.value,syncedReports:(a=u.value)==null?void 0:a.reportsSynced},target:{mappedTarget:r.value,syncDate:(l=(o=v.value)==null?void 0:o.lastSynced)==null?void 0:l.value,syncedReports:(d=v.value)==null?void 0:d.reportsSynced}}})}};g.components=Object.assign({SyncStatusDisplay:M},g.components);var se=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("SyncStatusDisplay",{attrs:{"sync-status":e.syncStatus,"sync-type":e.syncType}})},ne=[];const $={};var ae=k(g,se,ne,!1,ce,null,null,null);function ce(e){for(let n in $)this[n]=$[n]}const re=function(){return ae.exports}(),C={};C.setup=(e,n)=>{const t=j("id"),y=q.get(t),i=c(()=>{var a;return(a=y.data.value)==null?void 0:a.mappedEcosystemId}),u=A.list(t),m=c(()=>u.data.value?u.data.value.sort((a,o)=>{let l="",d="";return a.lastSynced&&a.lastSynced.value&&o.lastSynced&&o.lastSynced.value&&(l=a.lastSynced.value,d=o.lastSynced.value),l.localeCompare(d)}):[]),r=c(()=>m.value.find(a=>a.syncType===T.SyncType.BLACK_KITE_TO_CYBER_ONE)),_=w.list(t),v=c(()=>_.data.value||[]),S=V.list(t),p=c(()=>S.data.value||[]),s=c(()=>{var a,o,l;return{syncDate:(o=(a=r.value)==null?void 0:a.lastSynced)==null?void 0:o.value,syncedReports:(l=r.value)==null?void 0:l.numSynced}});return{SyncType:T.SyncType,id:t,mappedEcosystem:i,entities:v,assets:p,sync:s}};C.components=Object.assign({CyberRiskRatingSyncStatusDisplay:re,CyberRiskRatingSyncDisplay:te},C.components);var oe=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("main",{staticClass:"space-y-6"},[t("CyberRiskRatingSyncStatusDisplay",{attrs:{"account-id":e.id,"sync-type":e.SyncType.BLACK_KITE_TO_CYBER_ONE,"mapped-ecosystem":e.mappedEcosystem}}),t("CyberRiskRatingSyncDisplay",{attrs:{"account-id":e.id,"vrm-sync":e.sync,entities:e.entities,assets:e.assets}})],1)},ie=[];const O={};var le=k(C,oe,ie,!1,ue,null,null,null);function ue(e){for(let n in O)this[n]=O[n]}const Ce=function(){return le.exports}();export{Ce as default};
