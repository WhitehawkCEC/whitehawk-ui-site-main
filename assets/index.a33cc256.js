import{aB as A,n as _,ax as j,d as u,bs as w,L as D,c8 as C,dv as L,b as M,bG as S,dp as V,aK as F}from"./index.9a64984c.js";import{A as K,S as N}from"./StatusInput.5985ed95.js";import{u as Q}from"./useCompanyScorecardTemplates.51c5bcd9.js";import{u as G}from"./useScorecardTemplates.e5a55b9f.js";import{u as U}from"./useBlackKiteEntities.1552b843.js";import{u as z}from"./useUsers.ca199ff9.js";import{e as m}from"./attributeValue.ea53a720.js";import{s as W}from"./index.994bb501.js";import{t as Y}from"./index.b2c9854f.js";import"./ToolTip.461388be.js";import"./ObjectDisplay.57cbf9b4.js";import"./DynamicForm.0e27e0e9.js";const h={};h.props={value:{key:"value",required:!1,type:Array},options:{key:"options",required:!0,type:Array}};h.setup=(e,a)=>{const t=e,s=a.emit;return{proxy:A(t,s)}};var H=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("BaseLabel",{staticClass:"flex flex-col p-4 lg:grid lg:grid-cols-3 lg:items-center lg:gap-1"},[t("span",{staticClass:"space-x-1"},[e._v(" Companies "),t("span",{staticClass:"text-red-500"},[e._v("*")])]),t("BaseSelect",{staticClass:"lg:col-span-2",attrs:{multiple:""},model:{value:e.proxy,callback:function(s){e.proxy=s},expression:"proxy"}},[t("option",{domProps:{value:null}}),e._l(e.options,function(s){return t("option",{key:s.id,domProps:{value:s}},[t("div",{staticClass:"flex space-x-2"},[t("span",{staticClass:"text-semibold"},[e._v(" "+e._s(s.name)+" ")]),t("span",{staticClass:"text-sm text-gray-500"},[e._v("("+e._s(s.domain)+")")])])])})],2)],1)},J=[];const $={};var X=_(h,H,J,!1,Z,null,null,null);function Z(e){for(let a in $)this[a]=$[a]}const ee=function(){return X.exports}(),b={};b.props={value:{key:"value",required:!1,type:String,default:void 0},options:{key:"options",required:!1,type:Array,default:void 0}};b.setup=(e,a)=>{const t=e,s=a.emit;return{proxy:A(t,s)}};var te=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("BaseLabel",{staticClass:"flex flex-col space-y-1 p-4 lg:grid lg:grid-cols-3 lg:items-center lg:space-y-0"},[e._v(" Template "),t("BaseSelect",{staticClass:"flex flex-col lg:col-span-2",model:{value:e.proxy,callback:function(s){e.proxy=s},expression:"proxy"}},[t("option",{domProps:{value:null}}),e._l(e.options,function(s,l){return t("option",{key:l,domProps:{value:s.split("/")[1]}},[e._v(" "+e._s(s.split("/")[1])+" ")])})],2)],1)},se=[];const B={};var ae=_(b,te,se,!1,ne,null,null,null);function ne(e){for(let a in B)this[a]=B[a]}const oe=function(){return ae.exports}(),d={};d.props={value:{key:"value",required:!1,type:null},users:{key:"users",required:!0,type:Array},entities:{key:"entities",required:!0,type:Array},templates:{key:"templates",required:!0,type:Array},companies:{key:"companies",required:!0,type:Array}};d.setup=(e,a)=>{const t=e,s=a.emit,l=j(t,s),c=u(()=>t.entities.map(r=>({id:parseInt(r.CompanyId),name:r.CompanyName,domain:r.DomainName}))),p=u(()=>t.templates.map(({key:r})=>r));return{proxy:l,entityOptions:c,templateOptions:p}};d.components=Object.assign({TemplateSelect:oe,AnalystInput:K,StatusInput:N,BatchEntitiesSelectV3:ee},d.components);var le=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("section",{staticClass:"flex flex-col divide-y"},[t("div",{staticClass:"flex flex-col divide-y"},[t("h3",{staticClass:"p-4 font-display text-lg font-semibold"},[e._v("Template")]),t("TemplateSelect",{attrs:{options:e.templateOptions},model:{value:e.proxy.template,callback:function(s){e.$set(e.proxy,"template",s)},expression:"proxy.template"}})],1),t("div",{staticClass:"flex flex-col divide-y"},[t("h3",{staticClass:"p-4 font-display text-lg font-semibold"},[e._v(" Analyst Information ")]),t("AnalystInput",{attrs:{users:e.users},model:{value:e.proxy.analyst,callback:function(s){e.$set(e.proxy,"analyst",s)},expression:"proxy.analyst"}})],1),t("div",{staticClass:"flex flex-col divide-y"},[t("h3",{staticClass:"p-4 font-display text-lg font-semibold"},[e._v("Status")]),t("StatusInput",{model:{value:e.proxy.status,callback:function(s){e.$set(e.proxy,"status",s)},expression:"proxy.status"}})],1),t("div",{staticClass:"flex flex-col divide-y"},[t("h3",{staticClass:"p-4 font-display text-lg font-semibold"},[e._v("Select Companies")]),t("BatchEntitiesSelectV3",{attrs:{options:e.entityOptions},model:{value:e.proxy.entities,callback:function(s){e.$set(e.proxy,"entities",s)},expression:"proxy.entities"}})],1)])},re=[];const k={};var ie=_(d,le,re,!1,ce,null,null,null);function ce(e){for(let a in k)this[a]=k[a]}const ue=function(){return ie.exports}(),f={};f.setup=(e,a)=>{const t=C("id"),s=C("subscriptionId"),l=L.create(t,s),c=M(!1),p=[S.list(),U.list(t),G.list()],r=Q.get(t),g=z.list(),I=u(()=>{var i;return(i=g.data.value)==null?void 0:i.map(o=>({id:{value:m(o,"sub")},name:m(o,"name")||"",title:m(o,"custom:title")||"",email:m(o,"email"),phone:m(o,"phone_number")||""})).find(o=>o.email==="consultingservices@whitehawk.com")}),x=S.read(t),E=u(()=>{if(x.data.value)return{id:{value:x.data.value.id},name:x.data.value.name}}),n=W(u(()=>{var y;const i=new Date,o=i.getUTCFullYear(),v=`Q${Math.ceil((i.getMonth()+1)/4)}`;return{id:t,company:E.value,analyst:I.value,template:((y=r.data.value)==null?void 0:y.split("/")[1])||"",status:{state:V.State.IN_PROGRESS,year:o,quarter:Y(v)},includeCmmc:!0,entities:[]}})),R=u(()=>n.value?!(n.value.entities.length>0&&n.value.analyst&&n.value.company&&n.value.status&&n.value.template):!0),T=F();async function O(){var i,o,v;if(c.value=!0,n.value){const y={company:n.value.company,analyst:n.value.analyst,status:n.value.status,includeCmmc:(i=n.value)==null?void 0:i.includeCmmc,template:n.value.template,entities:(o=n.value)==null?void 0:o.entities},{response:P}=await l.mutateAsync(y);(v=P.batchId)!=null&&v.value&&(c.value=!1,T.push(`/admin/companies/${t.value}/subscriptions/${s.value}/integrations/2/scorecards/batch`))}}return{isLoading:c,queries:p,users:g,batch:n,isDisabled:R,createBatch:O}};f.components=Object.assign({BackButton:w,BatchScorecardInputV3:ue,LoadingSpinner:D},f.components);var pe=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"space-y-6"},[t("div",{staticClass:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4"},[t("BackButton"),t("div",{staticClass:"flex flex-col -space-y-1"},[t("BaseTypography",{staticClass:"uppercase text-gray-500",attrs:{variant:"overline"}},[e._v(" Black Kite ")]),t("BaseTypography",{attrs:{variant:"h5",component:"h2"}},[e._v(" Batch Scorecard ")])],1)],1),t("BaseSimpleCard",[t("form",{staticClass:"divide-y",on:{submit:function(s){return s.preventDefault(),e.createBatch.apply(null,arguments)}}},[t("BaseVueQueries",{attrs:{queries:e.queries},scopedSlots:e._u([{key:"success",fn:function(s){var l=s[0],c=s[1],p=s[2];return[t("BatchScorecardInputV3",{attrs:{users:e.users.data.value||[],companies:l,entities:c,templates:p},model:{value:e.batch,callback:function(r){e.batch=r},expression:"batch"}})]}}])}),t("div",{staticClass:"p-4"},[t("BaseButton",{attrs:{disabled:e.isDisabled}},[e.isLoading?t("LoadingSpinner"):t("span",[e._v("Create Batch")])],1)],1)],1)])],1)},me=[];const q={};var de=_(f,pe,me,!1,ve,null,null,null);function ve(e){for(let a in q)this[a]=q[a]}const qe=function(){return de.exports}();export{qe as default};
