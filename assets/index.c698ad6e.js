import{aT as w,aD as F,ag as j,aP as S,aQ as M,br as q,aO as V,n as $,c as k,aI as N,aF as I,aS as g,bS as E,ao as O,r as b}from"./index.32191fe8.js";import{B as L}from"./BasicModalWithButton.2c155826.js";import{A as z,R as H}from"./RowSelectionInput.5a5b9d4e.js";import{A as U,T as W}from"./AppTanStackTable.498a694f.js";import{c as X}from"./createOnChangeFn.5563c4dd.js";import{u as Y}from"./useProducts.ce625075.js";import{u as G}from"./createSimpleTable.6c1099a7.js";import{u as A}from"./useManufacturers.887f9283.js";import"./magnifying-glass.b7cbe8fe.js";import"./TransitionExpand.89062899.js";import"./chevron-up.736f4142.js";const B={create(){const e=w();return F(s=>S.post(`${M}/featured-manufacturers`,s).then(a=>a.data),{onSuccess(){e.invalidateQueries(["manufacturers"],{exact:!0})}})},delete(){const e=w();return F(s=>S.delete(`${M}/featured-manufacturers/${s}`).then(a=>a.data),{onSuccess(){e.invalidateQueries(["manufacturers"],{exact:!0})}})},list(){return j(["featured-manufacturers"],()=>S.get(`${M}/featured-manufacturers`).then(e=>e.data))}},f={};f.props={value:{key:"value",required:!1,type:String},remove:{key:"remove",required:!0,type:Function}};f.setup=(e,s)=>({});f.components=Object.assign({DateIsoStringDisplay:q,XSvg:V},f.components);var J=function(){var e=this,s=e.$createElement,a=e._self._c||s;return e.value?a("div",{staticClass:"flex items-center space-x-1"},[a("DateIsoStringDisplay",{staticClass:"inline-flex items-center rounded bg-indigo-100 px-2 py-0.5 text-xs font-medium uppercase leading-4 tracking-widest text-indigo-800",attrs:{value:e.value,format:"date"}}),a("BaseIcon",{attrs:{color:"danger",size:"small",action:"secondary"},on:{click:e.remove}},[a("XSvg",{staticClass:"w-3"})],1)],1):e._e()},K=[];const T={};var Z=$(f,J,K,!1,ee,null,null,null);function ee(e){for(let s in T)this[s]=T[s]}const te=function(){return Z.exports}(),m={};m.props={manufacturers:{key:"manufacturers",required:!0,type:Array}};m.setup=(e,s)=>{const a=e,o=s.emit,i=k(()=>a.manufacturers.map(t=>{const{id:n,name:u,url:y,featured:Q}=t;return{id:n,name:u,url:y,featured:Q,productCount:P(n)}})),d=Y.list(),p=k(()=>d.data.value||[]),c=N(),l=I(),_=B.create(),x=B.delete(),r=X(),v=[r.display({id:"select",header:({table:t})=>g(z,{props:{table:t}}),cell:({row:t})=>g(H,{props:{row:t}})}),r.accessor("id",{header:()=>"ID",enableColumnFilter:!1}),r.accessor("name",{header:()=>"Name",enableColumnFilter:!1}),r.accessor("url",{header:()=>"URL",enableColumnFilter:!1}),r.accessor(t=>t.featured,{id:"featured",header:()=>"Featured",cell:t=>g(te,{props:{value:t.getValue(),async remove(){await x.mutateAsync(t.row.original.id)&&l.success("Featured removed successfully.")}}}),enableColumnFilter:!1}),r.accessor(t=>t.productCount,{id:"productCount",header:()=>"Product Count",enableColumnFilter:!1}),r.display({id:"actions",header:"Actions",cell:({row:t})=>g(W,{props:{actions:[{id:"view",action(){c.push(`/admin/manufacturers/${t.original.id}/products`)}},{id:"edit",action(){c.push(`/admin/manufacturers/${t.original.id}`)}},{id:"delete",action(){o("delete",t.original)}},{id:"setFeatured",async action(){await _.mutateAsync({id:t.original.id,name:t.original.name})&&l.success("Successfully featured manufacturer.")}}].filter(n=>t.original.featured?n.id!=="setFeatured"&&n.id!=="delete":t.original.productCount>1&&!t.original.featured?n.id!=="delete":n)}})})],C=G(i,v);function P(t){const n=[];return p.value.map(u=>{u.manufacturer.id===t&&n.push(u)}),n.length}return{instance:C,bulkActions:[{id:"setFeatured",async action(){const t=C.getSelectedRowModel().rows,n=[];if(t.length>0){for(const u of t)if(!u.original.featured){const y=await _.mutateAsync({id:u.original.id,name:u.original.name});y&&n.push(y.id)}l.success(`Successfully Featured ${n.length}/${t.length} Manufacturers(s).`)}else l.error("You must select a row.")}}]}};m.components=Object.assign({AppTanStackTable:U},m.components);var ae=function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("AppTanStackTable",{attrs:{table:e.instance,"table-actions":e.bulkActions}})},se=[];const D={};var ne=$(m,ae,se,!1,re,null,null,null);function re(e){for(let s in D)this[s]=D[s]}const ue=function(){return ne.exports}(),h={};h.setup=(e,s)=>{const a=A.list(),o=I(),i=A.delete(),d=b(""),p=b(""),c=b(!1),l=b("delete");function _(v){d.value=v.id,p.value=v.name,c.value=!0}async function x(){d?(await i.mutateAsync(d.value),r(),o.success("Successfully deleted manufacturer.")):o.error("Something went wrong.")}function r(){c.value=!1}return{manufacturers:a,manufacturerName:p,isModalVisible:c,btn:l,toggleModal:_,deleteManufacturer:x,closeModal:r}};h.components=Object.assign({BaseTablePageLayout:E,PlusSvg:O,ManufacturersTable:ue,BasicModalWithButton:L},h.components);var oe=function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("section",[a("BaseTablePageLayout",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v("Manufacturers")]},proxy:!0},{key:"button",fn:function(){return[a("BaseButton",{staticClass:"w-full space-x-2 md:w-auto",attrs:{to:"/admin/manufacturers/new"}},[a("PlusSvg",{staticClass:"h-auto w-4 xl:w-5"}),a("span",[e._v("Manufacturer")])],1)]},proxy:!0},{key:"table",fn:function(){return[a("BaseVueQuery",{attrs:{query:e.manufacturers},scopedSlots:e._u([{key:"success",fn:function(o){var i=o.data;return[a("ManufacturersTable",{attrs:{manufacturers:i},on:{delete:e.toggleModal}})]}}])})]},proxy:!0}])}),a("BasicModalWithButton",{directives:[{name:"show",rawName:"v-show",value:e.isModalVisible,expression:"isModalVisible"}],attrs:{"button-text":e.btn},on:{close:e.closeModal,delete:e.deleteManufacturer},scopedSlots:e._u([{key:"body",fn:function(){return[e._v(" Do you want to delete "),a("span",{staticClass:"px-1 text-red-500"},[e._v(e._s(e.manufacturerName))]),e._v(" manufacturer? ")]},proxy:!0}])})],1)},ce=[];const R={};var le=$(h,oe,ce,!1,ie,null,null,null);function ie(e){for(let s in R)this[s]=R[s]}const Me=function(){return le.exports}();export{Me as default};
