import{U}from"./arrow-down-on-square.bf61cdc5.js";import{T as E}from"./trash.78f57a7a.js";import{ai as O,aQ as G,aR as z,aC as H,n as m,az as L,bA as W,d as p,c1 as J,r as C,bH as y,aB as h,aJ as N,aG as V,ct as S,aH as K,aI as X}from"./index.482ebe0b.js";import{C as Y,u as Z}from"./CompanyInput.a9abb795.js";import{c as ee}from"./cloneDeep.852e7b10.js";import{u as te}from"./useCompanyAccess.0e467afb.js";import"./DynamicForm.410b618f.js";import"./AddressClaimInput.fb98e7c3.js";import"./index.c8170383.js";import"./FormValidation.907ef868.js";import"./_Uint8Array.47847c5c.js";import"./keys.b9711bfe.js";import"./_baseAssignValue.a039243f.js";import"./_copyArray.56331c81.js";const se={list(){return O(["company-features"],()=>G.get(`${z}/company-features`).then(e=>e.data))}},d={};d.props={value:{key:"value",required:!1,type:Array},options:{key:"options",required:!0,type:Array}};d.setup=(e,a)=>{const t=e,s=a.emit;return{proxy:H(t,s)}};var ae=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("section",{staticClass:"grid gap-4 lg:grid-cols-2 xl:grid-cols-3"},e._l(e.options,function(s){return t("BaseLabel",{key:s.id,staticClass:"flex items-center space-x-1"},[t("BaseInput",{attrs:{type:"checkbox",value:s,disabled:!0},model:{value:e.proxy,callback:function(n){e.proxy=n},expression:"proxy"}}),t("span",[e._v(e._s(s.display))])],1)}),1)},ne=[];const b={};var re=m(d,ae,ne,!1,oe,null,null,null);function oe(e){for(let a in b)this[a]=b[a]}const ie=function(){return re.exports}(),i={};i.props={value:{key:"value",required:!1,type:null},options:{key:"options",required:!0,type:Array}};i.setup=(e,a)=>{const t=e,s=a.emit;return{proxy:L(t,s)}};i.components=Object.assign({FeaturesInput:ie},i.components);var ce=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("FeaturesInput",{staticClass:"p-4",attrs:{options:e.options},model:{value:e.proxy.features,callback:function(s){e.$set(e.proxy,"features",s)},expression:"proxy.features"}})},ue=[];const g={};var pe=m(i,ce,ue,!1,le,null,null,null);function le(e){for(let a in g)this[a]=g[a]}const me=function(){return pe.exports}(),c={};c.props={id:{key:"id",required:!0,type:String},access:{key:"access",required:!0,type:Array}};c.setup=(e,a)=>{const t=e;return{companyId:p(()=>t.id)}};c.components=Object.assign({GravatarImg:W},c.components);var ye=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("BaseSimpleCard",{staticClass:"divide-y"},[t("div",{staticClass:"flex items-center space-x-1 p-4"},[t("BaseTypography",{attrs:{component:"h3",variant:"subtitle3"}},[e._v(" Members ")]),t("BaseTypography",{staticClass:"text-gray-500",attrs:{variant:"overline"}},[e._v(" ("+e._s(e.access.length)+") ")])],1),t("ul",{staticClass:"flex -space-x-2 overflow-y-auto p-4"},e._l(e.access,function(s){return t("li",{key:s.user.id,staticClass:"flex-shrink-0"},[t("BaseLink",{attrs:{to:`/admin/companies/${e.companyId}/members/${s.user.id}`}},[t("GravatarImg",{staticClass:"shadow-solid inline-block h-10 w-10 rounded-full",attrs:{email:s.user.email,alt:`Avatar for ${s.user.email}`}})],1)],1)}),0)])},de=[];const $={};var ve=m(c,ye,de,!1,_e,null,null,null);function _e(e){for(let a in $)this[a]=$[a]}const fe=function(){return ve.exports}(),l={};l.setup=(e,a)=>{const t=J("id"),s=C(),n=y.read(t),o=Z.list();h(()=>n.data.value,r=>{r&&(s.value=ee(r))},{immediate:!0});const B=N(),v=V(),F=y.update(t);async function A(){s.value&&(await F.mutateAsync(s.value),v.success("Saved"))}const I=y.delete(t);async function w(){await I.mutateAsync(),B.push("/companies")}const u=C(),Q=se.list(),q=S.read(t),P=K(),_=p(()=>P.company);h(()=>q.data.value,r=>{r&&_.value&&(u.value={company:_.value,features:r.features})},{immediate:!0});const j=S.update(t);async function D(){u.value&&(await j.mutateAsync(u.value),v.success("Saved"))}const f=X(),M=p(()=>f.isAdmin),R=p(()=>{var x;return((x=f.email)==null?void 0:x.split("@")[1])=="whitehawk.com"&&M.value}),T=te.list(t);return{id:t,company:s,industriesQuery:o,updateCompany:A,deleteCompany:w,companyFeatures:u,featuresQuery:Q,saveFeatures:D,isWhitehawkAdmin:R,companyAccessQuery:T,enableFeaturePermission:!1}};l.components=Object.assign({CompanyInput:Y,SaveSvg:U,TrashSvg:E,CompanyFeaturesPermissionInput:me,MembersDisplay:fe},l.components);var xe=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("section",{staticClass:"space-y-6"},[t("ClientOnly",[t("BaseSimpleCard",{staticClass:"divide-y"},[t("BaseTypography",{staticClass:"p-4",attrs:{component:"h3",variant:"subtitle3"}},[e._v(" Attributes ")]),t("form",{staticClass:"flex flex-col divide-y",on:{submit:function(s){return s.preventDefault(),e.updateCompany.apply(null,arguments)}}},[t("BaseVueQuery",{attrs:{query:e.industriesQuery},scopedSlots:e._u([{key:"success",fn:function(s){var n=s.data;return[t("CompanyInput",{attrs:{industries:n,"is-readonly":!0},model:{value:e.company,callback:function(o){e.company=o},expression:"company"}})]}}])}),t("div",{staticClass:"flex flex-col space-y-2 p-4 md:flex-row md:items-center md:space-x-2 md:space-y-0"},[t("BaseButton",{staticClass:"space-x-2"},[t("SaveSvg",{staticClass:"w-5"}),t("span",[e._v("Save")])],1),e.isWhitehawkAdmin?t("BaseButton",{staticClass:"space-x-2",attrs:{type:"button",action:"secondary","display-type":"danger"},on:{click:e.deleteCompany}},[t("TrashSvg",{staticClass:"w-5"}),t("span",[e._v("Delete")])],1):e._e()],1)],1)],1),t("BaseSimpleCard",{staticClass:"divide-y"},[t("BaseTypography",{staticClass:"p-4",attrs:{component:"h2",variant:"subtitle3"}},[e._v(" Edit Permissions ")]),t("form",{staticClass:"divide-y",on:{submit:function(s){return s.preventDefault(),e.saveFeatures.apply(null,arguments)}}},[t("BaseVueQuery",{attrs:{query:e.featuresQuery},scopedSlots:e._u([{key:"success",fn:function(s){var n=s.data;return[t("CompanyFeaturesPermissionInput",{attrs:{options:n},model:{value:e.companyFeatures,callback:function(o){e.companyFeatures=o},expression:"companyFeatures"}})]}}])}),e.enableFeaturePermission?t("div",{staticClass:"p-4"},[t("BaseButton",{staticClass:"space-x-2"},[t("SaveSvg",{staticClass:"w-5"}),t("span",[e._v("Save")])],1)],1):e._e()],1)],1),t("BaseVueQuery",{attrs:{query:e.companyAccessQuery},scopedSlots:e._u([{key:"success",fn:function(s){var n=s.data;return[t("MembersDisplay",{attrs:{id:e.id,access:n}})]}}])})],1)],1)},Ce=[];const k={};var he=m(l,xe,Ce,!1,Se,null,null,null);function Se(e){for(let a in k)this[a]=k[a]}const Re=function(){return he.exports}();export{Re as default};
