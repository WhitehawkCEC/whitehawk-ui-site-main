import{aI as V,c as F,aF as I,aR as u,bp as q,aY as d,aO as _,aP as h,n as T,ap as B,bX as P}from"./index.25a43275.js";import{A as U,R as j}from"./RowSelectionInput.843d78a9.js";import{A as D,T as N}from"./AppTanStackTable.89c88ce5.js";import{S as O}from"./ScorecardStatusBadge.b78dd252.js";import{u as Q,c as E,i as p,r as Y,h as z,g as H,f as G,b as L,e as X,d as J}from"./createOnChangeFn.eb918db9.js";import{F as K}from"./FileSaver.min.aec7cee9.js";import{u as W}from"./useInDepthScorecards.664f6c60.js";import"./magnifying-glass.b7cbe8fe.js";import"./chevron-left.0808b01b.js";import"./TransitionExpand.7bc80e70.js";import"./chevron-up.736f4142.js";const g={};g.props={id:{key:"id",required:!0,type:String},scorecards:{key:"scorecards",required:!0,type:Array}};g.setup=(a,s)=>{const t=a,i=V(),v=F(()=>t.scorecards.map(e=>{var c,f;const r=new Date,o=((c=e.yearQuarterValue.split("/")[0])==null?void 0:c.trim())||r.getUTCFullYear().toString(),l=((f=e.yearQuarterValue.split("/")[1])==null?void 0:f.trim())||`Q${Math.ceil((r.getMonth()+1)/3)}`;return{id:e.id,supplier:e.data["Supplier Name"]||"",status:e.status,year:o,quarter:l,updatedAt:e.data.updatedAt||r.toString()}})),M=F(()=>v.value.filter(e=>e.supplier!==void 0)),S=I(),n=E(),k=[n.display({id:"select",header:({table:e})=>u(U,{props:{table:e}}),cell:({row:e})=>u(j,{props:{row:e}})}),n.accessor(e=>e.supplier,{id:"supplier",header:()=>"Supplier",cell:e=>e.getValue()}),n.accessor("status",{header:()=>"Status",cell:e=>u(O,{props:{value:e.getValue()}}),enableColumnFilter:!1}),n.accessor("quarter",{header:()=>"Quarter",cell:e=>e.getValue()}),n.accessor("year",{header:()=>"Year",cell:e=>e.getValue(),filterFn:"weakEquals"}),n.accessor("updatedAt",{header:()=>"Last Updated",cell:e=>u(q,{props:{value:e.getValue(),format:"date"}}),enableColumnFilter:!1}),n.display({id:"actions",header:"Actions",cell:({row:e})=>u(N,{props:{actions:[{id:"edit",action(){i.push(`/admin/companies/${encodeURIComponent(t.id)}/scorecards/in-depth/rating-service-1/${e.original.id}`)}},{id:"download",async action(){const r=await _(`${h}/companies/${t.id}/scorecards/${e.original.id}/docx`,{responseType:"blob"}),o=`${e.original.supplier} Scorecard ${e.original.quarter} ${e.original.id}.docx`;K.exports.saveAs(r.data,o)}},{id:"archive",async action(){(await _.delete(`${h}/companies/${t.id}/scorecards/${e.original.id}`)).status===200&&S.success("Archived Scorecard Successfully")}}]}})})],y=d([]),$=d({pageIndex:0,pageSize:10}),b=d(""),w=d([]),R=d({}),C=Q({get data(){return M.value},columns:k,state:{get sorting(){return y.value},get pagination(){return $.value},get globalFilter(){return b.value},get columnFilters(){return w.value},get rowSelection(){return R.value}},onSortingChange:p(y),onPaginationChange:p($),onColumnFiltersChange:p(w),onGlobalFilterChange:p(b),globalFilterFn:(e,r,o,l)=>{const c=Y(e.getValue(r),o,{threshold:z.CONTAINS});return l(c),c.passed},onRowSelectionChange:p(R),getCoreRowModel:H(),getSortedRowModel:G(),getFacetedUniqueValues:L(),getPaginationRowModel:X(),getFilteredRowModel:J()});return{instance:C,bulkActions:[{id:"archive",async action(){const e=C.getSelectedRowModel().rows,r=e.length;let o=0;if(r>0){for(const l of e){const c=l.original.id;(await _.delete(`${h}/companies/${t.id}/scorecards/${c}`)).status===200&&o++}S.success(`Archived ${o}/${r} Scorecard(s) Successfully`),i.push(`/admin/companies/${t.id}/scorecards/in-depth/rating-service-1`)}}}]}};g.components=Object.assign({AppTanStackTable:D},g.components);var Z=function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("AppTanStackTable",{attrs:{table:a.instance,"table-actions":a.bulkActions}})},ee=[];const A={};var te=T(g,Z,ee,!1,ae,null,null,null);function ae(a){for(let s in A)this[s]=A[s]}const se=function(){return te.exports}(),m={};m.setup=(a,s)=>{const t=P("id"),i=W.list(t);return{id:t,scorecards:i}};m.components=Object.assign({PlusSvg:B,ScorecardsTable:se},m.components);var re=function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("div",{staticClass:"space-y-6"},[t("div",{staticClass:"flex items-center justify-between"},[t("div",{staticClass:"flex flex-col"},[t("BaseTypography",{staticClass:"uppercase text-gray-500",attrs:{variant:"overline"}},[a._v(" Rating Service 1 ")]),t("BaseTypography",{attrs:{variant:"h5",component:"h3"}},[a._v(" In-Depth Scorecards ")])],1),t("BaseButton",{staticClass:"space-x-1",attrs:{type:"button",to:`/admin/companies/${a.id}/scorecards/in-depth/rating-service-1/new`}},[t("PlusSvg",{staticClass:"w-5"}),t("span",[a._v("Scorecard")])],1)],1),t("BaseVueQuery",{attrs:{query:a.scorecards},scopedSlots:a._u([{key:"success",fn:function(i){var v=i.data;return[t("ScorecardsTable",{attrs:{id:a.id,scorecards:v}})]}}])})],1)},oe=[];const x={};var ne=T(m,re,oe,!1,ce,null,null,null);function ce(a){for(let s in x)this[s]=x[s]}const ye=function(){return ne.exports}();export{ye as default};
