import{aB as I,n as _,ax as w,d as c,bs as D,L as M,c7 as S,du as V,b as F,bG as $,dn as h,aK as Q}from"./index.e1f29fa0.js";import{A as K,S as N}from"./StatusInput.8669bf45.js";import{u as G}from"./useCompanyScorecardTemplates.ad123660.js";import{u as U}from"./useScorecardTemplates.b7cc3b9d.js";import{u as z}from"./useBlackKiteEntities.4c08cacf.js";import{u as W}from"./useUsers.2141c636.js";import{e as d}from"./attributeValue.ea53a720.js";import{s as Y}from"./index.61663a14.js";import{t as H}from"./index.48f96545.js";import"./ToolTip.98166f1d.js";import"./ObjectDisplay.2b7ae8c1.js";import"./DynamicForm.0c64ad14.js";const C={};C.props={value:{key:"value",required:!1,type:Array},options:{key:"options",required:!0,type:Array}};C.setup=(e,a)=>{const t=e,s=a.emit;return{proxy:I(t,s)}};var J=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("BaseLabel",{staticClass:"flex flex-col p-4 lg:grid lg:grid-cols-3 lg:items-center lg:gap-1"},[t("span",{staticClass:"space-x-1"},[e._v(" Companies "),t("span",{staticClass:"text-red-500"},[e._v("*")])]),t("BaseSelect",{staticClass:"lg:col-span-2",attrs:{multiple:""},model:{value:e.proxy,callback:function(s){e.proxy=s},expression:"proxy"}},[t("option",{domProps:{value:null}}),e._l(e.options,function(s){return t("option",{key:s.id,domProps:{value:s}},[t("div",{staticClass:"flex space-x-2"},[t("span",{staticClass:"text-semibold"},[e._v(" "+e._s(s.name)+" ")]),t("span",{staticClass:"text-sm text-gray-500"},[e._v("("+e._s(s.domain)+")")])])])})],2)],1)},X=[];const B={};var Z=_(C,J,X,!1,ee,null,null,null);function ee(e){for(let a in B)this[a]=B[a]}const te=function(){return Z.exports}(),b={};b.props={value:{key:"value",required:!1,type:String,default:void 0},options:{key:"options",required:!1,type:Array,default:void 0}};b.setup=(e,a)=>{const t=e,s=a.emit;return{proxy:I(t,s)}};var se=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("BaseLabel",{staticClass:"flex flex-col space-y-1 p-4 lg:grid lg:grid-cols-3 lg:items-center lg:space-y-0"},[e._v(" Template "),t("BaseSelect",{staticClass:"flex flex-col lg:col-span-2",model:{value:e.proxy,callback:function(s){e.proxy=s},expression:"proxy"}},[t("option",{domProps:{value:null}}),e._l(e.options,function(s,l){return t("option",{key:l,domProps:{value:s.split("/")[1]}},[e._v(" "+e._s(s.split("/")[1])+" ")])})],2)],1)},ae=[];const k={};var ne=_(b,se,ae,!1,oe,null,null,null);function oe(e){for(let a in k)this[a]=k[a]}const le=function(){return ne.exports}(),v={};v.props={value:{key:"value",required:!1,type:null},users:{key:"users",required:!0,type:Array},entities:{key:"entities",required:!0,type:Array},templates:{key:"templates",required:!0,type:Array},companies:{key:"companies",required:!0,type:Array}};v.setup=(e,a)=>{const t=e,s=a.emit,l=w(t,s),u=c(()=>t.entities.map(r=>({id:parseInt(r.CompanyId),name:r.CompanyName,domain:r.DomainName}))),p=c(()=>t.templates.map(({key:r})=>r));return{proxy:l,entityOptions:u,templateOptions:p}};v.components=Object.assign({TemplateSelect:le,AnalystInput:K,StatusInput:N,BatchEntitiesSelectV3:te},v.components);var re=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("section",{staticClass:"flex flex-col divide-y"},[t("div",{staticClass:"flex flex-col divide-y"},[t("h3",{staticClass:"p-4 font-display text-lg font-semibold"},[e._v("Template")]),t("TemplateSelect",{attrs:{options:e.templateOptions},model:{value:e.proxy.template,callback:function(s){e.$set(e.proxy,"template",s)},expression:"proxy.template"}})],1),t("div",{staticClass:"flex flex-col divide-y"},[t("h3",{staticClass:"p-4 font-display text-lg font-semibold"},[e._v(" Analyst Information ")]),t("AnalystInput",{attrs:{users:e.users},model:{value:e.proxy.analyst,callback:function(s){e.$set(e.proxy,"analyst",s)},expression:"proxy.analyst"}})],1),t("div",{staticClass:"flex flex-col divide-y"},[t("h3",{staticClass:"p-4 font-display text-lg font-semibold"},[e._v("Status")]),t("StatusInput",{model:{value:e.proxy.status,callback:function(s){e.$set(e.proxy,"status",s)},expression:"proxy.status"}})],1),t("div",{staticClass:"flex flex-col divide-y"},[t("h3",{staticClass:"p-4 font-display text-lg font-semibold"},[e._v("Select Companies")]),t("BatchEntitiesSelectV3",{attrs:{options:e.entityOptions},model:{value:e.proxy.entities,callback:function(s){e.$set(e.proxy,"entities",s)},expression:"proxy.entities"}})],1)])},ie=[];const q={};var ce=_(v,re,ie,!1,ue,null,null,null);function ue(e){for(let a in q)this[a]=q[a]}const pe=function(){return ce.exports}(),f={};f.setup=(e,a)=>{const t=S("id"),s=S("subscriptionId"),l=V.create(t,s),u=F(!1),p=[$.list(),z.list(t),U.list()],r=G.get(t),g=W.list(),E=c(()=>{var i;return(i=g.data.value)==null?void 0:i.map(o=>({id:{value:d(o,"sub")},name:d(o,"name")||"",title:d(o,"custom:title")||"",email:d(o,"email"),phone:d(o,"phone_number")||""})).find(o=>o.email==="consultingservices@whitehawk.com")}),x=$.read(t),T=c(()=>{if(x.data.value)return{id:{value:x.data.value.id},name:x.data.value.name}}),n=Y(c(()=>{var m;const i=new Date,o=i.getUTCFullYear(),y=`Q${Math.ceil((i.getMonth()+1)/4)}`;return{id:t,company:T.value,analyst:E.value,template:((m=r.data.value)==null?void 0:m.split("/")[1])||"",status:{state:h.State.IN_PROGRESS,year:o,quarter:H(y)},includeCmmc:!0,entities:[]}})),O=c(()=>n.value?!(n.value.entities.length>0&&n.value.analyst&&n.value.company&&n.value.status&&n.value.template):!0),P=Q();async function R(){var i,o,y,m;if(n.value){const L={company:n.value.company,analyst:(i=n.value)==null?void 0:i.analyst,status:{year:2023,quarter:h.Quarter.Q1,state:h.State.COMPLETE},includeCmmc:(o=n.value)==null?void 0:o.includeCmmc,template:n.value.template,entities:(y=n.value)==null?void 0:y.entities},{response:j}=await l.mutateAsync(L);(m=j.batchId)!=null&&m.value&&P.push(`/admin/companies/${t.value}/subscriptions/${s.value}/integrations/2/scorecards/batch`)}}return{isLoading:u,queries:p,users:g,batch:n,isDisabled:O,createBatch:R}};f.components=Object.assign({BackButton:D,BatchScorecardInputV3:pe,LoadingSpinner:M},f.components);var me=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"space-y-6"},[t("div",{staticClass:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4"},[t("BackButton"),t("div",{staticClass:"flex flex-col -space-y-1"},[t("BaseTypography",{staticClass:"uppercase text-gray-500",attrs:{variant:"overline"}},[e._v(" Black Kite ")]),t("BaseTypography",{attrs:{variant:"h5",component:"h2"}},[e._v(" Batch Scorecard ")])],1)],1),t("BaseSimpleCard",[t("form",{staticClass:"divide-y",on:{submit:function(s){return s.preventDefault(),e.createBatch.apply(null,arguments)}}},[t("BaseVueQueries",{attrs:{queries:e.queries},scopedSlots:e._u([{key:"success",fn:function(s){var l=s[0],u=s[1],p=s[2];return[t("BatchScorecardInputV3",{attrs:{users:e.users.data.value||[],companies:l,entities:u,templates:p},model:{value:e.batch,callback:function(r){e.batch=r},expression:"batch"}})]}}])}),t("div",{staticClass:"p-4"},[t("BaseButton",{attrs:{disabled:e.isDisabled}},[e.isLoading?t("LoadingSpinner"):t("span",[e._v("Create Batch")])],1)],1)],1)])],1)},de=[];const A={};var ve=_(f,me,de,!1,ye,null,null,null);function ye(e){for(let a in A)this[a]=A[a]}const Ae=function(){return ve.exports}();export{Ae as default};
