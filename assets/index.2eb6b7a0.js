import{aB as R,n as b,ax as j,d as c,bs as D,L as M,c7 as S,du as V,b as $,bG as B,dn as h,aK as Q}from"./index.78dd2457.js";import{A as F,S as N}from"./StatusInput.afcf5275.js";import{T as G}from"./TemplateSelect.316b51e0.js";import{u as K}from"./useCompanyScorecardTemplates.b1227ed1.js";import{u as U}from"./useScorecardTemplates.efc8918b.js";import{u as z}from"./useBlackKiteEntities.9038e849.js";import{u as Y}from"./useUsers.60e5f24f.js";import{e as d}from"./attributeValue.ea53a720.js";import{t as H}from"./index.9e6d4f68.js";import"./ToolTip.6e676252.js";import"./ObjectDisplay.95c31bdb.js";import"./DynamicForm.d83899aa.js";const C={};C.props={value:{key:"value",required:!1,type:Array},options:{key:"options",required:!0,type:Array}};C.setup=(t,a)=>{const e=t,s=a.emit;return{proxy:R(e,s)}};var J=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("BaseLabel",{staticClass:"flex flex-col p-4 lg:grid lg:grid-cols-3 lg:items-center lg:gap-1"},[e("span",{staticClass:"space-x-1"},[t._v(" Companies "),e("span",{staticClass:"text-red-500"},[t._v("*")])]),e("SimpleSelect",{staticClass:"lg:col-span-2",attrs:{multiple:""},model:{value:t.proxy,callback:function(s){t.proxy=s},expression:"proxy"}},[e("option",{domProps:{value:null}}),t._l(t.options,function(s){return e("option",{key:s.id,domProps:{value:s}},[e("div",{staticClass:"flex space-x-2"},[e("span",{staticClass:"text-semibold"},[t._v(" "+t._s(s.name)+" ")]),e("span",{staticClass:"text-sm text-gray-500"},[t._v("("+t._s(s.domain)+")")])])])})],2)],1)},W=[];const k={};var X=b(C,J,W,!1,Z,null,null,null);function Z(t){for(let a in k)this[a]=k[a]}const tt=function(){return X.exports}(),v={};v.props={value:{key:"value",required:!1,type:null},users:{key:"users",required:!0,type:Array},entities:{key:"entities",required:!0,type:Array},templates:{key:"templates",required:!0,type:Array},companies:{key:"companies",required:!0,type:Array}};v.setup=(t,a)=>{const e=t,s=a.emit,r=j(e,s),u=c(()=>e.entities.map(i=>({id:parseInt(i.CompanyId),name:i.CompanyName,domain:i.DomainName}))),p=c(()=>e.templates.map(({key:i})=>i));return{proxy:r,entityOptions:u,templateOptions:p}};v.components=Object.assign({TemplateSelect:G,AnalystInput:F,StatusInput:N,BatchEntitiesSelectV3:tt},v.components);var et=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("section",{staticClass:"flex flex-col divide-y"},[e("div",{staticClass:"flex flex-col divide-y"},[e("h3",{staticClass:"p-4 font-display text-lg font-semibold"},[t._v("Template")]),e("TemplateSelect",{attrs:{options:t.templateOptions},model:{value:t.proxy.template,callback:function(s){t.$set(t.proxy,"template",s)},expression:"proxy.template"}})],1),e("div",{staticClass:"flex flex-col divide-y"},[e("h3",{staticClass:"p-4 font-display text-lg font-semibold"},[t._v(" Analyst Information ")]),e("AnalystInput",{attrs:{users:t.users},model:{value:t.proxy.analyst,callback:function(s){t.$set(t.proxy,"analyst",s)},expression:"proxy.analyst"}})],1),e("div",{staticClass:"flex flex-col divide-y"},[e("h3",{staticClass:"p-4 font-display text-lg font-semibold"},[t._v("Status")]),e("StatusInput",{model:{value:t.proxy.status,callback:function(s){t.$set(t.proxy,"status",s)},expression:"proxy.status"}})],1),e("div",{staticClass:"flex flex-col divide-y"},[e("h3",{staticClass:"p-4 font-display text-lg font-semibold"},[t._v("Select Companies")]),e("BatchEntitiesSelectV3",{attrs:{options:t.entityOptions},model:{value:t.proxy.entities,callback:function(s){t.$set(t.proxy,"entities",s)},expression:"proxy.entities"}})],1)])},st=[];const q={};var at=b(v,et,st,!1,nt,null,null,null);function nt(t){for(let a in q)this[a]=q[a]}const ot=function(){return at.exports}(),f={};f.setup=(t,a)=>{const e=S("id"),s=S("subscriptionId"),r=V.create(e,s),u=$(!1),p=[B.list(),z.list(e),U.list()],i=K.get(e),g=Y.list(),I=c(()=>{var l;return(l=g.data.value)==null?void 0:l.map(o=>({id:{value:d(o,"sub")},name:d(o,"name")||"",title:d(o,"custom:title")||"",email:d(o,"email"),phone:d(o,"phone_number")||""})).find(o=>o.email==="consultingservices@whitehawk.com")}),_=B.read(e),E=c(()=>{if(_.data.value)return{id:{value:_.data.value.id},name:_.data.value.name}}),x=$(),n=c({get(){var m;if(x.value)return x.value;const l=new Date,o=l.getUTCFullYear(),y=`Q${Math.ceil((l.getMonth()+1)/4)}`;return{id:e,company:E.value,analyst:I.value,template:((m=i.data.value)==null?void 0:m.split("/")[1])||"",status:{state:h.State.IN_PROGRESS,year:o,quarter:H(y)},includeCmmc:!0,entities:[]}},set(l){x.value=l}}),w=c(()=>n.value?!(n.value.entities.length>0&&n.value.analyst&&n.value.company&&n.value.status&&n.value.template):!0),O=Q();async function T(){var l,o,y,m;if(n.value){const L={company:n.value.company,analyst:(l=n.value)==null?void 0:l.analyst,status:{year:2023,quarter:h.Quarter.Q1,state:h.State.COMPLETE},includeCmmc:(o=n.value)==null?void 0:o.includeCmmc,template:n.value.template,entities:(y=n.value)==null?void 0:y.entities},{response:P}=await r.mutateAsync(L);(m=P.batchId)!=null&&m.value&&O.push(`/admin/companies/${e.value}/subscriptions/${s.value}/integrations/2/batch`)}}return{isLoading:u,queries:p,users:g,batch:n,isDisabled:w,generate:T}};f.components=Object.assign({BackButton:D,BatchScorecardInputV3:ot,LoadingSpinner:M},f.components);var it=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"space-y-6"},[e("div",{staticClass:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4"},[e("BackButton"),e("BaseTypography",{attrs:{variant:"h5",component:"h2"}},[t._v(" Create New Batch ")])],1),e("BaseSimpleCard",[e("BaseVueQueries",{attrs:{queries:t.queries},scopedSlots:t._u([{key:"success",fn:function(s){var r=s[0],u=s[1],p=s[2];return[e("form",{staticClass:"divide-y",on:{submit:function(i){return i.preventDefault(),t.generate.apply(null,arguments)}}},[e("BatchScorecardInputV3",{attrs:{users:t.users.data.value||[],companies:r,entities:u,templates:p},model:{value:t.batch,callback:function(i){t.batch=i},expression:"batch"}}),e("div",{staticClass:"p-4"},[e("BaseButton",{staticClass:"w-full md:w-auto",attrs:{disabled:t.isDisabled}},[t.isLoading?e("LoadingSpinner"):e("span",[t._v("Generate Batch")])],1)],1)],1)]}}])})],1)],1)},lt=[];const A={};var rt=b(f,it,lt,!1,ct,null,null,null);function ct(t){for(let a in A)this[a]=A[a]}const gt=function(){return rt.exports}();export{gt as default};
