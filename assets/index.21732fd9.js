import{F as q}from"./FormButton.bd495484.js";import{B}from"./BackButton.c144020d.js";import{D as C}from"./DynamicForm.53c2ea98.js";import{V as $,c as d,i as y,n as h,bG as k,a0 as R,r as D,w as F,I}from"./index.b06362ff.js";import{l as M}from"./lodash.736e2d7d.js";import{e as _}from"./attributeValue.ea53a720.js";import{u as f}from"./useCompanyAccess.8b742bfe.js";import{u as S}from"./useUsers.3fe39aaa.js";import"./arrow-down-on-square.6f2806b6.js";import"./trash.687d612e.js";import"./chevron-left.0808b01b.js";const m={};m.props={value:{key:"value",required:!1,type:null},users:{key:"users",required:!0,type:Array},companyAccess:{key:"companyAccess",required:!0,type:Array}};m.setup=(s,a)=>{const e=s,r=a.emit,c=$(e,r),t=[{text:"Read",value:"READ"},{text:"Write",value:"WRITE"},{text:"Admin",value:"ADMIN"}],u=d(()=>e.companyAccess.map(({user:i})=>i)),p=d(()=>e.users.map(i=>({id:_(i,"sub"),email:_(i,"email")}))),v=d(()=>M.exports.differenceBy(p.value,u.value,o=>o.id).map(o=>({text:o.email,value:o})).sort((o,A)=>o.text.localeCompare(A.text))),n=[{name:"user",label:"User",component:{is:y,attrs:{required:!0,options:[{text:"",value:void 0},...v.value]}}},{name:"permission",label:"Permission",component:{is:y,attrs:{required:!0,options:[{text:"",value:void 0},...t]}}}];return{proxy:c,schema:n}};m.components=Object.assign({DynamicForm:C},m.components);var U=function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("DynamicForm",{attrs:{schema:s.schema},model:{value:s.proxy,callback:function(r){s.proxy=r},expression:"proxy"}})},E=[];const x={};var g=h(m,U,E,!1,j,null,null,null);function j(s){for(let a in x)this[a]=x[a]}const w=function(){return g.exports}(),l={};l.setup=(s,a)=>{const e=k("id"),r=[S.list(),f.list(e)],c=R.read(e),t=D();F(()=>c.data.value,n=>{n&&(t.value={...t.value,company:{id:e.value,name:n.name}})},{immediate:!0});const u=I(),p=f.create();async function v(){if(t.value&&t.value.company&&t.value.user&&t.value.permission){const n={company:t.value.company,user:t.value.user,permission:t.value.permission};await p.mutateAsync({id:e.value,body:n}),u.push(`/admin/companies/${encodeURIComponent(e.value)}/members`)}else throw new Error("Invalid request.")}return{queries:r,access:t,addMember:v}};l.components=Object.assign({BackButton:B,UserAccessInput:w,FormButton:q},l.components);var O=function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("div",{staticClass:"space-y-6"},[e("BackButton"),e("BaseSimpleCard",{staticClass:"divide-y"},[e("BaseTypography",{staticClass:"p-4",attrs:{component:"h2",variant:"subtitle3"}},[s._v(" Add Member ")]),e("form",{staticClass:"divide-y",on:{submit:function(r){return r.preventDefault(),s.addMember.apply(null,arguments)}}},[e("BaseVueQueries",{attrs:{queries:s.queries},scopedSlots:s._u([{key:"success",fn:function(r){var c=r[0],t=r[1];return[e("UserAccessInput",{attrs:{users:c,"company-access":t},model:{value:s.access,callback:function(u){s.access=u},expression:"access"}})]}}])}),e("FormButton",{attrs:{action:"create"}})],1)],1)],1)},P=[];const b={};var Q=h(l,O,P,!1,T,null,null,null);function T(s){for(let a in b)this[a]=b[a]}const Z=function(){return Q.exports}();export{Z as default};
