import{R as Q}from"./arrow-path.24b87f73.js";import{L as j,aq as A,bZ as I,bD as q,d as o,r as G,aJ as M,aG as $,n as O}from"./index.ab0eec81.js";import{B as T}from"./BackButton.d71f830b.js";import{G as U}from"./GaugeChart.5eeec70f.js";import{B as z,u as N}from"./BarChart.a36e158e.js";import{S as E}from"./ScorecardSnapshotInput.de02b260.js";import{s as F,g as J}from"./sortBy.64936d50.js";import{u as Z,a as H}from"./useCompanyOverview.f019981b.js";import{u as K}from"./useNewestQuestionnaireResponses.ea420b3d.js";import{u as V}from"./useSnapshotScorecards.3050bba4.js";import"./chevron-left.0808b01b.js";import"./chart.f4078cab.js";import"./BundleSolutionDisplay.b1609ef8.js";import"./BasicModal.345c639a.js";import"./useCompanyWishlistItems.41a6abab.js";import"./cloneDeep.66c4d20a.js";import"./_Uint8Array.b0e46547.js";import"./keys.5c0d48a6.js";import"./_baseAssignValue.5bfb123f.js";import"./_copyArray.56331c81.js";import"./MaturityTodo.350eeb9d.js";import"./_baseEach.473615c8.js";import"./_baseIteratee.87b69166.js";import"./_baseIsEqual.3cb09ba1.js";import"./_arrayMap.dcea68f3.js";import"./_baseRest.4fbde493.js";import"./_baseOrderBy.cffdaea2.js";const u={};u.setup=(e,r)=>{const t=I("id"),n=q.read(t),w=o(()=>{if(n.data.value){const{id:a,name:s}=n.data.value;return{id:a,name:s}}}),m=N.list(t),i=o(()=>{const a=m.data.value;if(a){const s=F(a,"order");return J(s,"category")}}),l=o(()=>{if(i.value)return["basic","foundational","organizational"].reduce((a,s)=>{var c;return a[s]=((c=i.value)==null?void 0:c[s])||[],a},{})}),v=o(()=>{if(i.value)return["critical","next","pending"].reduce((a,s)=>{var c;return a[s]=((c=i.value)==null?void 0:c[s])||[],a},{})});async function B(){await m.refetch.value()}const f=K.get(t),y=o(()=>f.data.value);async function R(){await f.refetch.value()}const x=Z.get(t),C=o(()=>x.data.value),h=o(()=>{var a,s;return(s=(a=x.data.value)==null?void 0:a.scores)==null?void 0:s.cyberPath}),P=H.get(t),g=o(()=>P.data.value),p=G(),d=o({get(){var a;return p.value?p.value:{type:"snapshot",company:w.value,questionnaireResponse:y.value,riskIndicator:{cyberScore:h.value,text:(a=C.value)==null?void 0:a.text},actionPlan:{data:v.value},maturityLevelAssessment:{data:l.value},bundles:g.value,cis:l.value?Object.values(l.value).flatMap(s=>s).map(s=>s.itemComplete):[]}},set(a){p.value=a}}),k=o(()=>Boolean(i.value&&g.value&&C.value&&y.value&&d.value)),D=M(),_=$(),b=V.create(t);async function L(){const a=await b.mutateAsync(d.value);a&&(_.success("Created Successfully"),D.push(`/admin/companies/${t.value}/scorecards/snapshot/${encodeURIComponent(a.id)}`)),_.error("Something went wrong.")}return{id:t,todos:i,maturityLevelAssessmentData:l,actionPlanData:v,latestTodos:B,latestQuestionnaireResponse:R,cyberScore:h,scorecard:d,ready:k,snapshotCreate:b,create:L}};u.components=Object.assign({BackButton:T,LoadingSpinner:j,GaugeChart:U,RefreshSvg:Q,BarChart:z,ScorecardSnapshotInput:E,PlusSvg:A},u.components);var W=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("section",{staticClass:"flex flex-col space-y-6"},[t("div",[t("BackButton",{attrs:{link:`/admin/companies/${e.id}/scorecards/snapshot`}})],1),e.ready?t("div",[t("div",{staticClass:"grid grid-cols-1 gap-4 2xl:grid-cols-3"},[e.cyberScore?[t("BaseSimpleCard",{staticClass:"justify-center divide-y 2xl:col-span-1 2xl:flex-1"},[t("fieldset",{staticClass:"divide-y"},[t("legend",[t("h3",{staticClass:"p-4 font-display text-lg font-semibold"},[e._v(" Cyber Risk Indicator ")])]),t("div",{staticClass:"flex items-center justify-center p-4 2xl:h-66"},[t("div",[t("GaugeChart",{staticClass:"h-24 w-48 2xl:h-32 2xl:w-64",attrs:{"cyber-score":e.cyberScore}})],1)])]),t("div",{staticClass:"p-4"},[t("BaseButton",{staticClass:"space-x-2",attrs:{type:"button"},on:{click:e.latestQuestionnaireResponse}},[t("RefreshSvg",{staticClass:"h-auto w-4 xl:w-5"}),t("span",[e._v("Update")])],1)],1)])]:e._e(),e.todos?[t("BaseSimpleCard",{staticClass:"justify-center divide-y 2xl:col-span-2 2xl:flex-1"},[t("fieldset",{staticClass:"divide-y"},[t("legend",[t("h3",{staticClass:"p-4 font-display text-lg font-semibold"},[e._v(" Cyber Maturity Roadmap ")])]),t("div",{staticClass:"flex flex-col items-center space-y-8 p-4 xl:flex-row xl:justify-around xl:space-x-8 xl:space-y-0"},[e.maturityLevelAssessmentData?t("BarChart",{attrs:{width:96*3.34,height:96*2.5,value:e.maturityLevelAssessmentData,options:{maintainAspectRatio:!1,devicePixelRatio:1}}}):e._e(),e.actionPlanData?t("BarChart",{attrs:{width:96*3.34,height:96*2.5,value:e.actionPlanData,options:{maintainAspectRatio:!1,devicePixelRatio:1}}}):e._e()],1)]),t("div",{staticClass:"p-4"},[t("BaseButton",{staticClass:"space-x-2",attrs:{type:"button"},on:{click:e.latestTodos}},[t("RefreshSvg",{staticClass:"h-auto w-4 xl:w-5"}),t("span",[e._v("Update")])],1)],1)])]:e._e()],2),t("form",{staticClass:"flex flex-col space-y-6",on:{submit:function(n){return n.preventDefault(),e.create.apply(null,arguments)}}},[t("ScorecardSnapshotInput",{attrs:{id:e.id},model:{value:e.scorecard,callback:function(n){e.scorecard=n},expression:"scorecard"}}),t("div",{staticClass:"lg:inline-flex"},[t("BaseButton",{staticClass:"w-full space-x-2 lg:w-auto",attrs:{disabled:e.snapshotCreate.isLoading.value}},[t("PlusSvg",{staticClass:"h-auto w-4 xl:w-5"}),t("span",[e._v("Create")])],1)],1)],1)]):t("div",[t("LoadingSpinner")],1)])},X=[];const S={};var Y=O(u,W,X,!1,tt,null,null,null);function tt(e){for(let r in S)this[r]=S[r]}const kt=function(){return Y.exports}();export{kt as default};
