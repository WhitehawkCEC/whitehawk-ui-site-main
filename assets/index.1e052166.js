import{F as k}from"./folder-arrow-down.817acc4a.js";import{d as o,n as b,aS as g,bs as C,ca as v,b as x,aK as F,aP as N,aQ as T}from"./index.7f652c39.js";import{A as q,T as A}from"./AppTanStackTable.9b3e06f8.js";import{c as w}from"./createOnChangeFn.2eef2b17.js";import{u as R}from"./createSimpleTable.92fe351b.js";import{u as E}from"./useBatchScorecards.14d3adc1.js";import{d as j}from"./FormValidation.a5e2f641.js";import{s as S}from"./index.11e32876.js";import"./magnifying-glass.b7cbe8fe.js";import"./chevron-up.736f4142.js";const h={};h.props={value:{key:"value",required:!0,type:null}};h.setup=(e,s)=>{const t=e;return{level:o(()=>{switch(t.value){case"Success":return{label:"Success",color:"bg-green-100 text-green-900"};case"Failed":return{label:"Failed",color:"bg-red-100 text-red-900"};default:return{label:"Status N/A",color:"bg-gray-100 text-gray-900"}}})}};var D=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("BaseOverline",{staticClass:"inline-flex items-center rounded px-2 py-0.5 uppercase",class:e.level.color},[e._v(" "+e._s(e.level.label)+" ")])},P=[];const I={};var L=b(h,D,P,!1,M,null,null,null);function M(e){for(let s in I)this[s]=I[s]}const O=function(){return L.exports}(),l={};l.props={id:{key:"id",required:!0,type:String},subId:{key:"subId",required:!0,type:String},batches:{key:"batches",required:!0,type:Array},bitsightCompanies:{key:"bitsightCompanies",required:!0,type:Array}};l.setup=(e,s)=>{const t=e,r=o(()=>t.id),u=o(()=>t.subId),p=o(()=>t.bitsightCompanies.map(a=>{var m;return{id:a.id,supplier:a.name,state:t.batches.some(i=>i.supplierId===a.id)?"Success":"Failed",scorecardId:(m=t.batches.find(i=>i.supplierId===a.id))==null?void 0:m.scorecardId}})),n=w(),d=[n.accessor("id",{header:()=>"Supplier ID",enableColumnFilter:!1}),n.accessor("supplier",{header:()=>"Supplier Name",enableColumnFilter:!1}),n.accessor("state",{header:()=>"Scorecard State",cell:a=>g(O,{props:{value:a.getValue()}}),enableColumnFilter:!1}),n.display({id:"actions",header:"Actions",cell:({row:a})=>g(A,{props:{actions:[{id:"edit",to:`/admin/companies/${r.value}/subscriptions/${u.value}/integrations/1/scorecards/in-depth/${a.original.scorecardId}`}]}})})];return{instance:R(p,d)}};l.components=Object.assign({AppTanStackTable:q},l.components);var V=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("AppTanStackTable",{attrs:{table:e.instance}})},Z=[];const $={};var z=b(l,V,Z,!1,H,null,null,null);function H(e){for(let s in $)this[s]=$[s]}const Q=function(){return z.exports}(),f={};f.setup=(e,s)=>{const t=v("id"),r=v("subscriptionId"),u=v("batchId"),p=x(""),n=x(!1),d=E.read(t,u),_=S(o(()=>{var c;return((c=d.data.value)==null?void 0:c.scorecardIds)||[]})),a=S(o(()=>{var c;return((c=d.data.value)==null?void 0:c.batchRequest.supplierInfos)||[]})),m=F();async function i(){const c=_.value.map(y=>({scorecardId:y.scorecardId,supplierName:y.supplierName}));n.value=!0;try{await N.post(`${T}/companies/${t.value}/batch/scorecards`,{fileName:`${p.value}`,batchId:u.value,supplierScorecardInfos:c})}finally{n.value=!1}m.push(`/admin/companies/${t.value}/subscriptions/${r.value}/integrations/1/scorecards/zip-files`)}return{checkZipFileExtension:j,id:t,subscriptionId:r,fileName:p,batches:_,companies:a,convert:i}};f.components=Object.assign({BackButton:C,FolderDownloadSvg:k,BatchScorecardStatusTable:Q},f.components);var W=function(){var e=this,s=e.$createElement,t=e._self._c||s;return e.batches&&e.companies?t("BaseTablePageLayout",{scopedSlots:e._u([{key:"backButton",fn:function(){return[t("BackButton")]},proxy:!0},{key:"overline",fn:function(){return[e._v("Bitsight")]},proxy:!0},{key:"title",fn:function(){return[e._v("Batch Scorecard")]},proxy:!0},{key:"button",fn:function(){return[t("BaseButton",{staticClass:"space-x-2",attrs:{disabled:!e.fileName},on:{click:e.convert}},[t("FolderDownloadSvg",{staticClass:"-ml-1 w-5"}),t("span",[e._v("ZIP Batch")])],1)]},proxy:!0},{key:"table",fn:function(){return[t("div",{staticClass:"space-y-6"},[t("BatchScorecardStatusTable",{attrs:{id:e.id,"sub-id":e.subscriptionId,batches:e.batches,"bitsight-companies":e.companies}}),t("BaseSimpleCard",[t("BaseLabel",{staticClass:"flex flex-col p-4 lg:grid lg:grid-cols-3 lg:items-center"},[t("span",{staticClass:"after:content-['*']` after:text-red-700"},[e._v(" File Name: ")]),t("div",{staticClass:"flex flex-col lg:col-span-2"},[t("BaseInputWithValidation",{attrs:{type:"text",required:"","aria-required":"true",validator:e.checkZipFileExtension},model:{value:e.fileName,callback:function(r){e.fileName=r},expression:"fileName"}})],1)])],1)],1)]},proxy:!0}],null,!1,895858146)}):e._e()},K=[];const B={};var U=b(f,W,K,!1,G,null,null,null);function G(e){for(let s in B)this[s]=B[s]}const oe=function(){return U.exports}();export{oe as default};
