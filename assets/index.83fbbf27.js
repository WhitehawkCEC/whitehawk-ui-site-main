import{R as N}from"./arrow-path.24b87f73.js";import{c as a,aS as x,n as T,L as V,aZ as P,cF as w,cG as F,aF as U,cO as G,cI as Y,cJ as H,b$ as J,cP as K,cQ as z,cM as Q}from"./index.b2401774.js";import{A as Z}from"./AppTanStackTable.7b85c51c.js";import{S as R,V as X,t as L,p as O,c as ee,a as se,b as ne}from"./SyncStatusDisplay.dc43467a.js";import{c as te}from"./createOnChangeFn.f40c0251.js";import{u as ae}from"./createSimpleTable.a21d380d.js";import{l as ce}from"./lodash.fe35ce9b.js";import"./magnifying-glass.b7cbe8fe.js";import"./TransitionExpand.c0bdd5de.js";import"./check-circle.48e4a9f5.js";import"./chevron-up.736f4142.js";const g={};g.props={value:{key:"value",required:!0,type:Array}};g.setup=(e,t)=>{const s=e,i=a(()=>s.value),r=te(),u=[r.accessor("toBeSynced",{header:()=>"To Be Synced",cell:c=>x(R,{props:{value:c.getValue()}}),enableColumnFilter:!1}),r.group({id:"supplier",header:()=>"Supplier",columns:[r.accessor(c=>c.supplier.name,{id:"name",header:()=>"Name",enableColumnFilter:!1}),r.accessor(c=>c.supplier.domain,{id:"domain",header:()=>"Domain",enableColumnFilter:!1})]}),r.accessor("syncedFromSupplyWisdom",{header:()=>"Synced From Supply Wisdom?",cell:c=>x(R,{props:{value:c.getValue()}}),enableColumnFilter:!1}),r.accessor("syncedFromCyberOne",{header:()=>"Synced From CyberOne?",cell:c=>x(R,{props:{value:c.getValue()}}),enableColumnFilter:!1})];return{instance:ae(i,u)}};g.components=Object.assign({AppTanStackTable:Z},g.components);var oe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("AppTanStackTable",{attrs:{table:e.instance}})},re=[];const j={};var ie=T(g,oe,re,!1,le,null,null,null);function le(e){for(let t in j)this[t]=j[t]}const ue=function(){return ie.exports}(),b={};b.props={accountId:{key:"accountId",required:!0,type:String},assets:{key:"assets",required:!0,type:Array},supplyWisdomAssets:{key:"supplyWisdomAssets",required:!0,type:Array}};b.setup=(e,t)=>{const s=e,i=a(()=>s.accountId),r=P(),u=w.read(i,r),y=a(()=>u.data.value||F.SyncJob.create()),c=a(()=>{const n=s.supplyWisdomAssets.filter(o=>o.webSiteUrl).filter(o=>o.target);return L(n,ee)}),m=a(()=>c.value.map(n=>O(n.webSiteUrl))),p=a(()=>c.value.map(n=>({id:n.id,name:n.name,domain:O(n.webSiteUrl)}))),W=a(()=>{const n=s.assets.filter(o=>o.domain);return L(n,se)}),d=a(()=>W.value.map(n=>O(n.domain))),_=a(()=>W.value.map(n=>({id:n.referenceId,name:n.name,domain:O(n.domain)}))),A=a(()=>ce.exports.uniqBy([..._.value,...p.value],"domain")),S=a(()=>A.value.map(n=>{var f,D;const{name:o,domain:l}=n;return{supplier:{cyberOneId:(f=_.value.find($=>$.domain===l))==null?void 0:f.id,supplyWisdomId:(D=p.value.find($=>$.domain===l))==null?void 0:D.id,name:o,domain:l},syncedFromCyberOne:d.value.includes(n.domain),syncedFromSupplyWisdom:m.value.includes(n.domain),toBeSynced:d.value.includes(n.domain)&&m.value.includes(n.domain)}}).sort((n,o)=>Number(o.toBeSynced)-Number(n.toBeSynced))),v=a(()=>{const n=[];return S.value.forEach(o=>{if(o.toBeSynced){const{supplyWisdomId:l,cyberOneId:f}=o.supplier;l&&f&&n.push({target:{oneofKind:"cyberOneAssetId",cyberOneAssetId:f},source:{oneofKind:"supplyWisdomAssetId",supplyWisdomAssetId:l}})}}),n}),I=U(),B=w.create(i);async function M(){var l;const n={syncType:F.SyncType.SUPPLY_WISDOM_TO_CYBER_ONE,entries:v.value},o=await B.mutateAsync(n);o&&(r.value=(l=o.response.syncId)==null?void 0:l.value,I.success(`Sync ID: ${r.value}`))}return{sync:y,rows:S,mappings:v,syncCreate:B,createSync:M}};b.components=Object.assign({VrmSyncStatusDisplay:X,LoadingSpinner:V,SyncSvg:N,BusinessRatingSyncTable:ue},b.components);var pe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",{staticClass:"space-y-6"},[s("div",{staticClass:"flex flex-col space-y-4 md:flex-row md:items-center md:justify-between md:space-y-0"},[s("VrmSyncStatusDisplay",{attrs:{header:"Business Rating Sync","sync-job":e.sync}}),s("BaseButton",{staticClass:"space-x-1",attrs:{disabled:e.mappings.length===0,shape:"rectangle"},on:{click:e.createSync}},[e.syncCreate.isLoading.value?s("LoadingSpinner"):s("SyncSvg",{staticClass:"w-4 xl:w-5"}),s("span",[e._v("Sync")])],1)],1),s("BusinessRatingSyncTable",{attrs:{value:e.rows}})],1)},de=[];const k={};var ye=T(b,pe,de,!1,me,null,null,null);function me(e){for(let t in k)this[t]=k[t]}const _e=function(){return ye.exports}(),C={};C.props={accountId:{key:"accountId",required:!0,type:String},syncType:{key:"syncType",required:!0,type:null},mappedTarget:{key:"mappedTarget",required:!1,type:String}};C.setup=(e,t)=>{const s=e,i=a(()=>s.accountId),r=G.get(i),u=a(()=>r.data.value),y=Y.get(i),c=a(()=>{var d;return(d=y.data.value)==null?void 0:d.mappedAssetId}),m=H.get(i),p=a(()=>m.data.value);return{syncStatus:a(()=>{var d,_,A,S,v,I;return{source:{mappedSource:s.mappedTarget,syncDate:(_=(d=u.value)==null?void 0:d.lastSynced)==null?void 0:_.value,syncedReports:(A=u.value)==null?void 0:A.reportsSynced},target:{mappedTarget:c.value,syncDate:(v=(S=p.value)==null?void 0:S.lastSynced)==null?void 0:v.value,syncedReports:(I=p.value)==null?void 0:I.reportsSynced}}})}};C.components=Object.assign({SyncStatusDisplay:ne},C.components);var Se=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("SyncStatusDisplay",{attrs:{"sync-status":e.syncStatus,"sync-type":e.syncType}})},ve=[];const E={};var fe=T(C,Se,ve,!1,ge,null,null,null);function ge(e){for(let t in E)this[t]=E[t]}const be=function(){return fe.exports}(),h={};h.setup=(e,t)=>{const s=J("id"),i=K.get(s),r=a(()=>{var p;return(p=i.data.value)==null?void 0:p.mappedTargetName.toLocaleLowerCase()}),u=z.list(s),y=a(()=>u.data.value||[]),c=Q.list(s),m=a(()=>c.data.value||[]);return{SyncType:F.SyncType,id:s,mappedTarget:r,supplyWisdomAssets:y,assets:m}};h.components=Object.assign({BusinessRatingSyncStatusDisplay:be,BusinessRatingSyncDisplay:_e},h.components);var Ce=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("main",{staticClass:"space-y-6"},[s("BusinessRatingSyncStatusDisplay",{attrs:{"account-id":e.id,"sync-type":e.SyncType.SUPPLY_WISDOM_TO_CYBER_ONE,"mapped-target":e.mappedTarget}}),s("BusinessRatingSyncDisplay",{attrs:{"account-id":e.id,"supply-wisdom-assets":e.supplyWisdomAssets,assets:e.assets}})],1)},Ae=[];const q={};var Ie=T(h,Ce,Ae,!1,Oe,null,null,null);function Oe(e){for(let t in q)this[t]=q[t]}const je=function(){return Ie.exports}();export{je as default};
