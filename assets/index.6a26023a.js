import{d as u,aK as M,cI as L,cL as k,n as x,cJ as w,c0 as P,aS as T,L as O,an as N,c9 as Q,cM as j,bl as F}from"./index.adc8478a.js";import{A as D}from"./AppTanStackTable.a12adf5d.js";import{P as G}from"./ProgressBar.3a738e72.js";import{c as H}from"./createOnChangeFn.c09f6a74.js";import{u as U}from"./createSimpleTable.4d2913a5.js";import"./magnifying-glass.b7cbe8fe.js";import"./chevron-up.736f4142.js";const C={};C.props={accountId:{key:"accountId",required:!0,type:String},takenId:{key:"takenId",required:!1,type:String},qId:{key:"qId",required:!0,type:String},status:{key:"status",required:!1,type:null}};C.setup=(e,n)=>{const t=e,I=u(()=>t.accountId),g=u(()=>t.qId),_=M(),v=L.create();async function q(){var a;const{response:f}=await v.mutateAsync({accountId:{value:I.value},questionnaireId:{value:g.value}});f.taken&&_.push({path:`custom-assessments/${(a=f.taken.id)==null?void 0:a.value}`,query:{section:"0"}})}return{Status:k.Status,createTaken:q}};var z=function(){var e=this,n=e.$createElement,t=e._self._c||n;return e.takenId?t("div",[e.status===e.Status.NOT_STARTED?t("BaseButton",{attrs:{shape:"rectangle",to:{path:`custom-assessments/${e.takenId}`,query:{section:"0"}}}},[e._v(" Begin ")]):e.status===e.Status.IN_PROGRESS?t("BaseButton",{attrs:{shape:"rectangle",to:{path:`custom-assessments/${e.takenId}`,query:{section:"0"}}}},[e._v(" Continue ")]):e.status===e.Status.COMPLETED?t("BaseButton",{attrs:{shape:"rectangle",to:`custom-assessments/${e.takenId}/results`}},[e._v(" Results ")]):e._e()],1):t("div",[t("BaseButton",{attrs:{shape:"rectangle"},on:{click:e.createTaken}},[e._v("Begin")])],1)},J=[];const b={};var K=x(C,z,J,!1,V,null,null,null);function V(e){for(let n in b)this[n]=b[n]}const W=function(){return K.exports}();function X(e){switch(e){case k.Status.NOT_STARTED:return"Not Started";case k.Status.IN_PROGRESS:return"In Progress";case k.Status.COMPLETED:return"Completed";default:return"N/A"}}const h={};h.props={responseId:{key:"responseId",required:!1,type:String},qId:{key:"qId",required:!0,type:String},status:{key:"status",required:!0,type:null}};h.setup=(e,n)=>{const t=e,I=u(()=>t.responseId),g=u(()=>t.qId),_=w.list(I),v=u(()=>{var s;return((s=_.data.value)==null?void 0:s.sort((r,o)=>{var d,p,y,S;const c=((p=(d=r.meta)==null?void 0:d.updatedAt)==null?void 0:p.value)||"";return(((S=(y=o.meta)==null?void 0:y.updatedAt)==null?void 0:S.value)||"").localeCompare(c)}))||[]}),q=P.read(g),f=u(()=>q.data.value),a=u(()=>{var r;const s=new Map;return(r=f.value)==null||r.sections.forEach(o=>{o.questions.forEach(c=>{var p;const l=(p=c.id)==null?void 0:p.value,d=v.value.find(y=>{var S;return((S=y.questionId)==null?void 0:S.value)===l});l&&d&&!s.has(l)&&s.set(l,d)})}),s}),m=u(()=>{var r;const s=[];return(r=f.value)==null||r.sections.forEach(o=>{s.push(o.questions.length)}),s.reduce((o,c)=>o+c,0)}),i=u(()=>{var r;const s=[];return(r=f.value)==null||r.sections.forEach(o=>o.questions.forEach(c=>{var d;const l=(d=c.id)==null?void 0:d.value;if(l){const p=a.value.get(l);p&&s.push(p)}})),s.length||0});return{toStringStatus:X,totalQuestions:m,totalAnswers:i}};h.components=Object.assign({ProgressBar:G},h.components);var Y=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"flex flex-col"},[t("span",[e._v(e._s(e.toStringStatus(e.status)))]),t("ProgressBar",{staticClass:"h-2 min-w-[12rem] rounded-full bg-gray-200 shadow-inner xl:min-w-[16rem] 2xl:min-w-[24rem]",attrs:{current:e.totalAnswers,max:e.totalQuestions}})],1)},Z=[];const E={};var ee=x(h,Y,Z,!1,te,null,null,null);function te(e){for(let n in E)this[n]=E[n]}const se=function(){return ee.exports}(),A={};A.props={accountId:{key:"accountId",required:!0,type:String},questionnaires:{key:"questionnaires",required:!0,type:Array},responses:{key:"responses",required:!0,type:Array}};A.setup=(e,n)=>{const t=e,I=u(()=>t.accountId),g=u(()=>{var m;const a=new Map;for(const i of t.questionnaires){const s=(m=i.id)==null?void 0:m.value,r=t.responses.find(o=>{var c;return((c=o.questionnaireId)==null?void 0:c.value)===s});s&&r&&!a.has(s)&&a.set(s,r)}return a}),_=u(()=>t.questionnaires.map(a=>{var s,r;const m=((s=a.id)==null?void 0:s.value)||"",i=g.value.get(m);return i?{takenId:(r=i.id)==null?void 0:r.value,questionnaireId:m,name:a.name,status:i.status}:{takenId:void 0,questionnaireId:m,name:a.name,status:k.Status.NOT_STARTED}})||[]),v=H(),q=[v.accessor("name",{header:()=>"Name",enableColumnFilter:!1}),v.accessor("status",{header:()=>"Status",cell:({row:a})=>T(se,{props:{responseId:a.original.takenId,qId:a.original.questionnaireId,status:a.original.status}}),enableColumnFilter:!1}),v.display({id:"button",header:"Button",cell:({row:a})=>T(W,{props:{accountId:I.value,takenId:a.original.takenId,qId:a.original.questionnaireId||"",status:a.original.status}})})];return{instance:U(_,q)}};A.components=Object.assign({AppTanStackTable:D},A.components);var ne=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("AppTanStackTable",{attrs:{table:e.instance}})},ae=[];const B={};var re=x(A,ne,ae,!1,oe,null,null,null);function oe(e){for(let n in B)this[n]=B[n]}const ue=function(){return re.exports}(),$={};$.setup=(e,n)=>{const t=Q("id"),I=j.list(t),g=u(()=>I.data.value||[]),_=P.list(),v=u(()=>_.data.value?_.data.value.filter(i=>g.value.some(s=>{var r,o,c;return((o=(r=s.questionnaire)==null?void 0:r.questionnaireId)==null?void 0:o.value)===((c=i.id)==null?void 0:c.value)})):[]),q=L.list(t),f=u(()=>{var i;return((i=q.data.value)==null?void 0:i.sort((s,r)=>{var l,d,p,y;const o=((d=(l=s.meta)==null?void 0:l.updatedAt)==null?void 0:d.value)||"";return(((y=(p=r.meta)==null?void 0:p.updatedAt)==null?void 0:y.value)||"").localeCompare(o)}))||[]}),a=F(),m=u(()=>a.isAdmin||a.isAnalyst);return{accountId:t,preferencesList:I,questionnairesList:_,questionnaires:v,takenList:q,responses:f,canManageQuestionnaires:m}};$.components=Object.assign({LoadingSpinner:O,PlusSvg:N,CustomAssessmentsTable:ue},$.components);var ce=function(){var e=this,n=e.$createElement,t=e._self._c||n;return e.preferencesList.isLoading.value||e.questionnairesList.isLoading.value||e.takenList.isLoading.value?t("LoadingSpinner"):t("BaseTablePageLayout",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v("Assessments")]},proxy:!0},{key:"button",fn:function(){return[e.canManageQuestionnaires?t("BaseButton",{staticClass:"space-x-1"},[t("PlusSvg",{staticClass:"-ml-1 w-5"}),t("span",[e._v("Assessment")])],1):e._e()]},proxy:!0},{key:"table",fn:function(){return[t("CustomAssessmentsTable",{attrs:{"account-id":e.accountId,questionnaires:e.questionnaires,responses:e.responses}})]},proxy:!0}])})},ie=[];const R={};var le=x($,ce,ie,!1,de,null,null,null);function de(e){for(let n in R)this[n]=R[n]}const ge=function(){return le.exports}();export{ge as default};
