import{d as u,aF as T,aS as l,br as R,aP as y,aQ as S,aK as F,n as k,bs as V,an as q,c9 as g}from"./index.e627960d.js";import{A as C,R as D}from"./RowSelectionInput.b6594500.js";import{A as M,T as Q}from"./AppTanStackTable.9bda351a.js";import{S as P}from"./ScorecardStatusBadge.22be80fd.js";import{c as j}from"./createOnChangeFn.7e56f0c4.js";import{F as E}from"./FileSaver.min.d1d8f9ff.js";import{u as N}from"./createSimpleTable.7ef16907.js";import{u as U}from"./useInDepthScorecards.fa3c97fe.js";import"./magnifying-glass.b7cbe8fe.js";import"./chevron-up.736f4142.js";const d={};d.props={id:{key:"id",required:!0,type:String},subId:{key:"subId",required:!0,type:String},scorecards:{key:"scorecards",required:!0,type:Array}};d.setup=(t,a)=>{const s=t,n=u(()=>s.id),c=u(()=>s.subId),x=u(()=>s.scorecards.map(e=>{var p,v;const r=new Date,i=((p=e.yearQuarterValue.split("/")[0])==null?void 0:p.trim())||r.getUTCFullYear().toString(),_=((v=e.yearQuarterValue.split("/")[1])==null?void 0:v.trim())||`Q${Math.ceil((r.getMonth()+1)/3)}`;return{id:e.id,supplier:e.data["Supplier Name"]||"",status:e.status,year:i,quarter:_,updatedAt:e.data.updatedAt||r.toString()}})),A=u(()=>x.value.filter(e=>e.supplier!==void 0)),b=T(),o=j(),I=[o.display({id:"select",header:({table:e})=>l(C,{props:{table:e}}),cell:({row:e})=>l(D,{props:{row:e}})}),o.accessor(e=>e.supplier,{id:"supplier",header:()=>"Supplier",cell:e=>e.getValue()}),o.accessor("status",{header:()=>"Status",cell:e=>l(P,{props:{value:e.getValue()}}),enableColumnFilter:!1}),o.accessor("quarter",{header:()=>"Quarter",cell:e=>e.getValue()}),o.accessor("year",{header:()=>"Year",cell:e=>e.getValue(),filterFn:"weakEquals"}),o.accessor("updatedAt",{header:()=>"Last Updated",cell:e=>l(R,{props:{value:e.getValue(),format:"date"}}),enableColumnFilter:!1}),o.display({id:"actions",header:"Actions",cell:({row:e})=>l(Q,{props:{actions:[{id:"edit",to:`/admin/companies/${n.value}/subscriptions/${c.value}/integrations/1/scorecards/in-depth/${e.original.id}`},{id:"download",async action(){const r=await y(`${S}/companies/${s.id}/scorecards/${e.original.id}/docx`,{responseType:"blob"}),i=`${e.original.supplier} Scorecard ${e.original.quarter} ${e.original.id}.docx`;E.exports.saveAs(r.data,i)}},{id:"archive",async action(){(await y.delete(`${S}/companies/${s.id}/scorecards/${e.original.id}`)).status===200&&b.success("Archived Scorecard Successfully")}}]}})})],f=N(A,I),w=F(),B=[{id:"archive",async action(){const e=f.getSelectedRowModel().rows,r=e.length;let i=0;if(r>0){for(const _ of e){const p=_.original.id;(await y.delete(`${S}/companies/${n.value}/scorecards/${p}`)).status===200&&i++}b.success(`Archived ${i}/${r} Scorecard(s) Successfully`),w.push(`/admin/companies/${n.value}/subscriptions/${c.value}/integrations/1/scorecards/in-depth`)}},isDisabled:u(()=>f.getSelectedRowModel().rows.length===0)}];return{instance:f,bulkActions:B}};d.components=Object.assign({AppTanStackTable:M},d.components);var H=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("AppTanStackTable",{attrs:{table:t.instance,"table-actions":t.bulkActions}})},L=[];const $={};var O=k(d,H,L,!1,Y,null,null,null);function Y(t){for(let a in $)this[a]=$[a]}const z=function(){return O.exports}(),m={};m.setup=(t,a)=>{const s=g("id"),n=g("subscriptionId"),c=U.list(s);return{id:s,subscriptionId:n,scorecards:c}};m.components=Object.assign({BackButton:V,PlusSvg:q,ScorecardsTable:z},m.components);var K=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("BaseTablePageLayout",{scopedSlots:t._u([{key:"backButton",fn:function(){return[s("BackButton",{attrs:{link:`/admin/companies/${t.id}/subscriptions/${t.subscriptionId}/integrations`}})]},proxy:!0},{key:"overline",fn:function(){return[t._v("Bitsight")]},proxy:!0},{key:"title",fn:function(){return[t._v("In-Depth Scorecards")]},proxy:!0},{key:"button",fn:function(){return[s("BaseButton",{staticClass:"space-x-1",attrs:{type:"button",to:"new",append:""}},[s("PlusSvg",{staticClass:"-ml-1 w-5"}),s("span",[t._v("Scorecard")])],1)]},proxy:!0},{key:"table",fn:function(){return[s("BaseVueQuery",{attrs:{query:t.scorecards},scopedSlots:t._u([{key:"success",fn:function(n){var c=n.data;return[s("ScorecardsTable",{attrs:{id:t.id,"sub-id":t.subscriptionId,scorecards:c}})]}}])})]},proxy:!0}])})},G=[];const h={};var J=k(m,K,G,!1,W,null,null,null);function W(t){for(let a in h)this[a]=h[a]}const ie=function(){return J.exports}();export{ie as default};
