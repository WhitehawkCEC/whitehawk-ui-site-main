import{d as f,aF as q,aS as d,br as P,aP as v,aQ as b,a_ as p,aK as Q,n as C,bs as D,an as N,c7 as x}from"./index.7337bb27.js";import{A as U,R as j}from"./RowSelectionInput.1160520a.js";import{A as E,T as O}from"./AppTanStackTable.78173634.js";import{S as z}from"./ScorecardStatusBadge.ebd4627d.js";import{u as H,c as L,i as g,r as Y,h as G,g as K,f as J,b as W,e as X,d as Z}from"./createOnChangeFn.91b1f267.js";import{F as ee}from"./FileSaver.min.8f692f56.js";import{u as te}from"./useInDepthScorecards.3f4800b0.js";import"./magnifying-glass.b7cbe8fe.js";import"./TransitionExpand.959cadb6.js";import"./chevron-up.736f4142.js";const m={};m.props={id:{key:"id",required:!0,type:String},subId:{key:"subId",required:!0,type:String},scorecards:{key:"scorecards",required:!0,type:Array}};m.setup=(t,a)=>{const s=t,i=f(()=>s.id),l=f(()=>s.subId),M=f(()=>s.scorecards.map(e=>{var c,S;const r=new Date,n=((c=e.yearQuarterValue.split("/")[0])==null?void 0:c.trim())||r.getUTCFullYear().toString(),u=((S=e.yearQuarterValue.split("/")[1])==null?void 0:S.trim())||`Q${Math.ceil((r.getMonth()+1)/3)}`;return{id:e.id,supplier:e.data["Supplier Name"]||"",status:e.status,year:n,quarter:u,updatedAt:e.data.updatedAt||r.toString()}})),T=f(()=>M.value.filter(e=>e.supplier!==void 0)),y=q(),o=L(),B=[o.display({id:"select",header:({table:e})=>d(U,{props:{table:e}}),cell:({row:e})=>d(j,{props:{row:e}})}),o.accessor(e=>e.supplier,{id:"supplier",header:()=>"Supplier",cell:e=>e.getValue()}),o.accessor("status",{header:()=>"Status",cell:e=>d(z,{props:{value:e.getValue()}}),enableColumnFilter:!1}),o.accessor("quarter",{header:()=>"Quarter",cell:e=>e.getValue()}),o.accessor("year",{header:()=>"Year",cell:e=>e.getValue(),filterFn:"weakEquals"}),o.accessor("updatedAt",{header:()=>"Last Updated",cell:e=>d(P,{props:{value:e.getValue(),format:"date"}}),enableColumnFilter:!1}),o.display({id:"actions",header:"Actions",cell:({row:e})=>d(O,{props:{actions:[{id:"edit",to:`/admin/companies/${i.value}/subscriptions/${l.value}/integrations/1/scorecards/in-depth/${e.original.id}`},{id:"download",async action(){const r=await v(`${b}/companies/${s.id}/scorecards/${e.original.id}/docx`,{responseType:"blob"}),n=`${e.original.supplier} Scorecard ${e.original.quarter} ${e.original.id}.docx`;ee.exports.saveAs(r.data,n)}},{id:"archive",async action(){(await v.delete(`${b}/companies/${s.id}/scorecards/${e.original.id}`)).status===200&&y.success("Archived Scorecard Successfully")}}]}})})],h=p([]),$=p({pageIndex:0,pageSize:10}),w=p(""),k=p([]),F=p({}),R=H({get data(){return T.value},columns:B,state:{get sorting(){return h.value},get pagination(){return $.value},get globalFilter(){return w.value},get columnFilters(){return k.value},get rowSelection(){return F.value}},onSortingChange:g(h),onPaginationChange:g($),onColumnFiltersChange:g(k),onGlobalFilterChange:g(w),globalFilterFn:(e,r,n,u)=>{const c=Y(e.getValue(r),n,{threshold:G.CONTAINS});return u(c),c.passed},onRowSelectionChange:g(F),getCoreRowModel:K(),getSortedRowModel:J(),getFacetedUniqueValues:W(),getPaginationRowModel:X(),getFilteredRowModel:Z()}),V=Q();return{instance:R,bulkActions:[{id:"archive",async action(){const e=R.getSelectedRowModel().rows,r=e.length;let n=0;if(r>0){for(const u of e){const c=u.original.id;(await v.delete(`${b}/companies/${s.id}/scorecards/${c}`)).status===200&&n++}y.success(`Archived ${n}/${r} Scorecard(s) Successfully`),V.push(`/admin/companies/${s.id}/scorecards/in-depth/rating-service-1`)}}}]}};m.components=Object.assign({AppTanStackTable:E},m.components);var se=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("AppTanStackTable",{attrs:{table:t.instance,"table-actions":t.bulkActions}})},ae=[];const A={};var re=C(m,se,ae,!1,ne,null,null,null);function ne(t){for(let a in A)this[a]=A[a]}const oe=function(){return re.exports}(),_={};_.setup=(t,a)=>{const s=x("id"),i=x("subscriptionId"),l=te.list(s);return{id:s,subscriptionId:i,scorecards:l}};_.components=Object.assign({BackButton:D,PlusSvg:N,ScorecardsTable:oe},_.components);var ce=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("BaseTablePageLayout",{scopedSlots:t._u([{key:"backButton",fn:function(){return[s("BackButton",{attrs:{link:`/admin/companies/${t.id}/subscriptions/${t.subscriptionId}/integrations`}})]},proxy:!0},{key:"overline",fn:function(){return[t._v("Bitsight")]},proxy:!0},{key:"title",fn:function(){return[t._v("In-Depth Scorecards")]},proxy:!0},{key:"button",fn:function(){return[s("BaseButton",{staticClass:"space-x-1",attrs:{type:"button",to:"new",append:""}},[s("PlusSvg",{staticClass:"-ml-1 w-5"}),s("span",[t._v("Scorecard")])],1)]},proxy:!0},{key:"table",fn:function(){return[s("BaseVueQuery",{attrs:{query:t.scorecards},scopedSlots:t._u([{key:"success",fn:function(i){var l=i.data;return[s("ScorecardsTable",{attrs:{id:t.id,"sub-id":t.subscriptionId,scorecards:l}})]}}])})]},proxy:!0}])})},ie=[];const I={};var le=C(_,ce,ie,!1,ue,null,null,null);function ue(t){for(let a in I)this[a]=I[a]}const $e=function(){return le.exports}();export{$e as default};
