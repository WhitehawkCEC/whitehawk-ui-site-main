import{T as M}from"./ToolTip.568c4984.js";import{aB as A,n as p,d as u,c as j,b as F,cA as q,br as O,bn as E}from"./index.9293fb8e.js";import{B as V,a as I,b as P,c as H,d as G}from"./BlackKiteProgressBar.76a86c1e.js";import{T as z}from"./TransitionExpand.829c0957.js";import{G as N}from"./GradeLetterDisplay.a728f017.js";import{b as W}from"./ratingScoreDescription.3b48b1ea.js";const x={};x.props={value:{key:"value",required:!0,type:Array},options:{key:"options",required:!0,type:Array},isReadonly:{key:"isReadonly",required:!1,type:Boolean,default:!1}};x.setup=(e,r)=>{const t=e,s=r.emit;return{proxy:A(t,s)}};var U=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"flex flex-col space-y-5"},e._l(e.proxy.length,function(s){return t("BaseLabel",{key:s,staticClass:"grid gap-1"},[t("span",[e._v("Focus Area "+e._s(s))]),t("div",{staticClass:"xl:col-span-2"},[t("BaseInput",{staticClass:"w-full",attrs:{readonly:""},model:{value:e.proxy[s-1],callback:function(a){e.$set(e.proxy,s-1,a)},expression:"proxy[i - 1]"}})],1)])}),1)},Z=[];const B={};var J=p(x,U,Z,!1,Q,null,null,null);function Q(e){for(let r in B)this[r]=B[r]}const X=function(){return J.exports}(),C={};C.props={findings:{key:"findings",required:!0,type:null}};C.setup=(e,r)=>{const t=e,s=u(()=>["Critical","High","Medium","Low"]),a=u(()=>{const n=new Map;for(const i of Object.entries(t.findings)){const[l,b]=i,g=l.split(/(?=[A-Z])/)[0];if(g){const k=n.get(g);k?k.push({key:l,value:b}):n.set(g,[{key:l,value:b}])}}return n}),c=u(()=>[{header:"Failed",data:a.value.get("failed")||[]},{header:"Warning",data:a.value.get("warning")||[]},{header:"Passed",data:a.value.get("passed")||[]}]);function o(n){switch(n){case"failedCritical":return{bgColor:"bg-gradient-to-r from-red-900 to-red-800",textColor:"text-red-50"};case"failedHigh":return{bgColor:"bg-gradient-to-r from-red-800 to-red-700",textColor:"text-red-50"};case"failedMedium":return{bgColor:"bg-gradient-to-r from-red-700 to-red-600",textColor:"text-red-50"};case"failedLow":return{bgColor:"bg-gradient-to-r from-red-600 to-red-500",textColor:"text-red-50"};case"warningCritical":return{bgColor:"bg-gradient-to-r from-amber-900 to-amber-800",textColor:"text-amber-50"};case"warningHigh":return{bgColor:"bg-gradient-to-r from-amber-800 to-amber-700",textColor:"text-amber-50"};case"warningMedium":return{bgColor:"bg-gradient-to-r from-amber-700 to-amber-600",textColor:"text-amber-50"};case"warningLow":return{bgColor:"bg-gradient-to-r from-amber-600 to-amber-500",textColor:"text-amber-50"};case"passedCritical":return{bgColor:"bg-gradient-to-r from-green-900 to-green-800",textColor:"text-green-50"};case"passedHigh":return{bgColor:"bg-gradient-to-r from-green-800 to-green-700",textColor:"text-green-50"};case"passedMedium":return{bgColor:"bg-gradient-to-r from-green-700 to-green-600",textColor:"text-green-50"};case"passedLow":return{bgColor:"bg-gradient-to-r from-green-600 to-green-500",textColor:"text-green-50"};default:return{bgColor:"bg-gray-500",textColor:"text-white"}}}return{headers:s,rows:c,display:o}};var Y=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("section",{staticClass:"overflow-x-auto pr-4 pb-4"},[t("table",{staticClass:"w-full text-center sm:table-fixed md:table-auto lg:table-fixed"},[t("thead",[t("tr",[t("td"),e._l(e.headers,function(s){return t("th",{key:s,staticClass:"px-4 py-4 text-center",attrs:{scope:"col",colspan:"1"}},[t("BaseTypography",{staticClass:"uppercase text-gray-700",attrs:{variant:"overline"}},[e._v(" "+e._s(s)+" ")])],1)})],2)]),t("tbody",e._l(e.rows,function(s){return t("tr",{key:s.header},[t("th",{staticClass:"px-4 py-2",attrs:{scope:"row"}},[t("BaseTypography",{staticClass:"uppercase text-gray-700",attrs:{variant:"overline"}},[e._v(" "+e._s(s.header)+" ")])],1),e._l(s.data,function(a){return t("td",{key:a.key,staticClass:"p-1"},[t("span",{staticClass:"flex justify-center space-y-1 rounded-xl p-3 hover:scale-[1.02]",class:e.display(a.key).bgColor},[t("BaseTypography",{class:e.display(a.key).textColor,attrs:{variant:"h3",component:"h6"}},[e._v(" "+e._s(a.value?a.value.toLocaleString():"0")+" ")])],1)])})],2)}),0)])])},ee=[];const $={};var te=p(C,Y,ee,!1,re,null,null,null);function re(e){for(let r in $)this[r]=$[r]}const se=function(){return te.exports}(),d={};d.props={compliance:{key:"compliance",required:!0,type:Array}};d.setup=(e,r)=>({});d.components=Object.assign({BlackKiteDonut:V},d.components);var ae=function(){var e=this,r=e.$createElement,t=e._self._c||r;return e.compliance?t("section",{staticClass:"grid lg:grid-cols-2 2xl:grid-cols-4"},e._l(e.compliance,function(s){return t("div",{key:s.StandardCode,staticClass:"flex justify-center sm:pt-4"},[t("BlackKiteDonut",{attrs:{value:s}})],1)}),0):e._e()},ne=[];const S={};var oe=p(d,ae,ne,!1,ie,null,null,null);function ie(e){for(let r in S)this[r]=S[r]}const le=function(){return oe.exports}(),_={};_.props={value:{key:"value",required:!0,type:Boolean},padding:{key:"padding",required:!1,type:[String,Array]}};_.setup=(e,r)=>{const t=e,s=r.emit;return{proxy:A(t,s)}};_.components=Object.assign({TransitionExpand:z,ToggleButton:j},_.components);var ce=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("section",[t("div",[e._t("partialContent"),t("TransitionExpand",[e.proxy?t("div",[e._t("transitionContent")],2):e._e()])],2),t("div",{class:e.padding},[t("BaseLabel",{staticClass:"inline-flex cursor-pointer rounded-md border border-gray-300 py-1 pl-3 pr-2 hover:border-indigo-600 hover:bg-indigo-200 hover:text-indigo-600",attrs:{"aria-label":"Toggle Visibility"}},[e._t("buttonText"),t("ToggleButton",{class:e.proxy?"rotate-180 transform transition-transform duration-100":"",attrs:{"aria-label":e.proxy?"toggle on":"toggle off"},model:{value:e.proxy,callback:function(s){e.proxy=s},expression:"proxy"}})],2)],1)])},pe=[];const w={};var ue=p(_,ce,pe,!1,de,null,null,null);function de(e){for(let r in w)this[r]=w[r]}const _e=function(){return ue.exports}(),v={};v.props={compliance:{key:"compliance",required:!0,type:Array}};v.setup=(e,r)=>{const t=["CIS CSC-20","CMMC 2.0","NIST 800-53 R5","NIST 800-171"],s=e,a=F(!1),c=u(()=>{const n=[];for(const i of s.compliance){const{StandardCode:l}=i;t.includes(l)&&n.push(i)}return n.sort((i,l)=>i.StandardCode.trim().localeCompare(l.StandardCode.trim()))}),o=u(()=>{const n=[];for(const i of s.compliance){const{StandardCode:l}=i;t.includes(l)||n.push(i)}return n.sort((i,l)=>i.StandardCode.trim().localeCompare(l.StandardCode.trim()))});return{showAll:a,defaultCompliance:c,toTransition:o}};v.components=Object.assign({PartialDisplayCollapsibleSection:_e,BlackKiteReportCompliance:le},v.components);var ve=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("PartialDisplayCollapsibleSection",{scopedSlots:e._u([{key:"partialContent",fn:function(){return[t("BlackKiteReportCompliance",{attrs:{compliance:e.defaultCompliance}})]},proxy:!0},{key:"transitionContent",fn:function(){return[t("BlackKiteReportCompliance",{attrs:{compliance:e.toTransition}})]},proxy:!0},{key:"buttonText",fn:function(){return[e._v(" "+e._s(e.showAll?"View Less":"View All")+" ")]},proxy:!0}]),model:{value:e.showAll,callback:function(s){e.showAll=s},expression:"showAll"}})},me=[];const T={};var ye=p(v,ve,me,!1,fe,null,null,null);function fe(e){for(let r in T)this[r]=T[r]}const ge=function(){return ye.exports}(),m={};m.props={score:{key:"score",required:!0,type:Number},date:{key:"date",required:!0,type:String}};m.setup=(e,r)=>({});m.components=Object.assign({DotsSquare:q,BlackKiteProgressBar:I,GradeLetterDisplay:N,DateIsoStringDisplay:O},m.components);var xe=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"relative mx-auto flex max-w-xs flex-col items-center justify-center overflow-hidden rounded-xl bg-gradient-to-br from-blue-100 via-white to-white px-4 py-8 shadow-md sm:max-w-sm sm:rounded-3xl xl:max-w-none xl:p-12"},[t("div",{staticClass:"absolute top-full left-full -translate-y-1/3 -translate-x-1/3 rotate-45 transform xl:-translate-y-1/2"},[t("DotsSquare",{attrs:{color:"blue"}})],1),t("div",{staticClass:"relative w-44 sm:w-56"},[t("BlackKiteProgressBar",{attrs:{score:e.score,"max-score":100}})],1),t("div",{staticClass:"absolute flex flex-col items-center space-y-2"},[t("BaseTypography",{attrs:{variant:"h2"}},[e._v(e._s(e.score))]),t("GradeLetterDisplay",{attrs:{grade:e.score}}),e.date?t("div",{staticClass:"flex flex-col text-center"},[t("BaseTypography",{staticClass:"text-gray-500",attrs:{variant:"overline"}},[e._v(" Last updated: ")]),t("BaseTypography",{staticClass:"text-gray-500",attrs:{variant:"overline"}},[t("DateIsoStringDisplay",{attrs:{value:e.date,format:"date"}})],1)],1):e._e()],1)])},Ce=[];const D={};var he=p(m,xe,Ce,!1,be,null,null,null);function be(e){for(let r in D)this[r]=D[r]}const ke=function(){return he.exports}(),y={};y.props={score:{key:"score",required:!0,type:Number},date:{key:"date",required:!0,type:String},description:{key:"description",required:!1,type:String}};y.setup=(e,r)=>{const t=e;return{ratingScoreDescription:u(()=>t.description?t.description:W(t.score))}};y.components=Object.assign({WaveForm:E,BlackKiteScoreDisplay:ke,BlackKiteGradeDescriptions:P},y.components);var Be=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"relative flex flex-col items-center justify-center xl:grid xl:grid-cols-12"},[t("div",{staticClass:"absolute top-36 w-full opacity-25 sm:top-40 xl:hidden"},[t("WaveForm")],1),t("div",{staticClass:"relative -mb-36 xl:col-span-4 xl:col-start-1 xl:row-start-1 xl:mb-0"},[t("div",{staticClass:"px-6 md:px-8 lg:px-4 xl:pl-0"},[t("BlackKiteScoreDisplay",{attrs:{score:e.score,date:e.date}})],1)]),t("BaseSimpleCard",{staticClass:"pt-32 xl:col-span-10 xl:col-start-3 xl:row-start-1 xl:h-fit xl:p-0"},[t("div",{staticClass:"grid items-center gap-6 px-6 py-10 sm:p-8 lg:grid-cols-10 lg:gap-0 xl:p-6"},[t("div",{staticClass:"grid gap-5 text-center lg:col-span-8 lg:text-left xl:col-span-6 xl:col-start-3"},[t("BaseTypography",{staticClass:"text-prime-navy",attrs:{component:"h3",variant:"h5"}},[e._v(" Cyber Risk ")]),t("BaseTypography",{staticClass:"text-gray-600",attrs:{component:"p",variant:"p1"}},[e._v(" The Cyber Risk measures a company\u2019s relative security effectiveness. "+e._s(e.ratingScoreDescription)+" ")])],1),t("div",{staticClass:"flex justify-center lg:col-span-2"},[t("BlackKiteGradeDescriptions")],1)])])],1)},$e=[];const K={};var Se=p(y,Be,$e,!1,we,null,null,null);function we(e){for(let r in K)this[r]=K[r]}const Te=function(){return Se.exports}(),h={};h.props={value:{key:"value",required:!0,type:null}};h.setup=(e,r)=>{const t=u(()=>["CMMC Category","Level 1","Level 2"]);function s(c){return c>=4?"text-green-400":c>=1?"text-yellow-300":"text-red-400"}function a(c){return["L1","L2"].map(o=>c[o]||{averageStarLevel:null})}return{headers:t,color:s,normalizeLevels:a}};var De=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("BaseSimpleCard",{staticClass:"overflow-x-auto border"},[t("table",{staticClass:"w-full"},[t("thead",[t("tr",e._l(e.headers,function(s){return t("th",{key:s,staticClass:"border-b border-r px-4 py-2 text-center first:text-left last:border-r-0",attrs:{scope:"colgroup"}},[t("BaseTypography",{staticClass:"text-gray-800",attrs:{variant:"subtitle2"}},[e._v(" "+e._s(s)+" ")])],1)}),0)]),t("tbody",e._l(e.value,function(s,a,c){return t("tr",{key:s.displayValue,staticClass:"odd:bg-gray-50"},[t("th",{staticClass:"px-4 py-2 text-left",class:{"bg-gray-50":c%2===0},attrs:{scope:"row"}},[t("BaseTypography",{staticClass:"text-gray-600",attrs:{variant:"p2"}},[e._v(" "+e._s(s.displayValue)+" ")])],1),e._l(e.normalizeLevels(s.levels),function(o,n){return t("td",{key:n},[t("div",{staticClass:"flex items-center justify-center"},[o?[o.averageStarLevel===null?[t("span",{staticClass:"sr-only"},[e._v(" "+e._s(o.averageStarLevel)+" ")]),t("span",[e._v("-")])]:[t("span",{staticClass:"sr-only"},[e._v(" "+e._s(o.averageStarLevel)+" ")]),t("svg",{staticClass:"h-3 w-3 fill-current",class:e.color(o.averageStarLevel),attrs:{viewBox:"-4 -4 8 8"}},[t("circle",{attrs:{stroke:"1",r:"4"}})])]]:e._e()],2)])})],2)}),0)])])},Ke=[];const R={};var Re=p(h,De,Ke,!1,Le,null,null,null);function Le(e){for(let r in R)this[r]=R[r]}const Ae=function(){return Re.exports}(),f={};f.props={value:{key:"value",required:!0,type:null},findings:{key:"findings",required:!0,type:null}};f.setup=(e,r)=>({});f.components=Object.assign({BlackKiteSummaryOverview:Te,ToolTip:M,BlackKiteHeatmap:se,BlackKiteRiskVectorsDisplay:H,BlackKiteFocusAreasDisplay:X,BlackKiteReportComplianceFiltered:ge,CmmcAnalysisDisplay:Ae,BlackKiteReportRisk:G},f.components);var Me=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("section",{staticClass:"space-y-10"},[t("BlackKiteSummaryOverview",{attrs:{score:parseInt(e.value.reports.summary.GradeOver100),date:e.value.reports.summary.LastUpdatedAt}}),t("div",{staticClass:"space-y-2"},[t("div",{staticClass:"flex items-center space-x-2"},[t("BaseTypography",{staticClass:"text-prime-navy",attrs:{component:"h3",variant:"h6"}},[e._v(" Vulnerability Heat Map ")]),t("ToolTip",{staticClass:"pt-1"},[e._v(" This heat map is the graphical distribution of vulnerabilities where the status and the severity of each finding are represented as the total number in each cell. Please note that 'Leaked Credentials' are represented as 1 (even if there are thousands) in order not to skew the chart. ")])],1),t("BaseSimpleCard",[t("BlackKiteHeatmap",{attrs:{findings:e.findings}})],1)],1),t("div",{staticClass:"grid gap-10 lg:grid-cols-2"},[t("div",{staticClass:"space-y-2"},[t("BaseTypography",{staticClass:"text-prime-navy",attrs:{component:"h3",variant:"h6"}},[e._v(" Risk Vector Analysis ")]),t("BaseSimpleCard",{staticClass:"p-4 sm:px-6 sm:py-5"},[t("BlackKiteRiskVectorsDisplay",{attrs:{value:e.value.riskVectors}})],1)],1),t("div",{staticClass:"space-y-2"},[t("BaseTypography",{staticClass:"text-prime-navy",attrs:{component:"h3",variant:"h6"}},[e._v(" Focus Areas ")]),t("BaseSimpleCard",{staticClass:"p-4 sm:px-6 sm:py-5"},[t("BlackKiteFocusAreasDisplay",{attrs:{value:e.value.focusAreaOrder.slice(0,3),options:e.value.focusAreaOrder,"is-readonly":!0}})],1)],1)]),t("div",{staticClass:"space-y-2"},[t("BaseTypography",{staticClass:"text-prime-navy",attrs:{component:"h3",variant:"h6"}},[e._v(" Compliance ")]),t("BaseSimpleCard",{staticClass:"p-4 sm:px-6 sm:py-5"},[t("BlackKiteReportComplianceFiltered",{attrs:{compliance:e.value.reports.compliance}})],1)],1),t("div",{staticClass:"space-y-2"},[t("div",{staticClass:"flex items-end space-x-1"},[t("BaseTypography",{staticClass:"text-prime-navy",attrs:{component:"h3",variant:"h6"}},[e._v(" CMMC Analysis ")]),t("ToolTip",[e._v(" Note: While Levels 1-2 are finalized for CMMC 2.0, DoD is still in the process of completing the Level 3 requirements. Once the Level 3 mappings are finalized, this report will be updated to include Level 3 observations. ")])],1),t("CmmcAnalysisDisplay",{attrs:{value:e.value.cmmcAnalysis}})],1),t("div",{staticClass:"space-y-2"},[t("BaseTypography",{staticClass:"text-prime-navy",attrs:{component:"h3",variant:"h6"}},[e._v(" FAIR Assessment ")]),t("BaseSimpleCard",{staticClass:"p-4 sm:px-6 sm:py-5"},[t("BlackKiteReportRisk",{attrs:{risk:e.value.reports.risk}})],1)],1),e._t("default")],2)},je=[];const L={};var Fe=p(f,Me,je,!1,qe,null,null,null);function qe(e){for(let r in L)this[r]=L[r]}const Ge=function(){return Fe.exports}();export{Ge as B};
