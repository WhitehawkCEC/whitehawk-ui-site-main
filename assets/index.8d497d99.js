import{D as N}from"./document-arrow-down.2aec0021.js";import{aC as q,d as b,aJ as M,aS as m,br as T,aZ as _,aB as V,n as w,az as P,L as Z,bZ as j,r as B,aP as L,aQ as O}from"./index.eded5c35.js";import{B as Q}from"./BackButton.6781e17d.js";import{A as U,R as E}from"./RowSelectionInput.283cbc57.js";import{A as z,T as H}from"./AppTanStackTable.3b0c4f3e.js";import{S as Y}from"./ScorecardStatusBadge.50426c02.js";import{u as G,c as J,i as y,r as K,h as W,g as X,f as ee,b as te,e as ae,d as se}from"./createOnChangeFn.110d9d64.js";import{u as re}from"./useInDepthScorecards.528c08f4.js";import"./chevron-left.0808b01b.js";import"./magnifying-glass.b7cbe8fe.js";import"./TransitionExpand.4c957ad6.js";import"./chevron-up.736f4142.js";const g={};g.props={id:{key:"id",required:!0,type:String},value:{key:"value",required:!1,type:Array},scorecards:{key:"scorecards",required:!0,type:Array}};g.setup=(e,s)=>{const t=e,r=s.emit,o=q(t,r),i=b(()=>t.scorecards.map(a=>{var p,k;const l=new Date,c=((p=a.yearQuarterValue.split("/")[0])==null?void 0:p.trim())||l.getUTCFullYear().toString(),S=((k=a.yearQuarterValue.split("/")[1])==null?void 0:k.trim())||`Q${Math.ceil((l.getMonth()+1)/3)}`;return{id:a.id,supplier:a.data["Supplier Name"]||"",status:a.status,year:c,quarter:S,updatedAt:a.data.updatedAt||"N/A"}})),x=b(()=>i.value.filter(a=>a.supplier!=="")),C=M(),n=J(),v=[n.display({id:"select",header:({table:a})=>m(U,{props:{table:a}}),cell:({row:a})=>m(E,{props:{row:a}})}),n.accessor(a=>a.supplier,{id:"supplier",header:()=>"Supplier",cell:a=>a.getValue(),enableColumnFilter:!1}),n.accessor("status",{header:()=>"Status",cell:a=>m(Y,{props:{value:a.getValue()}}),enableColumnFilter:!1}),n.accessor("quarter",{header:()=>"Quarter",cell:a=>a.getValue(),enableColumnFilter:!1}),n.accessor("year",{header:()=>"Year",cell:a=>a.getValue(),enableColumnFilter:!1}),n.accessor("updatedAt",{header:()=>"Last Updated",cell:a=>m(T,{props:{value:a.getValue(),format:"date"}}),enableColumnFilter:!1}),n.display({id:"actions",header:"Actions",cell:({row:a})=>m(H,{props:{actions:[{id:"edit",action(){C.push(`/admin/companies/${encodeURIComponent(t.id)}/scorecards/in-depth/rating-service-2/${a.original.id}`)}}]}})})],u=_([]),d=_({pageIndex:0,pageSize:10}),$=_(""),R=_({}),F=G({get data(){return x.value},columns:v,state:{get sorting(){return u.value},get pagination(){return d.value},get globalFilter(){return $.value},get rowSelection(){return R.value}},onSortingChange:y(u),onPaginationChange:y(d),onGlobalFilterChange:y($),globalFilterFn:(a,l,c,S)=>{const p=K(a.getValue(l),c,{threshold:W.CONTAINS});return S(p),p.passed},onRowSelectionChange:y(R),getCoreRowModel:X(),getSortedRowModel:ee(),getFacetedUniqueValues:te(),getPaginationRowModel:ae(),getFilteredRowModel:se()});return V(()=>F.getSelectedRowModel().rows,a=>{if(a){const l=[];a.forEach(c=>{l.push({scorecardId:c.original.id,supplierName:c.original.supplier})}),o.value=l}}),{instance:F}};g.components=Object.assign({AppTanStackTable:z},g.components);var oe=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("AppTanStackTable",{attrs:{table:e.instance}})},ne=[];const D={};var le=w(g,oe,ne,!1,ce,null,null,null);function ce(e){for(let s in D)this[s]=D[s]}const ie=function(){return le.exports}(),f={};f.props={id:{key:"id",required:!0,type:String},value:{key:"value",required:!1,type:null},scorecards:{key:"scorecards",required:!0,type:Array}};f.setup=(e,s)=>{const t=e,r=s.emit;return{proxy:P(t,r)}};f.components=Object.assign({ConvertBatchScorecardsTable:ie},f.components);var ue=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",{staticClass:"grid gap-6"},[t("ConvertBatchScorecardsTable",{attrs:{id:e.id,scorecards:e.scorecards},model:{value:e.proxy.scorecards,callback:function(r){e.$set(e.proxy,"scorecards",r)},expression:"proxy.scorecards"}}),t("BaseSimpleCard",{staticClass:"divide-y"},[t("BaseLabel",{staticClass:"flex flex-col p-4 lg:grid lg:grid-cols-3 lg:items-center"},[t("span",{staticClass:"space-x-1"},[e._v(" File Name "),t("span",{staticClass:"text-red-500"},[e._v("*")])]),t("div",{staticClass:"flex flex-col lg:col-span-2"},[t("BaseInput",{attrs:{type:"text",required:"","aria-required":"true"},model:{value:e.proxy.fileName,callback:function(r){e.$set(e.proxy,"fileName",r)},expression:"proxy.fileName"}})],1)]),t("dl",{staticClass:"p-4"},[t("dt",{staticClass:"sr-only"},[e._v("File Name Display:")]),t("div",{staticClass:"rounded-md border bg-gray-100 p-2 shadow-inner"},[t("dd",{staticClass:"text-gray-500"},[e._v(e._s(e.proxy.fileName)+".zip")])])])],1)],1)},de=[];const A={};var pe=w(f,ue,de,!1,me,null,null,null);function me(e){for(let s in A)this[s]=A[s]}const ge=function(){return pe.exports}(),h={};h.setup=(e,s)=>{const t=j("id"),r=B(!1),o=B(),i=re.list(t),x=b(()=>{var v,u,d;return!((v=o.value)!=null&&v.fileName)||!((d=(u=o.value)==null?void 0:u.scorecards)!=null&&d.length)}),C=M();async function n(){if(!!o.value){r.value=!0;try{await L.post(`${O}/companies/${t.value}/batch/scorecards`,{fileName:o.value.fileName,supplierScorecardInfos:o.value.scorecards})}finally{r.value=!1}C.push(`/admin/companies/${t.value}/scorecards/batch/rating-service-2?expandZipView=true`)}}return{id:t,isLoading:r,fileZip:o,scorecards:i,isDisabled:x,convert:n}};h.components=Object.assign({BackButton:Q,ConvertScorecardsInput:ge,LoadingSpinner:Z,DocumentDownloadSvg:N},h.components);var fe=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"space-y-6"},[t("div",{staticClass:"flex flex-col space-y-4 lg:flex-row lg:items-center lg:space-x-4 lg:space-y-0"},[t("BackButton"),t("BaseTypography",{attrs:{variant:"h5"}},[e._v("Convert Scorecards to ZIP")])],1),t("form",{staticClass:"space-y-6",on:{submit:function(r){return r.preventDefault(),e.convert.apply(null,arguments)}}},[t("BaseVueQuery",{attrs:{query:e.scorecards},scopedSlots:e._u([{key:"success",fn:function(r){var o=r.data;return[t("ConvertScorecardsInput",{attrs:{id:e.id,scorecards:o},model:{value:e.fileZip,callback:function(i){e.fileZip=i},expression:"fileZip"}})]}}])}),t("BaseButton",{staticClass:"space-x-2",attrs:{disabled:e.isDisabled}},[e.isLoading?t("LoadingSpinner"):[t("DocumentDownloadSvg",{staticClass:"w-4 xl:w-5"}),t("span",[e._v("Convert")])]],2)],1)])},ve=[];const I={};var _e=w(h,fe,ve,!1,ye,null,null,null);function ye(e){for(let s in I)this[s]=I[s]}const Ae=function(){return _e.exports}();export{Ae as default};
