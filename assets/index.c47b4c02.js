import{c as a,n as x,cy as X,bo as J,aU as K,aG as Y,aV as Z,c1 as H,cC as ee,a_ as j,cD as te,cE as se,b as ne,r as U,L as ae,c8 as re,b$ as oe}from"./index.5ed56dd7.js";import{a as ie}from"./index.ebbce841.js";import{T as ce}from"./ToolTip.bcd7f4ef.js";import{s as le}from"./index.5ae6306c.js";const M={};M.props={score:{key:"score",required:!0,type:Number},max:{key:"max",required:!0,type:Number}};M.setup=(e,n)=>{const t=e,r=a(()=>200-t.score/t.max*200),c=a(()=>`gradient-${Math.random()}`),l=a(()=>t.score>=740?"#10b981":t.score>=640?"#fde68a":"#ef4444");return{fill:r,gradientId:c,displayColor:l}};var ue=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("svg",{attrs:{viewBox:"0 0 90 80",preserveAspectRatio:"none"}},[t("defs",[t("linearGradient",{attrs:{id:`${e.gradientId}`,x1:"15%",y1:"100%",x2:"80%",y2:"100%"}},[t("stop",{attrs:{offset:"0%","stop-color":`${e.displayColor}`}}),t("stop",{attrs:{offset:"100%","stop-color":`${e.displayColor}`}})],1)],1),t("path",{staticClass:"stroke-current text-gray-200 shadow-inner",attrs:{d:"M20,75 a40,40,0,1,1,50,0",fill:"none","stroke-linecap":"round","stroke-width":"3"}}),t("path",{staticClass:"filling transition duration-300",style:`--fill: ${e.fill}`,attrs:{d:"M20,75 a40,40,0,1,1,50,0",fill:"none",stroke:`url(#${e.gradientId})`,"stroke-dasharray":"200","stroke-dashoffset":"200","stroke-linecap":"round","stroke-width":"3"}})])},ve=[];const O={};var pe=x(M,ue,ve,!1,_e,"62ebebb3",null,null);function _e(e){for(let n in O)this[n]=O[n]}const de=function(){return pe.exports}(),C={};C.props={score:{key:"score",required:!0,type:Number},max:{key:"max",required:!0,type:Number}};C.setup=(e,n)=>{const t=e;return{percentage:a(()=>ie(Math.round(t.score*100/t.max)))}};C.components=Object.assign({QuestionnaireProgressBar:de},C.components);var fe=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"relative flex items-center justify-center p-4"},[t("div",{staticClass:"absolute flex items-center"},[t("BaseTypography",{staticClass:"text-blue-800",attrs:{variant:"h2"}},[e._v(" "+e._s(e.percentage)+" ")])],1),t("div",{staticClass:"relative w-44 sm:w-56"},[t("QuestionnaireProgressBar",{attrs:{score:e.score,max:e.max}})],1)])},me=[];const A={};var xe=x(C,fe,me,!1,ye,null,null,null);function ye(e){for(let n in A)this[n]=A[n]}const V=function(){return xe.exports}(),w={};w.props={score:{key:"score",required:!0,type:Number},max:{key:"max",required:!0,type:Number}};w.setup=(e,n)=>({});w.components=Object.assign({DotsSquare:X,QuestionnaireProgressBarText:V},w.components);var ge=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"relative mx-auto flex max-w-xs flex-col items-center justify-center overflow-hidden rounded-xl bg-gradient-to-br from-blue-100 via-white to-white px-4 py-8 shadow-md sm:max-w-sm sm:rounded-3xl xl:max-w-none xl:p-12"},[t("div",{staticClass:"absolute top-full left-full -translate-y-1/3 -translate-x-1/3 rotate-45 transform xl:-translate-y-1/2"},[t("DotsSquare",{attrs:{color:"blue"}})],1),t("QuestionnaireProgressBarText",{attrs:{score:e.score,max:e.max}})],1)},he=[];const F={};var $e=x(w,ge,he,!1,Se,null,null,null);function Se(e){for(let n in F)this[n]=F[n]}const Ce=function(){return $e.exports}(),q={};q.props={value:{key:"value",required:!0,type:null}};q.setup=(e,n)=>({});q.components=Object.assign({WaveForm:J,QuestionnaireScoreDisplay:Ce},q.components);var we=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"relative flex flex-col items-center justify-center lg:grid lg:grid-cols-12"},[t("div",{staticClass:"absolute top-36 w-full opacity-25 sm:top-40 lg:hidden"},[t("WaveForm")],1),t("div",{staticClass:"relative -mb-36 lg:col-span-4 lg:col-start-1 lg:row-start-1 lg:mb-0"},[t("div",{staticClass:"px-6 md:px-8 lg:px-4 lg:pl-0"},[t("QuestionnaireScoreDisplay",{attrs:{score:e.value.score,max:e.value.max}})],1)]),t("BaseSimpleCard",{staticClass:"pt-32 lg:col-span-10 lg:col-start-3 lg:row-start-1 lg:h-fit lg:p-0"},[t("div",{staticClass:"grid items-center gap-5 px-6 py-10 sm:p-8 lg:grid-cols-10 lg:col-start-3 lg:gap-0 lg:p-6 text-center lg:text-left"},[t("div",{staticClass:"grid gap-5 lg:col-span-10 lg:col-start-3"},[t("BaseTypography",{staticClass:"text-prime-navy",attrs:{component:"h2",variant:"h5"}},[e._v(" "+e._s(e.value.title)+" ")]),t("BaseTypography",{staticClass:"text-gray-600",attrs:{component:"p",variant:"p1"}},[e._v(" "+e._s(e.value.description)+" ")])],1)])])],1)},qe=[];const D={};var Te=x(q,we,qe,!1,be,null,null,null);function be(e){for(let n in D)this[n]=D[n]}const ke=function(){return Te.exports}(),L="active-questionnaire",B=K(L,()=>{const e=Y(),n=a(()=>{var s;return(s=e.company)==null?void 0:s.id}),t=Z(`${L}.chosenQuestionnaireId`,null,{deep:!1,serializer:se.string}),r=a({get(){return t.value||e.mainQuestionnaireId},set(s){s&&(t.value=s)}}),c=H.read(r),l=a(()=>c.data.value),f=ee.list(n),v=le(a(()=>{var s,i,o;return(o=(i=(s=f.data.value)==null?void 0:s.find(p=>{var _;return((_=p.questionnaireId)==null?void 0:_.value)===r.value}))==null?void 0:i.id)==null?void 0:o.value})),d=j(0),u=j(0),g=te.list(v),h=a(()=>g.data.value||[]),y=a(()=>{var i;const s=new Map;return(i=l.value)==null||i.sections.forEach(o=>{const p=[];if(o.questions.forEach(_=>{_.answerSet&&_.answerSet.answers&&_.answerSet.answers.forEach(m=>{var S,R;((S=m.id)==null?void 0:S.value)===((R=_.id)==null?void 0:R.value)&&p.push(m.riskScore)})}),o.id){const _=p.reduce((m,S)=>m+S,0);s.has(o.id.value)||s.set(o.id.value,_)}}),s}),$=a(()=>{var i;const s=new Map;return(i=l.value)==null||i.sections.forEach(o=>{const p=[];if(o.questions.forEach(_=>{_.answerSet&&_.answerSet.answers.forEach(m=>p.push(m.riskScore))}),o.id){const _=p.reduce((m,S)=>m+S,0);s.has(o.id.value)||s.set(o.id.value,_)}}),s}),I=a(()=>{var s;return(s=l.value)==null?void 0:s.sections[d.value]});return{questionnaireId:r,questionnaire:l,sectionIndex:d,questionIndex:u,takenId:v,answers:h,sectionTotals:y,sectionMaxes:$,currentSection:I,currentQuestion:a(()=>{var s;return(s=I.value)==null?void 0:s.questions[u.value]}),totalSections:a(()=>{var s;return(s=l.value)==null?void 0:s.sections.length}),totalQuestions:a(()=>{var i;const s=[];return(i=l.value)==null||i.sections.forEach(o=>{s.push(o.questions.length)}),s.reduce((o,p)=>o+p,0)}),riskScoreTotal:a(()=>{let s=0;return h.value.forEach(i=>{Array.isArray(i)&&i.forEach(o=>{o.riskScore&&(s=s+o.riskScore)}),s=s+i.riskScore}),s}),riskScoreMax:a(()=>{var i;let s=0;return(i=l.value)==null||i.sections.forEach(o=>{o.questions.forEach(p=>{p.answerSet&&p.answerSet.answers.forEach(m=>s=s+m.riskScore)})}),s}),sectionTotal(s){return y.value.get(s)||0},sectionMax(s){return $.value.get(s)||0},sectionPercentage(s){const i=y.value.get(s)||0,o=$.value.get(s)||0;return Math.round(i*100/o)},questionScore(s){let i=0;return h.value.forEach(o=>{var p;((p=o.questionId)==null?void 0:p.value)===s&&(i=i+o.riskScore)}),i},setSectionIndex(s){d.value=s},setQuestionIndex(s){u.value=s},setQuestionnaireId(s){r.value=s},setTakenId(s){v.value=s},clearData(){d.value=0,u.value=0,r.value=void 0,v.value=void 0}}}),T={};T.props={question:{key:"question",required:!0,type:null},index:{key:"index",required:!0,type:Number}};T.setup=(e,n)=>{const t=e,r=a(()=>{var u;return(u=t.question.id)==null?void 0:u.value}),c=B(),l=a(()=>r.value?c.questionScore(r.value):0),f=a(()=>{var g;const u=(g=t.question.answerSet)==null?void 0:g.answers.find(h=>{var y;return((y=h.id)==null?void 0:y.value)===r.value});if(u)return u.value}),v=a(()=>Boolean(l.value||f.value)),d=a(()=>v.value?{type:"info",text:f.value}:{type:"warn",text:"This question has not been answered yet."});return{score:l,text:f,toolTipInfo:d}};T.components=Object.assign({ToolTip:ce},T.components);var Qe=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"flex items-center justify-between p-4"},[t("div",{staticClass:"flex items-center space-x-4"},[t("BaseLink",{attrs:{"display-type":"primary-prime",to:"#"}},[e._v(" "+e._s(`Question ${e.index+1}`)+" ")]),t("ToolTip",{attrs:{type:e.toolTipInfo.type}},[e._v(" "+e._s(e.toolTipInfo.text)+" ")])],1),t("div",[e.question.questionType!=="TEXTAREA"?t("BaseTypography",{staticClass:"text-gray-500",attrs:{variant:"p1"}},[e._v(" "+e._s(`Score: ${e.score}`)+" ")]):t("BaseTypography",{staticClass:"text-gray-500",attrs:{variant:"p1"}},[e._v(" "+e._s(`Response: ${e.text}`)+" ")])],1)])},Ee=[];const P={};var Be=x(T,Qe,Ee,!1,Ie,null,null,null);function Ie(e){for(let n in P)this[n]=P[n]}const Me=function(){return Be.exports}(),b={};b.props={section:{key:"section",required:!0,type:null}};b.setup=(e,n)=>{const t=e,r=a(()=>{var d;return(d=t.section.id)==null?void 0:d.value}),c=B(),l=a(()=>r.value&&c.sectionTotal(r.value)||0),f=a(()=>r.value&&c.sectionMax(r.value)||0),v=a(()=>t.section.questions);return{total:l,max:f,questions:v}};b.components=Object.assign({QuestionnaireProgressBarText:V,QuestionOverview:Me},b.components);var Re=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"flex flex-col divide-y"},[t("QuestionnaireProgressBarText",{attrs:{score:e.total,max:e.max}}),t("ul",{staticClass:"divide-y"},e._l(e.questions,function(r,c){return t("li",{key:c},[t("QuestionOverview",{attrs:{question:r,index:c}})],1)}),0)],1)},je=[];const N={};var Oe=x(b,Re,je,!1,Ae,null,null,null);function Ae(e){for(let n in N)this[n]=N[n]}const Fe=function(){return Oe.exports}(),k={};k.props={section:{key:"section",required:!0,type:null}};k.setup=(e,n)=>{const t=e,r=U(!1),c=a(()=>{var d;return(d=t.section.id)==null?void 0:d.value}),l=B(),f=a(()=>{if(c.value)return l.sectionTotal(c.value)}),v=a(()=>{if(c.value)return l.sectionMax(c.value)});return{isExpanded:r,total:f,max:v}};k.components=Object.assign({ToggleButton:ne,SectionDetails:Fe},k.components);var De=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"flex flex-col space-y-2 my-1"},[t("div",{staticClass:"flex flex-col items-start -space-y-1"},[t("BaseTypography",{staticClass:"text-gray-500",attrs:{variant:"overline"}},[e._v(" "+e._s(e.section.questions.length)+" Questions ")]),t("ToggleButton",{scopedSlots:e._u([{key:"text",fn:function(){return[t("BaseTypography",{staticClass:"text-prime-navy",attrs:{variant:"h6"}},[e._v(" "+e._s(e.section.name)+" ")])]},proxy:!0}]),model:{value:e.isExpanded,callback:function(r){e.isExpanded=r},expression:"isExpanded"}})],1),t("BaseSimpleCard",[t("div",{staticClass:"grid gap-4 grid-cols-2 sm:gap-6 items-center p-4"},[t("div",{staticClass:"col-span-1 flex flex-col items-center"},[t("BaseTypography",{staticClass:"text-gray-500",attrs:{variant:"p1"}},[e._v(" Total Score ")]),t("BaseTypography",{staticClass:"text-prime-indigo",attrs:{variant:"h2"}},[e._v(" "+e._s(e.total)+" ")])],1),t("div",{staticClass:"col-span-1 flex flex-col items-center"},[t("BaseTypography",{staticClass:"text-gray-500",attrs:{variant:"p1"}},[e._v(" Max Score ")]),t("BaseTypography",{staticClass:"text-prime-indigo",attrs:{variant:"h2"}},[e._v(" "+e._s(e.max)+" ")])],1)]),e.isExpanded?t("SectionDetails",{attrs:{section:e.section}}):e._e()],1)],1)},Le=[];const z={};var Pe=x(k,De,Le,!1,Ne,null,null,null);function Ne(e){for(let n in z)this[n]=z[n]}const ze=function(){return Pe.exports}(),Q={};Q.props={value:{key:"value",required:!0,type:null}};Q.setup=(e,n)=>{const t=e,r=a(()=>t.value),c=B(),l=a(()=>({title:"Total Score / Overview",description:"Lorem ipsum dolor sit amet consectetur, adipisicing elit. Veritatis saepe ullam laborum accusantium itaque, enim commodinumquam incidunt, id autem pariatur sit ut qui libero eos amet molestias inventore ab.",score:c.riskScoreTotal,max:c.riskScoreMax})),f=a(()=>{var u;return(u=r.value)==null?void 0:u.sections}),v=U(!1);function d(u){const g=u.currentTarget,y=u.srcElement.offsetHeight,$=g.scrollTop,s=g.scrollHeight-$;if(s===y){v.value=!0;return}else if(s===$){v.value=!1;return}v.value=!1}return{overview:l,sections:f,atBottom:v,handleScroll:d}};Q.components=Object.assign({QuestionnaireSummaryOverview:ke,SectionOverview:ze},Q.components);var We=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("section",{staticClass:"space-y-8"},[t("QuestionnaireSummaryOverview",{attrs:{value:e.overview}}),t("div",{staticClass:"grid gap-4 h-120 space-y-8 overflow-y-scroll",class:[{"fade-bottom":!e.atBottom}],on:{scroll:e.handleScroll}},e._l(e.sections,function(r,c){return t("div",{key:c,staticClass:"flex items-center"},[t("SectionOverview",{attrs:{section:r}})],1)}),0)],1)},Ge=[];const W={};var He=x(Q,We,Ge,!1,Ue,"c90878e6",null,null);function Ue(e){for(let n in W)this[n]=W[n]}const Ve=function(){return He.exports}(),E={};E.setup=(e,n)=>{const t=re("questionnaireId"),r=H.read(t),c=a(()=>r.data.value||oe.CustomQuestionnaire.create());return{questionnaireRead:r,questionnaire:c}};E.components=Object.assign({LoadingSpinner:ae,QuestionnaireReview:Ve},E.components);var Xe=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("section",[e.questionnaireRead.isLoading.value?t("LoadingSpinner"):t("div",{staticClass:"space-y-6"},[t("BaseTypography",{attrs:{variant:"h5",component:"h2"}},[e._v(" Review Questionnaire ")]),t("QuestionnaireReview",{attrs:{value:e.questionnaire}})],1)],1)},Je=[];const G={};var Ke=x(E,Xe,Je,!1,Ye,null,null,null);function Ye(e){for(let n in G)this[n]=G[n]}const nt=function(){return Ke.exports}();export{nt as default};
