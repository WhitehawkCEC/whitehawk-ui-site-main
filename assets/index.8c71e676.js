import{R as q}from"./arrow-path.24b87f73.js";import{c as a,aS as O,n as h,L as w,aF as V,cF as L,cG as K,cH as M,cI as N,cJ as G,b$ as H,cK as Y,cL as z,cM as J}from"./index.1f71e50f.js";import{A as P}from"./AppTanStackTable.99a49d86.js";import{S as T,V as U,p as A,a as Q}from"./SyncStatusDisplay.42712efd.js";import{c as W}from"./createOnChangeFn.0c048202.js";import{u as X}from"./createSimpleTable.f43bc837.js";import"./magnifying-glass.b7cbe8fe.js";import"./TransitionExpand.861d9b26.js";import"./check-circle.48e4a9f5.js";import"./chevron-up.736f4142.js";const k={};k.props={value:{key:"value",required:!0,type:Array}};k.setup=(e,s)=>{const n=e,m=a(()=>n.value),i=W(),u=[i.accessor("toBeSynced",{header:()=>"To Be Synced",cell:c=>O(T,{props:{value:c.getValue()}}),enableColumnFilter:!1}),i.group({id:"supplier",header:()=>"Supplier",columns:[i.accessor(c=>c.supplier.name,{id:"name",header:()=>"Name",enableColumnFilter:!1}),i.accessor(c=>c.supplier.domain,{id:"domain",header:()=>"Domain",enableColumnFilter:!1})]}),i.accessor("syncedFromBlackKite",{header:()=>"Synced From Black Kite?",cell:c=>O(T,{props:{value:c.getValue()}}),enableColumnFilter:!1}),i.accessor("syncedFromCyberOne",{header:()=>"Synced From CyberOne?",cell:c=>O(T,{props:{value:c.getValue()}}),enableColumnFilter:!1})];return{instance:X(m,u)}};k.components=Object.assign({AppTanStackTable:P},k.components);var Z=function(){var e=this,s=e.$createElement,n=e._self._c||s;return n("AppTanStackTable",{attrs:{table:e.instance}})},ee=[];const B={};var te=h(k,Z,ee,!1,ne,null,null,null);function ne(e){for(let s in B)this[s]=B[s]}const se=function(){return te.exports}(),I={};I.props={accountId:{key:"accountId",required:!0,type:String},vrmSync:{key:"vrmSync",required:!0,type:null},assets:{key:"assets",required:!0,type:Array},entities:{key:"entities",required:!0,type:Array}};I.setup=(e,s)=>{const n=e,m=a(()=>n.accountId),i=a(()=>{const t=n.entities.filter(o=>o.domain);return $(t,f)}),u=a(()=>i.value.map(({domain:t})=>A(t))),b=a(()=>i.value.map(t=>({id:t.id.toString(),name:t.name,domain:t.domain}))),c=a(()=>{const t=n.assets.filter(o=>o.domain);return $(t,j)}),g=a(()=>c.value.map(t=>A(t.domain))),v=a(()=>c.value.map(t=>({id:t.referenceId,name:t.name,domain:A(t.domain)}))),C=a(()=>[...b.value,...v.value]),y=a(()=>C.value.map(t=>{var o,d;return{supplier:{blackKiteId:(o=C.value.find(_=>_.id===t.id))==null?void 0:o.id,cyberOneId:(d=v.value.find(_=>_.id===t.id))==null?void 0:d.id,name:t.name,domain:t.domain},syncedFromBlackKite:u.value.includes(t.domain),syncedFromCyberOne:g.value.includes(t.domain),toBeSynced:u.value.includes(t.domain)&&g.value.includes(t.domain)}})),S=a(()=>{const t=[];return y.value.forEach(o=>{if(o.toBeSynced){const{blackKiteId:d,cyberOneId:_}=o.supplier;d&&_&&t.push({target:{oneofKind:"cyberOneAssetId",cyberOneAssetId:_},source:{oneofKind:"blackKiteEntityId",blackKiteEntityId:parseInt(d)}})}}),t}),r=V(),l=L.create(m);async function p(){const t={syncType:K.SyncType.BLACK_KITE_TO_CYBER_ONE,entries:S.value},o=await l.mutateAsync(t);if(o){const d=o.response.syncId;r.success(`Sync ID: ${d}`)}}function f(t){return t!==void 0}function j(t){return t!==void 0}function $(t,o){const d=[];return t.forEach(_=>{o(_)&&d.push(_)}),d}return{rows:y,mappings:S,syncCreate:l,createSync:p}};I.components=Object.assign({VrmSyncStatusDisplay:U,LoadingSpinner:w,SyncSvg:q,CyberRiskRatingSyncTable:se},I.components);var ae=function(){var e=this,s=e.$createElement,n=e._self._c||s;return n("section",{staticClass:"space-y-6"},[n("div",{staticClass:"flex flex-col space-y-4 md:flex-row md:items-center md:justify-between md:space-y-0"},[n("VrmSyncStatusDisplay",{attrs:{header:"Cyber Risk Rating Sync",sync:e.vrmSync}}),n("BaseButton",{staticClass:"space-x-1",attrs:{disabled:e.mappings.length===0,shape:"rectangle"},on:{click:e.createSync}},[e.syncCreate.isLoading.value?n("LoadingSpinner"):n("SyncSvg",{staticClass:"w-4 xl:w-5"}),n("span",[e._v("Sync")])],1)],1),n("CyberRiskRatingSyncTable",{attrs:{value:e.rows}})],1)},ce=[];const x={};var re=h(I,ae,ce,!1,oe,null,null,null);function oe(e){for(let s in x)this[s]=x[s]}const ie=function(){return re.exports}(),R={};R.props={accountId:{key:"accountId",required:!0,type:String},syncType:{key:"syncType",required:!0,type:null},mappedEcosystem:{key:"mappedEcosystem",required:!1,type:Number}};R.setup=(e,s)=>{const n=e,m=a(()=>n.accountId),i=M.get(m),u=a(()=>i.data.value),b=N.get(m),c=a(()=>{var y;return(y=b.data.value)==null?void 0:y.mappedAssetId}),g=G.get(m),v=a(()=>g.data.value);return{syncStatus:a(()=>{var y,S,r,l,p,f;return{source:{mappedSource:n.mappedEcosystem,syncDate:(S=(y=u.value)==null?void 0:y.lastSynced)==null?void 0:S.value,syncedReports:(r=u.value)==null?void 0:r.reportsSynced},target:{mappedTarget:c.value,syncDate:(p=(l=v.value)==null?void 0:l.lastSynced)==null?void 0:p.value,syncedReports:(f=v.value)==null?void 0:f.reportsSynced}}})}};R.components=Object.assign({SyncStatusDisplay:Q},R.components);var le=function(){var e=this,s=e.$createElement,n=e._self._c||s;return n("SyncStatusDisplay",{attrs:{"sync-status":e.syncStatus,"sync-type":e.syncType}})},ue=[];const F={};var ye=h(R,le,ue,!1,pe,null,null,null);function pe(e){for(let s in F)this[s]=F[s]}const de=function(){return ye.exports}(),E={};E.setup=(e,s)=>{const n=H("id"),m=Y.get(n),i=a(()=>{var r;return(r=m.data.value)==null?void 0:r.mappedEcosystemId}),u=L.list(n),b=a(()=>u.data.value?u.data.value.sort((r,l)=>{let p="",f="";return r.lastSynced&&r.lastSynced.value&&l.lastSynced&&l.lastSynced.value&&(p=r.lastSynced.value,f=l.lastSynced.value),p.localeCompare(f)}):[]),c=a(()=>b.value.find(r=>r.syncType===K.SyncType.BLACK_KITE_TO_CYBER_ONE)),g=z.list(n),v=a(()=>g.data.value||[]),C=J.list(n),y=a(()=>C.data.value||[]),S=a(()=>{var r,l,p;return{syncDate:(l=(r=c.value)==null?void 0:r.lastSynced)==null?void 0:l.value,syncedReports:(p=c.value)==null?void 0:p.numSynced}});return{SyncType:K.SyncType,id:n,mappedEcosystem:i,entities:v,assets:y,sync:S}};E.components=Object.assign({CyberRiskRatingSyncStatusDisplay:de,CyberRiskRatingSyncDisplay:ie},E.components);var me=function(){var e=this,s=e.$createElement,n=e._self._c||s;return n("main",{staticClass:"space-y-6"},[n("CyberRiskRatingSyncStatusDisplay",{attrs:{"account-id":e.id,"sync-type":e.SyncType.BLACK_KITE_TO_CYBER_ONE,"mapped-ecosystem":e.mappedEcosystem}}),n("CyberRiskRatingSyncDisplay",{attrs:{"account-id":e.id,"vrm-sync":e.sync,entities:e.entities,assets:e.assets}})],1)},_e=[];const D={};var ve=h(E,me,_e,!1,Se,null,null,null);function Se(e){for(let s in D)this[s]=D[s]}const Te=function(){return ve.exports}();export{Te as default};
