import{ag as x,aP as k,aQ as B,c as d,n as f,bs as w,b$ as v,d9 as T,da as $}from"./index.27ed0010.js";import{T as M}from"./ToolTip.254220f9.js";import{B as S}from"./BlackKiteReportCompliance.71279be6.js";import{b as R}from"./BlackKiteProgressBar.ce1ec42f.js";import{B as K,a as D}from"./BlackKiteSummaryDescription.58aa88df.js";import{T as A}from"./TodosChart.c282d784.js";import{C as H}from"./CmmcAnalysisDisplay.36e40082.js";import"./exclamation-triangle.54812a62.js";import"./GradeLetterDisplay.ee548760.js";import"./ratingScoreDescription.3b48b1ea.js";import"./TabbedPanel.487d26f7.js";import"./BarChart.9b70e18d.js";import"./chart.f4078cab.js";import"./_baseOrderBy.4f11e8c1.js";import"./_arrayMap.dcea68f3.js";import"./_baseIteratee.1a2c63b8.js";import"./_Uint8Array.bc1a21c9.js";import"./keys.f914114b.js";import"./_baseIsEqual.081e48ea.js";import"./_baseEach.8eecc804.js";const j={list(e,a){return x(["companies",e,"black-kite","entities",a,"performance"],()=>k.get(`${B}/companies/${e.value}/black-kite/entities/${a.value}/performance`).then(t=>t.data))}},_={};_.props={findings:{key:"findings",required:!0,type:null}};_.setup=(e,a)=>{const t=e,r=d(()=>["Critical","High","Medium","Low"]),s=d(()=>{const i=new Map;for(const p of Object.entries(t.findings)){const[n,c]=p,u=n.split(/(?=[A-Z])/)[0];if(u){const y=i.get(u);y?y.push({key:n,value:c}):i.set(u,[{key:n,value:c}])}}return i}),l=d(()=>[{header:"Failed",data:s.value.get("failed")||[]},{header:"Warning",data:s.value.get("warning")||[]},{header:"Passed",data:s.value.get("passed")||[]}]);function o(i){switch(i){case"failedCritical":return{bgColor:"bg-red-800",textColor:"text-red-100"};case"failedHigh":return{bgColor:"bg-red-700",textColor:"text-red-100"};case"failedMedium":return{bgColor:"bg-red-600",textColor:"text-red-100"};case"failedLow":return{bgColor:"bg-red-500",textColor:"text-red-100"};case"warningCritical":return{bgColor:"bg-yellow-800",textColor:"text-yellow-100"};case"warningHigh":return{bgColor:"bg-yellow-700",textColor:"text-yellow-100"};case"warningMedium":return{bgColor:"bg-yellow-600",textColor:"text-yellow-100"};case"warningLow":return{bgColor:"bg-yellow-500",textColor:"text-yellow-100"};case"passedCritical":return{bgColor:"bg-green-800",textColor:"text-green-100"};case"passedHigh":return{bgColor:"bg-green-700",textColor:"text-green-100"};case"passedMedium":return{bgColor:"bg-green-600",textColor:"text-green-100"};case"passedLow":return{bgColor:"bg-green-500",textColor:"text-green-100"};default:return{bgColor:"bg-gray-500",textColor:"text-white"}}}return{headers:r,rows:l,display:o}};var F=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("section",{staticClass:"overflow-x-auto pr-4 pb-4"},[t("table",{staticClass:"w-full text-center sm:table-fixed md:table-auto lg:table-fixed"},[t("thead",[t("tr",[t("td"),e._l(e.headers,function(r){return t("th",{key:r,staticClass:"px-4 py-2 text-center",attrs:{scope:"col",colspan:"1"}},[t("BaseTypography",{staticClass:"uppercase text-gray-700",attrs:{variant:"overline"}},[e._v(" "+e._s(r)+" ")])],1)})],2)]),t("tbody",e._l(e.rows,function(r){return t("tr",{key:r.header},[t("th",{staticClass:"px-4 py-2",attrs:{scope:"row"}},[t("BaseTypography",{staticClass:"uppercase text-gray-700",attrs:{variant:"overline"}},[e._v(" "+e._s(r.header)+" ")])],1),e._l(r.data,function(s){return t("td",{key:s.key},[t("span",{staticClass:"flex flex-col space-y-1 rounded-xl p-4",class:e.display(s.key).bgColor},[t("BaseTypography",{class:e.display(s.key).textColor,attrs:{variant:"h3",component:"h6"}},[e._v(" "+e._s(s.value||"?")+" ")])],1)])})],2)}),0)])])},L=[];const C={};var O=f(_,F,L,!1,q,null,null,null);function q(e){for(let a in C)this[a]=C[a]}const I=function(){return O.exports}(),m={};m.props={id:{key:"id",required:!0,type:String},value:{key:"value",required:!0,type:Array}};m.setup=(e,a)=>{const t=e,r=d(()=>t.id),s=d(()=>{var i;const o={};for(const p of t.value){const{control:{number:n,description:c,type:u},isSatisfied:y}=p;u in o||(o[u]=[]),(i=o[u])==null||i.push({id:n,itemComplete:y,todoText:c})}for(const p of Object.values(o))p.sort((n,c)=>Number(n.id)-Number(c.id));return o});return{companyId:r,chartData:s,categories:["basic","foundational","organizational"]}};m.components=Object.assign({TodosChart:A},m.components);var P=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("TodosChart",{attrs:{value:e.chartData,"company-id":e.companyId,categories:e.categories,"can-add-notes":!1}})},Q=[];const h={};var z=f(m,P,Q,!1,E,null,null,null);function E(e){for(let a in h)this[a]=h[a]}const V=function(){return z.exports}(),g={};g.setup=(e,a)=>{const t=v("id"),r=v("entityId"),s=j.list(t,r),l=T.get(t),o=d(()=>{var i;return((i=l.data.value)==null?void 0:i.findings)||$.Findings.create()});return{id:t,performanceQuery:s,findings:o}};g.components=Object.assign({BackButton:w,BlackKiteSummaryDescription:K,BlackKiteReportSummary:D,BlackKiteReportRisk:R,BlackKiteReportCompliance:S,CisMaturityDisplay:V,ToolTip:M,CmmcAnalysisDisplay:H,BlackKiteHeatmap:I},g.components);var G=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("BaseVueQuery",{attrs:{query:e.performanceQuery},scopedSlots:e._u([{key:"success",fn:function(r){var s=r.data,l=s.reports,o=l.summary,i=l.risk,p=l.compliance,n=s.cmmcAnalysis,c=s.cisMaturity;return[t("section",{staticClass:"space-y-8"},[t("div",{staticClass:"flex flex-col sm:flex-row sm:items-center sm:space-x-4"},[t("BackButton"),t("BaseTypography",{staticClass:"capitalize",attrs:{variant:"h5",component:"h2"}},[e._v(" "+e._s(o.DomainValue)+" ")])],1),t("BaseSimpleCard",{staticClass:"divide-y"},[t("BaseTypography",{staticClass:"p-4",attrs:{component:"h3",variant:"subtitle3"}},[e._v(" Summary ")]),t("BlackKiteSummaryDescription",{attrs:{score:parseInt(o.GradeOver100),date:o.LastUpdatedAt}}),t("BlackKiteReportSummary",{attrs:{summary:o}})],1),t("BaseSimpleCard",{staticClass:"divide-y"},[t("BaseTypography",{staticClass:"p-4",attrs:{component:"h3",variant:"subtitle3"}},[e._v(" Risk ")]),t("BlackKiteReportRisk",{attrs:{risk:i}})],1),t("BaseSimpleCard",{staticClass:"divide-y"},[t("BaseTypography",{staticClass:"p-4",attrs:{component:"h3",variant:"subtitle3"}},[e._v(" Compliance ")]),t("BlackKiteReportCompliance",{attrs:{compliance:p}})],1),t("BaseSimpleCard",{staticClass:"divide-y"},[t("BaseTypography",{staticClass:"p-4",attrs:{component:"h3",variant:"subtitle3"}},[e._v(" CIS Maturity ")]),t("CisMaturityDisplay",{attrs:{id:e.id,value:c}})],1),t("div",{staticClass:"space-y-2"},[t("div",{staticClass:"flex items-start space-x-2"},[t("BaseTypography",{attrs:{component:"h3",variant:"subtitle3"}},[e._v(" CMMC Analysis ")]),t("ToolTip",[e._v(" WhiteHawk is aware of the ongoing changes to CMMC and will update our offerings accordingly as the Office of the Secretary of Defense publishes their updated guidance and timelines between now and 2nd quarter 2023. ")])],1),t("CmmcAnalysisDisplay",{attrs:{value:n}})],1),t("BaseSimpleCard",{staticClass:"divide-y"},[t("div",{staticClass:"flex items-center space-x-2 p-4"},[t("BaseTypography",{attrs:{component:"h3",variant:"subtitle3"}},[e._v(" Vulnerability Heat Map ")]),t("ToolTip",[e._v(" This heat map is the graphical distribution of vulnerabilities where the status and the severity of each finding are represented as the total number in each cell. Please note that 'Leaked Credentials' are represented as 1 (even if there are thousands) in order not to skew the chart. ")])],1),t("BlackKiteHeatmap",{attrs:{findings:e.findings}})],1)],1)]}}])})},N=[];const b={};var U=f(g,G,N,!1,W,null,null,null);function W(e){for(let a in b)this[a]=b[a]}const ft=function(){return U.exports}();export{ft as default};
