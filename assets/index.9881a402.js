import{bs as Q,L as R,c7 as g,du as T,b as B,bG as C,d as m,dn as _,aK as D,n as M}from"./index.99dc92dd.js";import{B as V}from"./BatchScorecardInputV3.9c41fb04.js";import{u as $}from"./useCompanyScorecardTemplates.27154aaa.js";import{u as A}from"./useScorecardTemplates.653bfcc7.js";import{u as G}from"./useBlackKiteEntities.3f757dd8.js";import{u as O}from"./useUsers.35a98700.js";import{e as c}from"./attributeValue.ea53a720.js";import{t as P}from"./index.e83bde32.js";import"./StatusInput.8278f3cc.js";import"./ToolTip.a7d4f125.js";import"./ObjectDisplay.51649e6f.js";import"./DynamicForm.24a2e82b.js";const p={};p.setup=(t,i)=>{const e=g("id"),r=g("subscriptionId"),d=T.create(e,r),v=B(!1),f=[C.list(),G.list(e),A.list()],o=$.get(e),b=O.list(),x=m(()=>{var n;return(n=b.data.value)==null?void 0:n.map(s=>({id:{value:c(s,"sub")},name:c(s,"name")||"",title:c(s,"custom:title")||"",email:c(s,"email"),phone:c(s,"phone_number")||""})).find(s=>s.email==="consultingservices@whitehawk.com")}),h=C.read(e),w=m(()=>{if(h.data.value)return{id:{value:h.data.value.id},name:h.data.value.name}}),y=B(),a=m({get(){var u;if(y.value)return y.value;const n=new Date,s=n.getUTCFullYear(),l=`Q${Math.ceil((n.getMonth()+1)/4)}`;return{id:e,company:w.value,analyst:x.value,template:((u=o.data.value)==null?void 0:u.split("/")[1])||"",status:{state:_.State.IN_PROGRESS,year:s,quarter:P(l)},includeCmmc:!0,entities:[]}},set(n){y.value=n}}),k=m(()=>a.value?!(a.value.entities.length>0&&a.value.analyst&&a.value.company&&a.value.status&&a.value.template):!0),q=D();async function E(){var n,s,l,u;if(a.value){const I={company:a.value.company,analyst:(n=a.value)==null?void 0:n.analyst,status:{year:2023,quarter:_.Quarter.Q1,state:_.State.COMPLETE},includeCmmc:(s=a.value)==null?void 0:s.includeCmmc,template:a.value.template,entities:(l=a.value)==null?void 0:l.entities},{response:L}=await d.mutateAsync(I);(u=L.batchId)!=null&&u.value&&q.push(`/admin/companies/${e.value}/subscriptions/${r.value}/integrations/2/batch`)}}return{isLoading:v,queries:f,users:b,batch:a,isDisabled:k,generate:E}};p.components=Object.assign({BackButton:Q,BatchScorecardInputV3:V,LoadingSpinner:R},p.components);var j=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"space-y-6"},[e("div",{staticClass:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4"},[e("BackButton"),e("BaseTypography",{attrs:{variant:"h5",component:"h2"}},[t._v(" Create New Batch ")])],1),e("BaseSimpleCard",[e("BaseVueQueries",{attrs:{queries:t.queries},scopedSlots:t._u([{key:"success",fn:function(r){var d=r[0],v=r[1],f=r[2];return[e("form",{staticClass:"divide-y",on:{submit:function(o){return o.preventDefault(),t.generate.apply(null,arguments)}}},[e("BatchScorecardInputV3",{attrs:{users:t.users.data.value||[],companies:d,entities:v,templates:f},model:{value:t.batch,callback:function(o){t.batch=o},expression:"batch"}}),e("div",{staticClass:"p-4"},[e("BaseButton",{staticClass:"w-full md:w-auto",attrs:{disabled:t.isDisabled}},[t.isLoading?e("LoadingSpinner"):e("span",[t._v("Generate Batch")])],1)],1)],1)]}}])})],1)],1)},F=[];const S={};var K=M(p,j,F,!1,N,null,null,null);function N(t){for(let i in S)this[i]=S[i]}const ne=function(){return K.exports}();export{ne as default};
