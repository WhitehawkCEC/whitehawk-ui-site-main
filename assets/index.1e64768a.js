import{c as p,aS as k,n as x,bk as w,bt as E,aP as M,aQ as R}from"./index.f7cfba02.js";import{A as F}from"./AppTanStackTable.2d0b474a.js";import{S as O}from"./ScorecardStatusBadge.b5086b7d.js";import{c as j}from"./createOnChangeFn.5c957a31.js";import{u as q}from"./createSimpleTable.e45bb713.js";import{R as L}from"./arrow-path.24b87f73.js";import{S as z}from"./StatisticDisplayCard.bd61b3ae.js";import"./magnifying-glass.b7cbe8fe.js";import"./TransitionExpand.ba8af3de.js";import"./chevron-up.736f4142.js";const m={};m.props={scorecards:{key:"scorecards",required:!0,type:Array}};m.setup=(e,a)=>{const t=e,i=p(()=>{const r=new Map;for(const s of t.scorecards){const{buyer:o}=s.data,l=o.company.id,S=r.get(l);S?S.push(s):r.set(l,[s])}return r}),d=p(()=>{const r=[];for(const s of i.value.values()){const o=u(s),l=h(s).length,S=f(s,"COMPLETE").length,T=f(s,"IN_PROGRESS").length,{status:b,buyer:A}=o.data;r.push({buyer:A.company,suppliers:l,totalScorecards:s.length,completed:S,inProgress:T,latestSaved:b.quarter+"/"+b.year,latestStatus:b.state})}return r.sort((s,o)=>s.buyer.name.localeCompare(o.buyer.name))});function u(r){return r.reduce((s,o)=>y(s.data.status,o.data.status)>0?s:o)}function y(r,s){const o=r.year-s.year;return o!=0?o:r.quarter.localeCompare(s.quarter)}function h(r){return[...new Set(r.map(s=>s.data.supplier.id))]}function f(r,s){const o=[];return r.filter(l=>{l.data.status.state===s&&o.push(l)}),o}function n(r){return r.toLowerCase().replace(/_/g," ")}const c=j(),g=[c.accessor(r=>r.buyer.name,{id:"buyer",header:()=>"Buyer"}),c.accessor("suppliers",{header:()=>"Total Supplier(s)",enableColumnFilter:!1}),c.accessor("totalScorecards",{header:()=>"Total Scorecard(s)",enableColumnFilter:!1}),c.accessor("completed",{header:()=>"Completed Scorecard(s)",enableColumnFilter:!1}),c.accessor("inProgress",{header:()=>"In Progress Scorecard(s)",enableColumnFilter:!1}),c.accessor("latestSaved",{header:()=>"Latest Saved",enableColumnFilter:!1}),c.accessor("latestStatus",{header:()=>"Latest Status",cell:r=>k(O,{props:{value:n(r.getValue())}}),enableColumnFilter:!1})];return{instance:q(d,g)}};m.components=Object.assign({AppTanStackTable:F},m.components);var G=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("AppTanStackTable",{attrs:{table:e.instance}})},D=[];const $={};var H=x(m,G,D,!1,I,null,null,null);function I(e){for(let a in $)this[a]=$[a]}const N=function(){return H.exports}();var V=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("svg",e._g({attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"}},e.$listeners),[t("path",{attrs:{"fill-rule":"evenodd",d:"M15.988 3.012A2.25 2.25 0 0 1 18 5.25v6.5A2.25 2.25 0 0 1 15.75 14H13.5v-3.379a3 3 0 0 0-.879-2.121l-3.12-3.121a3 3 0 0 0-1.402-.791 2.252 2.252 0 0 1 1.913-1.576A2.25 2.25 0 0 1 12.25 1h1.5a2.25 2.25 0 0 1 2.238 2.012zM11.5 3.25a.75.75 0 0 1 .75-.75h1.5a.75.75 0 0 1 .75.75v.25h-3v-.25z","clip-rule":"evenodd"}}),t("path",{attrs:{d:"M3.5 6A1.5 1.5 0 0 0 2 7.5v9A1.5 1.5 0 0 0 3.5 18h7a1.5 1.5 0 0 0 1.5-1.5v-5.879a1.5 1.5 0 0 0-.44-1.06L8.44 6.439A1.5 1.5 0 0 0 7.378 6H3.5z"}})])};const Q={render:V},_={};_.props={scorecards:{key:"scorecards",required:!0,type:Array}};_.setup=(e,a)=>{const t=e,i={title:"Total Buyers",component:w},d={title:"Completed Scorecards",component:Q},u={title:"In-Progress Scorecards",component:L},y=p(()=>{const n=new Map;for(const c of t.scorecards){const{buyer:g}=c.data,C=g.company.id,r=n.get(C);r?r.push(c):n.set(C,[c])}return n}),h=p(()=>t.scorecards.filter(n=>n.data.status.state==="COMPLETE")),f=p(()=>t.scorecards.filter(n=>n.data.status.state==="IN_PROGRESS"));return{buyersSummary:i,completedScorecardSummary:d,inProgressScorecardSummary:u,scorecardsGrouped:y,completedScorecards:h,inProgressScorecards:f}};_.components=Object.assign({StatisticDisplayCard:z},_.components);var U=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("section",{staticClass:"grid grid-cols-1 gap-6 xl:grid-cols-3"},[t("StatisticDisplayCard",{attrs:{value:e.buyersSummary,number:e.scorecardsGrouped.size}}),t("StatisticDisplayCard",{attrs:{value:e.completedScorecardSummary,number:e.completedScorecards.length}}),t("StatisticDisplayCard",{attrs:{value:e.inProgressScorecardSummary,number:e.inProgressScorecards.length}})],1)},J=[];const P={};var K=x(_,U,J,!1,W,null,null,null);function W(e){for(let a in P)this[a]=P[a]}const X=function(){return K.exports}(),v={};v.setup=(e,a)=>({promises:Promise.all([M.get(`${R}/scorecards`)])});v.components=Object.assign({BackButton:E,ScorecardSummary:X,AdminCannedScorecardTable:N},v.components);var Y=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("section",{staticClass:"space-y-8"},[t("div",{staticClass:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:space-x-4 sm:space-y-0"},[t("BackButton",{attrs:{link:"/admin/reports"}}),t("div",{staticClass:"flex flex-col"},[t("BaseTypography",{attrs:{component:"h2",variant:"h5"}},[e._v("Scorecards")]),t("BaseTypography",{staticClass:"uppercase text-gray-600",attrs:{variant:"overline"}},[e._v(" Canned Report ")])],1)],1),e.promises?t("BasePromise",{attrs:{promise:e.promises},scopedSlots:e._u([{key:"success",fn:function(i){var d=i.result,u=d[0];return[t("div",{staticClass:"space-y-8"},[t("ScorecardSummary",{attrs:{scorecards:u.data}}),t("AdminCannedScorecardTable",{attrs:{scorecards:u.data}})],1)]}}],null,!1,444654694)}):e._e()],1)},Z=[];const B={};var ee=x(v,Y,Z,!1,te,null,null,null);function te(e){for(let a in B)this[a]=B[a]}const pe=function(){return ee.exports}();export{pe as default};
