import{c as k,aF as V,aR as u,bq as T,aY as d,aI as I,aO as _,aP as v,n as x,ap as M,bY as q}from"./index.1be96d76.js";import{A as P,R as B}from"./RowSelectionInput.aa7a3ba9.js";import{A as O,T as U}from"./AppTanStackTable.b4268540.js";import{S as j}from"./ScorecardStatusBadge.0aa3a31a.js";import{u as D,c as N,i as p,r as E,h as Y,g as z,f as H,b as L,e as Q,d as G}from"./createOnChangeFn.67977a20.js";import{F as J}from"./FileSaver.min.37eca5f2.js";import{u as K}from"./useInDepthScorecardsV2.2720ad57.js";import"./magnifying-glass.b7cbe8fe.js";import"./chevron-left.0808b01b.js";import"./TransitionExpand.acb23ae5.js";import"./chevron-up.736f4142.js";const g={};g.props={id:{key:"id",required:!0,type:String},scorecards:{key:"scorecards",required:!0,type:Array}};g.setup=(t,a)=>{const s=t,i=k(()=>s.scorecards.map(({id:e,data:r,meta:o})=>{const{supplier:l,status:n}=r;return{id:e,supplier:l.name,status:n.state,year:n.year,quarter:n.quarter,updatedAt:o.updatedAt}})),m=V(),c=N(),C=[c.display({id:"select",header:({table:e})=>u(P,{props:{table:e}}),cell:({row:e})=>u(B,{props:{row:e}})}),c.accessor(e=>e.supplier,{id:"supplier",header:()=>"Supplier",cell:e=>e.getValue()}),c.accessor("status",{header:()=>"Status",cell:e=>u(j,{props:{value:e.getValue()}})}),c.accessor("quarter",{header:()=>"Quarter",cell:e=>e.getValue()}),c.accessor("year",{header:()=>"Year",cell:e=>e.getValue()}),c.accessor("updatedAt",{header:()=>"Last Updated",cell:e=>u(T,{props:{value:e.getValue(),format:"date"}}),enableColumnFilter:!1}),c.display({id:"actions",header:"Actions",cell:({row:e})=>u(U,{props:{actions:[{id:"edit",action(){w.push(`/admin/companies/${encodeURIComponent(s.id)}/scorecards/in-depth/rating-service-2/${e.original.id}`)}},{id:"download",async action(){const r=await _(`${v}/companies/${s.id}/scorecards/${e.original.id}/docx`,{responseType:"blob"}),o=`${e.original.supplier} Scorecard ${e.original.quarter} ${e.original.id}.docx`;J.exports.saveAs(r.data,o)}},{id:"archive",async action(){(await _.delete(`${v}/companies/${s.id}/scorecards-v2/${e.original.id}`)).status===200&&m.success("Archived Scorecard Successfully")}}]}})})],S=d([]),h=d({pageIndex:0,pageSize:10}),y=d(""),b=d([]),$=d({}),R=D({get data(){return i.value},columns:C,state:{get sorting(){return S.value},get pagination(){return h.value},get globalFilter(){return y.value},get columnFilters(){return b.value},get rowSelection(){return $.value}},onSortingChange:p(S),onPaginationChange:p(h),onColumnFiltersChange:p(b),onGlobalFilterChange:p(y),globalFilterFn:(e,r,o,l)=>{const n=E(e.getValue(r),o,{threshold:Y.CONTAINS});return l(n),n.passed},onRowSelectionChange:p($),getCoreRowModel:z(),getSortedRowModel:H(),getFacetedUniqueValues:L(),getPaginationRowModel:Q(),getFilteredRowModel:G()}),w=I();return{instance:R,bulkActions:[{id:"archive",async action(){const e=R.getSelectedRowModel().rows,r=e.length;let o=0;if(r>0){for(const l of e){const n=l.original.id;(await _.delete(`${v}/companies/${s.id}/scorecards-v2/${n}`)).status===200&&o++}m.success(`Archived ${o}/${r} Scorecard(s) Successfully`),w.push(`/admin/companies/${s.id}/scorecards/in-depth/rating-service-2`)}}}]}};g.components=Object.assign({AppTanStackTable:O},g.components);var W=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("AppTanStackTable",{attrs:{table:t.instance,"table-actions":t.bulkActions}})},X=[];const F={};var Z=x(g,W,X,!1,ee,null,null,null);function ee(t){for(let a in F)this[a]=F[a]}const te=function(){return Z.exports}(),f={};f.setup=(t,a)=>{const s=q("id"),i=K.list(s);return{id:s,scorecards:i}};f.components=Object.assign({PlusSvg:M,ScorecardsV2Table:te},f.components);var se=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("BaseTablePageLayout",{scopedSlots:t._u([{key:"overline",fn:function(){return[t._v("Rating Service 2")]},proxy:!0},{key:"title",fn:function(){return[t._v("In-Depth Scorecards")]},proxy:!0},{key:"button",fn:function(){return[s("BaseButton",{staticClass:"space-x-1",attrs:{type:"button",to:`/admin/companies/${t.id}/scorecards/in-depth/rating-service-2/new`}},[s("PlusSvg",{staticClass:"w-5"}),s("span",[t._v("Scorecard")])],1)]},proxy:!0},{key:"table",fn:function(){return[s("BaseVueQuery",{attrs:{query:t.scorecards},scopedSlots:t._u([{key:"success",fn:function(i){var m=i.data;return[s("ScorecardsV2Table",{attrs:{id:t.id,scorecards:m}})]}}])})]},proxy:!0}])})},ae=[];const A={};var re=x(f,se,ae,!1,oe,null,null,null);function oe(t){for(let a in A)this[a]=A[a]}const he=function(){return re.exports}();export{he as default};
