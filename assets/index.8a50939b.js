import{aS as g,aC as h,aO as T,aP as x,c,bl as I,aF as $,aG as E,aR as _,n as S,am as k,bG as V,aE as F}from"./index.91cb71ee.js";import{A as B,T as D}from"./AppTanStackTable.acf7eb42.js";import{C as N}from"./CompanyStatusBadge.734c65c7.js";import{c as j}from"./createOnChangeFn.56ecbd8e.js";import{u as P}from"./createSimpleTable.b37c2aa7.js";import"./magnifying-glass.b7cbe8fe.js";import"./TransitionExpand.0afddc58.js";import"./chevron-up.736f4142.js";const Q={set(){const t=g();return h(e=>T.put(`${x}/companies/${e.id}`,e).then(s=>s.data),{onSuccess(e){console.log(e.id+" "+e.status),t.invalidateQueries(["companies"],{exact:!0}),t.invalidateQueries(["companies",e.id],{exact:!0})}})}},m={};m.props={value:{key:"value",required:!0,type:Array}};m.setup=(t,e)=>{const s=t,o=e.emit,r=c(()=>s.value),d=I(),v=c(()=>d.companies),u=$(),i=E(),b=c(()=>i.isAdmin),y=c(()=>{var n;return((n=i.email)==null?void 0:n.split("@")[1])==="whitehawk.com"&&b.value}),l=j(),A=[l.accessor("id",{header:()=>"ID",enableColumnFilter:!1}),l.accessor("name",{header:()=>"Name",enableColumnFilter:!1}),l.accessor("domain",{header:()=>"Domain",enableColumnFilter:!1}),l.accessor(a=>{var n;return(n=a.industry)==null?void 0:n.name},{id:"industry",header:()=>"Industry",enableColumnFilter:!1}),l.accessor(a=>a.status,{id:"status",header:()=>"Status",enableColumnFilter:!1,cell:a=>_(N,{props:{value:a.getValue()}})}),l.display({id:"actions",header:"Actions",cell:({row:a})=>_(D,{props:{actions:[{id:"edit",to:`/admin/companies/${a.original.id}/settings`},{id:"view",async action(){await u.setCompanyId(a.original.id)},isDisabled:c(()=>!v.value.find(n=>n.id===a.original.id))},{id:"activate",action(){o("activate",a.original)},isDisabled:c(()=>!y.value||a.original.status==="ACTIVE")},{id:"inactivate",action(){o("inactivate",a.original)},isDisabled:c(()=>{var n;return!y.value||a.original.status==="INACTIVE"||((n=u.company)==null?void 0:n.id)===a.original.id})}].filter(n=>a.original.status==="ACTIVE"&&n.id!=="activate"||a.original.status==="INACTIVE"&&n.id!=="inactivate")}})})];return{instance:P(r,A)}};m.components=Object.assign({AppTanStackTable:B},m.components);var U=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("AppTanStackTable",{attrs:{table:t.instance}})},q=[];const f={};var L=S(m,U,q,!1,M,null,null,null);function M(t){for(let e in f)this[e]=f[e]}const O=function(){return L.exports}(),p={};p.setup=(t,e)=>{const s=V.list(),o=F(),r=Q.set();async function d(u){const i={...u,status:"ACTIVE"};await r.mutateAsync(i),o.success("Successfully activated company "+i.name+".")}async function v(u){const i={...u,status:"INACTIVE"};await r.mutateAsync(i),o.success("Successfully inactivated company "+i.name+".")}return{companyList:s,activateCompany:d,inactivateCompany:v}};p.components=Object.assign({PlusSvg:k,CompaniesTable:O},p.components);var R=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("BaseTablePageLayout",{scopedSlots:t._u([{key:"title",fn:function(){return[t._v("Companies")]},proxy:!0},{key:"button",fn:function(){return[s("BaseButton",{staticClass:"space-x-1",attrs:{to:"/admin/companies/new",type:"button"}},[s("PlusSvg",{staticClass:"w-5"}),s("span",[t._v("Company")])],1)]},proxy:!0},{key:"table",fn:function(){return[s("BaseVueQuery",{attrs:{query:t.companyList},scopedSlots:t._u([{key:"success",fn:function(o){var r=o.data;return[s("CompaniesTable",{attrs:{value:r},on:{activate:t.activateCompany,inactivate:t.inactivateCompany}})]}}])})]},proxy:!0}])})},G=[];const C={};var H=S(p,R,G,!1,w,null,null,null);function w(t){for(let e in C)this[e]=C[e]}const at=function(){return H.exports}();export{at as default};
