import{D as N}from"./document-arrow-down.8787241b.js";import{aT as R,aD as F,ah as B,aP as p,aQ as d,aB as Q,d as k,aS as f,br as P,a_ as S,az as j,n as q,ax as L,bs as O,L as E,c7 as V,b as A,aK as U}from"./index.daf4a3c8.js";import{A as Z,R as z}from"./RowSelectionInput.192ea81e.js";import{A as H,T as K}from"./AppTanStackTable.f9958620.js";import{S as G}from"./ScorecardStatusBadge.71c75614.js";import{u as Y,c as J,i as C,r as W,h as X,g as ee,f as ae,b as te,e as se,d as re}from"./createOnChangeFn.f055bbd4.js";import"./magnifying-glass.b7cbe8fe.js";import"./TransitionExpand.171006fa.js";import"./chevron-up.736f4142.js";const ne={create(e){const t=R();return F(a=>p.post(`${d}/companies/${e.value}/scorecards-v2`,a).then(r=>r.data),{onSuccess(a){t.invalidateQueries(["companies",e,"scorecards-v2"],{exact:!0}),t.invalidateQueries(["companies",e,"scorecards-v2",a.id],{exact:!0})}})},read(e,t){return B(["companies",e,"scorecards-v2",t],()=>p.get(`${d}/companies/${e.value}/scorecards-v2/${t.value}`).then(a=>a.data))},update(e,t){const a=R();return F(r=>p.put(`${d}/companies/${e.value}/scorecards-v2/${t.value}`,r).then(n=>n.data),{onSuccess(){a.invalidateQueries(["companies",e,"scorecards-v2",t],{exact:!0})}})},delete(e,t){const a=R();return F(()=>p.delete(`${d}/companies/${e.value}scorecards-v2/${t.value}`).then(r=>r.data),{onSuccess(){a.invalidateQueries(["companies",e,"scorecards-v2",t],{exact:!0})}})},list(e){return B(["companies",e,"scorecards-v2"],()=>p.get(`${d}/companies/${e.value}/scorecards-v2`).then(t=>t.data))}},_={};_.props={id:{key:"id",required:!0,type:String},value:{key:"value",required:!1,type:Array},scorecards:{key:"scorecards",required:!0,type:Array}};_.setup=(e,t)=>{const a=e,r=t.emit,n=Q(a,r),o=k(()=>a.scorecards.map(({id:s,data:i,meta:l})=>{const{supplier:w,status:u}=i;return{id:s,supplier:w.name,status:u.state,year:u.year,quarter:u.quarter,updatedAt:l.updatedAt}})),c=J(),$=[c.display({id:"select",header:({table:s})=>f(Z,{props:{table:s}}),cell:({row:s})=>f(z,{props:{row:s}})}),c.accessor(s=>s.supplier,{id:"supplier",header:()=>"Supplier",cell:s=>s.getValue(),enableColumnFilter:!1}),c.accessor("status",{header:()=>"Status",cell:s=>f(G,{props:{value:s.getValue()}}),enableColumnFilter:!1}),c.accessor("quarter",{header:()=>"Quarter",cell:s=>s.getValue(),enableColumnFilter:!1}),c.accessor("year",{header:()=>"Year",cell:s=>s.getValue(),enableColumnFilter:!1}),c.accessor("updatedAt",{header:()=>"Last Updated",cell:s=>f(P,{props:{value:s.getValue(),format:"date"}}),enableColumnFilter:!1}),c.display({id:"actions",header:"Actions",cell:({row:s})=>f(K,{props:{actions:[{id:"edit",to:`/admin/companies/${encodeURIComponent(a.id)}/scorecards/in-depth/rating-service-2/${s.original.id}`}]}})})],x=S([]),h=S({pageIndex:0,pageSize:10}),v=S(""),m=S({}),g=Y({get data(){return o.value},columns:$,state:{get sorting(){return x.value},get pagination(){return h.value},get globalFilter(){return v.value},get rowSelection(){return m.value}},onSortingChange:C(x),onPaginationChange:C(h),onGlobalFilterChange:C(v),globalFilterFn:(s,i,l,w)=>{const u=W(s.getValue(i),l,{threshold:X.CONTAINS});return w(u),u.passed},onRowSelectionChange:C(m),getCoreRowModel:ee(),getSortedRowModel:ae(),getFacetedUniqueValues:te(),getPaginationRowModel:se(),getFilteredRowModel:re()}),T=k(()=>g.getSelectedRowModel().rows);return j(T,s=>{const i=[];s.forEach(l=>{l.original&&i.push({scorecardId:l.original.id,supplierName:l.original.supplier})}),n.value=i},{immediate:!0}),{instance:g}};_.components=Object.assign({AppTanStackTable:H},_.components);var oe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("AppTanStackTable",{attrs:{table:e.instance}})},ce=[];const D={};var le=q(_,oe,ce,!1,ie,null,null,null);function ie(e){for(let t in D)this[t]=D[t]}const ue=function(){return le.exports}(),y={};y.props={id:{key:"id",required:!0,type:String},value:{key:"value",required:!1,type:null},scorecards:{key:"scorecards",required:!0,type:Array}};y.setup=(e,t)=>{const a=e,r=t.emit;return{proxy:L(a,r)}};y.components=Object.assign({ConvertScorecardsV2Table:ue},y.components);var pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"grid gap-6"},[a("ConvertScorecardsV2Table",{attrs:{id:e.id,scorecards:e.scorecards},model:{value:e.proxy.scorecards,callback:function(r){e.$set(e.proxy,"scorecards",r)},expression:"proxy.scorecards"}}),a("BaseSimpleCard",[a("BaseLabel",{staticClass:"flex flex-col p-4 lg:grid lg:grid-cols-3 lg:items-center"},[a("span",{staticClass:"after:content-['*']` after:text-red-700"},[e._v("File Name")]),a("div",{staticClass:"flex flex-col lg:col-span-2"},[a("BaseInput",{attrs:{type:"text",required:"","aria-required":"true"},model:{value:e.proxy.fileName,callback:function(r){e.$set(e.proxy,"fileName",r)},expression:"proxy.fileName"}})],1)])],1)],1)},de=[];const I={};var ve=q(y,pe,de,!1,me,null,null,null);function me(e){for(let t in I)this[t]=I[t]}const ge=function(){return ve.exports}(),b={};b.setup=(e,t)=>{const a=V("id"),r=V("subscriptionId"),n=A(!1),o=A(),c=ne.list(a),$=k(()=>{var v,m,g;return!((v=o.value)!=null&&v.fileName)||!((g=(m=o.value)==null?void 0:m.scorecards)!=null&&g.length)}),x=U();async function h(){if(!!o.value){n.value=!0;try{await p.post(`${d}/companies/${a.value}/batch/scorecards`,{fileName:o.value.fileName,supplierScorecardInfos:o.value.scorecards})}finally{n.value=!1}x.push(`/admin/companies/${a.value}/subscriptions/${r.value}/integrations/2/scorecards/zip-files`)}}return{id:a,isLoading:n,fileZip:o,scorecards:c,isDisabled:$,convert:h}};b.components=Object.assign({BackButton:O,ConvertScorecardsV2Input:ge,LoadingSpinner:E,DocumentDownloadSvg:N},b.components);var fe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"space-y-6"},[a("div",{staticClass:"flex flex-col space-y-4 lg:flex-row lg:items-center lg:space-x-4 lg:space-y-0"},[a("BackButton"),a("div",{staticClass:"flex flex-col -space-y-1"},[a("BaseOverline",{staticClass:"uppercase text-gray-500"},[e._v("Black Kite")]),a("BaseTypography",{attrs:{variant:"h5"}},[e._v("ZIP Files")])],1)],1),a("form",{staticClass:"space-y-6",on:{submit:function(r){return r.preventDefault(),e.convert.apply(null,arguments)}}},[a("BaseVueQuery",{attrs:{query:e.scorecards},scopedSlots:e._u([{key:"success",fn:function(r){var n=r.data;return[a("ConvertScorecardsV2Input",{attrs:{id:e.id,scorecards:n},model:{value:e.fileZip,callback:function(o){e.fileZip=o},expression:"fileZip"}})]}}])}),a("BaseButton",{staticClass:"space-x-2",attrs:{disabled:e.isDisabled}},[e.isLoading?a("LoadingSpinner"):[a("DocumentDownloadSvg",{staticClass:"-ml-1 w-5"}),a("span",[e._v("Convert")])]],2)],1)])},_e=[];const M={};var ye=q(b,fe,_e,!1,xe,null,null,null);function xe(e){for(let t in M)this[t]=M[t]}const qe=function(){return ye.exports}();export{qe as default};
