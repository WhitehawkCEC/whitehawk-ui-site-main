import{F as E}from"./FormButton.493f7602.js";import{L as O}from"./LicenseTypeMapQuantitiesInput.b2d5db85.js";import{cc as L,cb as f,cd as A,ce as N,cf as x,cg as H,aT as G,aE as Y,ch as R,bQ as z,d as v,r as $,cH as V,aB as Z,n as M,bZ as y,c6 as J}from"./index.01207726.js";import{m as Q}from"./message_pb.4213bae3.js";import{u as U}from"./useAccountSubscriptionProductLicenseBatches.1990656f.js";import{u as K,L as X}from"./LicenseBatchUsageDisplay.3997c1d9.js";import{S as ee}from"./SubscriptionProductIdHeader.4f5a469a.js";import"./arrow-down-on-square.bf61cdc5.js";import"./trash.78f57a7a.js";import"./index.3af057dd.js";import"./DynamicForm.56adb802.js";import"./calendar.aad8910e.js";import"./identification.8410fcc9.js";import"./AggregateLicenseDisplay.c743c1e4.js";import"./DateRangeDisplay.9bc1b8fd.js";import"./IsoDateTimeDisplay.418d20d0.js";import"./BackButton.1cd9c2a7.js";import"./chevron-left.0808b01b.js";import"./ToolTip.1eb712b8.js";import"./exclamation-triangle.54812a62.js";import"./index.45355fdb.js";import"./index.9ce4ab5f.js";var C={},P={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Service=e.CreateResponse=e.CreateRequest=void 0;const a=L,n=f,i=f,u=f,m=f,_=f,o=Q,d=A,p=N;class I extends _.MessageType{constructor(){super("whitehawk.proto.internal.client_portal.accounts.id.subscriptions.subscription_id.products.product_id.license_batches.batch_id.quantity_changes.v1.CreateRequest",[{no:1,name:"account_id",kind:"message",T:()=>p.Slug},{no:2,name:"subscription_id",kind:"message",T:()=>p.Slug},{no:3,name:"product_id",kind:"message",T:()=>d.Ulid},{no:4,name:"batch_id",kind:"message",T:()=>d.Ulid},{no:5,name:"quantities_diff",kind:"message",T:()=>o.LicenseTypeMapQuantities}])}create(t){const s={};return globalThis.Object.defineProperty(s,m.MESSAGE_TYPE,{enumerable:!1,value:this}),t!==void 0&&(0,u.reflectionMergePartial)(this,s,t),s}internalBinaryRead(t,s,r,c){let l=c!=null?c:this.create(),j=t.pos+s;for(;t.pos<j;){let[T,q]=t.tag();switch(T){case 1:l.accountId=p.Slug.internalBinaryRead(t,t.uint32(),r,l.accountId);break;case 2:l.subscriptionId=p.Slug.internalBinaryRead(t,t.uint32(),r,l.subscriptionId);break;case 3:l.productId=d.Ulid.internalBinaryRead(t,t.uint32(),r,l.productId);break;case 4:l.batchId=d.Ulid.internalBinaryRead(t,t.uint32(),r,l.batchId);break;case 5:l.quantitiesDiff=o.LicenseTypeMapQuantities.internalBinaryRead(t,t.uint32(),r,l.quantitiesDiff);break;default:let h=r.readUnknownField;if(h==="throw")throw new globalThis.Error(`Unknown field ${T} (wire type ${q}) for ${this.typeName}`);let F=t.skip(q);h!==!1&&(h===!0?i.UnknownFieldHandler.onRead:h)(this.typeName,l,T,q,F)}}return l}internalBinaryWrite(t,s,r){t.accountId&&p.Slug.internalBinaryWrite(t.accountId,s.tag(1,n.WireType.LengthDelimited).fork(),r).join(),t.subscriptionId&&p.Slug.internalBinaryWrite(t.subscriptionId,s.tag(2,n.WireType.LengthDelimited).fork(),r).join(),t.productId&&d.Ulid.internalBinaryWrite(t.productId,s.tag(3,n.WireType.LengthDelimited).fork(),r).join(),t.batchId&&d.Ulid.internalBinaryWrite(t.batchId,s.tag(4,n.WireType.LengthDelimited).fork(),r).join(),t.quantitiesDiff&&o.LicenseTypeMapQuantities.internalBinaryWrite(t.quantitiesDiff,s.tag(5,n.WireType.LengthDelimited).fork(),r).join();let c=r.writeUnknownFields;return c!==!1&&(c==!0?i.UnknownFieldHandler.onWrite:c)(this.typeName,t,s),s}}e.CreateRequest=new I;class S extends _.MessageType{constructor(){super("whitehawk.proto.internal.client_portal.accounts.id.subscriptions.subscription_id.products.product_id.license_batches.batch_id.quantity_changes.v1.CreateResponse",[])}create(t){const s={};return globalThis.Object.defineProperty(s,m.MESSAGE_TYPE,{enumerable:!1,value:this}),t!==void 0&&(0,u.reflectionMergePartial)(this,s,t),s}internalBinaryRead(t,s,r,c){return c!=null?c:this.create()}internalBinaryWrite(t,s,r){let c=r.writeUnknownFields;return c!==!1&&(c==!0?i.UnknownFieldHandler.onWrite:c)(this.typeName,t,s),s}}e.CreateResponse=new S,e.Service=new a.ServiceType("whitehawk.proto.internal.client_portal.accounts.id.subscriptions.subscription_id.products.product_id.license_batches.batch_id.quantity_changes.v1.Service",[{name:"Create",options:{},I:e.CreateRequest,O:e.CreateResponse}])})(P);Object.defineProperty(C,"__esModule",{value:!0});var W=C.ServiceClient=void 0;const B=P,te=L;class ne{constructor(a){this._transport=a,this.typeName=B.Service.typeName,this.methods=B.Service.methods,this.options=B.Service.options}create(a,n){const i=this.methods[0],u=this._transport.mergeOptions(n);return(0,te.stackIntercept)("unary",this._transport,i,u,a)}}W=C.ServiceClient=ne;const ie=new W(x),se={create(e,a,n,i){const u=H(),m=G();async function _(o){return await ie.create({accountId:{value:e.value},subscriptionId:{value:a.value},productId:{value:n.value},batchId:{value:i.value},...o},u.value)}return Y(_,{onSuccess(){const o=[[R,"accounts",e,"subscriptions",a,"products",n,"license-batches"],[R,"accounts",e,"subscriptions",a,"products",n,"license-batches",i]];for(const d of o)m.invalidateQueries(d,{exact:!0})}})}},b={};b.props={accountId:{key:"accountId",required:!0,type:String},subscriptionId:{key:"subscriptionId",required:!0,type:String},productId:{key:"productId",required:!0,type:String},batchId:{key:"batchId",required:!0,type:String}};b.setup=(e,a)=>{const i=z(e),u=se.create(i.accountId,i.subscriptionId,i.productId,i.batchId),m=U.read(i.accountId,i.subscriptionId,i.productId,i.batchId),_=v(()=>{var t,s;return(s=(t=m.data.value)==null?void 0:t.value)==null?void 0:s.counts}),o=$(V.LicenseTypeMapQuantities.create()),d=$(!1);Z(()=>_.value,t=>{var s,r;!t||d.value||(o.value={annual:((s=t.annual)==null?void 0:s.quantity)||0,oneTime:((r=t.oneTime)==null?void 0:r.quantity)||0},d.value=!0)},{immediate:!0});const p=K(_,o),I=v(()=>({quantitiesDiff:p.value})),S=v(()=>p.value.annual!==0||p.value.oneTime!==0);async function k(){await u.mutateAsync(I.value)}return{currentState:m,quantitiesDesired:o,canSubmit:S,submit:k}};b.components=Object.assign({LicenseTypeMapQuantitiesInput:O,FormButton:E},b.components);var ae=function(){var e=this,a=e.$createElement,n=e._self._c||a;return n("BaseSimpleCard",{staticClass:"divide-y"},[n("BaseTypography",{staticClass:"p-4",attrs:{component:"h2",variant:"subtitle3"}},[e._v(" Edit Quantities ")]),n("form",{staticClass:"divide-y",on:{submit:function(i){return i.preventDefault(),e.submit.apply(null,arguments)}}},[n("BaseVueQuery",{attrs:{query:e.currentState},scopedSlots:e._u([{key:"success",fn:function(){return[n("LicenseTypeMapQuantitiesInput",{model:{value:e.quantitiesDesired,callback:function(i){e.quantitiesDesired=i},expression:"quantitiesDesired"}})]},proxy:!0}])}),n("FormButton",{attrs:{action:"update","is-valid-form":e.canSubmit}})],1)],1)},re=[];const w={};var ce=M(b,ae,re,!1,ue,null,null,null);function ue(e){for(let a in w)this[a]=w[a]}const oe=function(){return ce.exports}(),g={};g.setup=(e,a)=>{const n=y("id"),i=y("subscriptionId"),u=y("productId"),m=y("batchId"),_=J.read(n,i,u),o=U.read(n,i,u,m),d=v(()=>{var p;return((p=o.data.value)==null?void 0:p.value)||Q.LicenseBatchUsage.create()});return{id:n,subscriptionId:i,productId:u,batchId:m,productRead:_,licenseBatch:o,usage:d}};g.components=Object.assign({SubscriptionProductIdHeader:ee,LicenseBatchUsageDisplay:X,AccountSubscriptionBatchQuantitiesChange:oe},g.components);var de=function(){var e=this,a=e.$createElement,n=e._self._c||a;return n("section",{staticClass:"space-y-6"},[n("BaseVueQuery",{attrs:{query:e.productRead},scopedSlots:e._u([{key:"success",fn:function(i){var u=i.data;return[n("SubscriptionProductIdHeader",{attrs:{id:e.id,"subscription-id":e.subscriptionId,value:u}})]}}])}),n("BaseVueQuery",{attrs:{query:e.licenseBatch},scopedSlots:e._u([{key:"success",fn:function(){return[n("LicenseBatchUsageDisplay",{attrs:{value:e.usage}})]},proxy:!0}])}),n("AccountSubscriptionBatchQuantitiesChange",{attrs:{"account-id":e.id,"subscription-id":e.subscriptionId,"product-id":e.productId,"batch-id":e.batchId}})],1)},pe=[];const D={};var le=M(g,de,pe,!1,me,null,null,null);function me(e){for(let a in D)this[a]=D[a]}const Pe=function(){return le.exports}();export{Pe as default};
