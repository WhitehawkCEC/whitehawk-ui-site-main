import{S as T,F as N}from"./ScorecardBatchSuccessFailBadge.f506f2f7.js";import{aT as S,aD as $,ah as g,aP as i,aQ as l,d as u,aS as x,n as F,bs as q,c7 as _,b as I,aK as A}from"./index.8b337dc3.js";import{A as w,T as Q}from"./AppTanStackTable.cdd8c488.js";import{c as R}from"./createOnChangeFn.a25153a2.js";import{u as V}from"./createSimpleTable.fb966d69.js";import{d as D}from"./FormValidation.a5e2f641.js";import{s as B}from"./index.1a31c4fd.js";import"./magnifying-glass.b7cbe8fe.js";import"./TransitionExpand.24b1500d.js";import"./chevron-up.736f4142.js";const E={create(e){const a=S();return $(t=>i.post(`${l}/companies/${e.value}/batch/generate/scorecards-v2`,t).then(s=>s.data),{onSuccess(){a.invalidateQueries(["companies",e,"batch","generate","scorecards-v2"],{exact:!0})}})},read(e,a){return g(["companies",e,"batch","scorecards","status-v2",a],()=>i.get(`${l}/companies/${e.value}/batch/scorecards/status-v2/${a.value}`).then(t=>t.data))},delete(e,a){const t=S();return $(()=>i.delete(`${l}/companies/${e.value}/batch/generate/scorecards-v2/${a.value}`).then(s=>s.data),{onSuccess(){t.invalidateQueries(["companies",e,"batch","generate","scorecards-v2",a],{exact:!0})}})},list(e){return g(["companies",e,"batch","scorecards","status-v2"],()=>i.get(`${l}/companies/${e.value}/batch/scorecards/status-v2`).then(a=>a.data))}},d={};d.props={id:{key:"id",required:!0,type:String},subId:{key:"subId",required:!0,type:String},batches:{key:"batches",required:!0,type:Array},entites:{key:"entites",required:!0,type:Array}};d.setup=(e,a)=>{const t=e,s=u(()=>t.id),p=u(()=>t.subId),m=u(()=>t.entites.map(r=>{var v;return{id:r.id,supplier:r.name,state:t.batches.some(o=>o.supplierId===r.id)?"Success":"Failed",scorecardId:(v=t.batches.find(o=>o.supplierId===r.id))==null?void 0:v.scorecardId}})),c=R(),f=[c.accessor("id",{header:()=>"Supplier ID",enableColumnFilter:!1}),c.accessor("supplier",{header:()=>"Supplier Name",enableColumnFilter:!1}),c.accessor("state",{header:()=>"Scorecard State",cell:r=>x(T,{props:{value:r.getValue()}}),enableColumnFilter:!1}),c.display({id:"actions",header:"Actions",cell:({row:r})=>x(Q,{props:{actions:[{id:"edit",to:`/admin/companies/${s.value}/subscriptions/${p.value}/integrations/2/scorecards/in-depth/${r.original.scorecardId}`}]}})})];return{instance:V(m,f)}};d.components=Object.assign({AppTanStackTable:w},d.components);var j=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("AppTanStackTable",{attrs:{table:e.instance}})},P=[];const k={};var L=F(d,j,P,!1,M,null,null,null);function M(e){for(let a in k)this[a]=k[a]}const Z=function(){return L.exports}(),b={};b.setup=(e,a)=>{const t=_("id"),s=_("subscriptionId"),p=_("batchId"),m=I(""),c=I(!1),f=E.read(t,p),h=B(u(()=>{var n;return((n=f.data.value)==null?void 0:n.scorecardIds)||[]})),r=B(u(()=>{var n;return((n=f.data.value)==null?void 0:n.batchRequest.entities)||[]})),v=A();async function o(){const n=h.value.map(y=>({scorecardId:y.scorecardId,supplierName:y.supplierName,batchId:p.value}));c.value=!0;try{await i.post(`${l}/companies/${t.value}/batch/scorecards`,{fileName:`${m.value}`,supplierScorecardInfos:n})}finally{c.value=!1}v.push(`/admin/companies/${t.value}/subscriptions/${s.value}/integrations/2/scorecards/zip-files`)}return{checkZipFileExtension:D,id:t,subscriptionId:s,fileName:m,batches:h,entites:r,convert:o}};b.components=Object.assign({BackButton:q,FolderDownloadSvg:N,BatchScorecardStatusV2Table:Z},b.components);var z=function(){var e=this,a=e.$createElement,t=e._self._c||a;return e.batches&&e.entites?t("BaseTablePageLayout",{scopedSlots:e._u([{key:"backButton",fn:function(){return[t("BackButton")]},proxy:!0},{key:"overline",fn:function(){return[e._v("Black Kite")]},proxy:!0},{key:"title",fn:function(){return[e._v("Batch Scorecard")]},proxy:!0},{key:"button",fn:function(){return[t("BaseButton",{staticClass:"space-x-2",attrs:{disabled:!e.fileName},on:{click:e.convert}},[t("FolderDownloadSvg",{staticClass:"-ml-1 w-5"}),t("span",[e._v("ZIP Batch")])],1)]},proxy:!0},{key:"table",fn:function(){return[t("div",{staticClass:"space-y-6"},[t("BatchScorecardStatusV2Table",{attrs:{id:e.id,"sub-id":e.subscriptionId,batches:e.batches,entites:e.entites}}),t("BaseSimpleCard",[t("BaseLabel",{staticClass:"flex flex-col p-4 lg:grid lg:grid-cols-3 lg:items-center"},[t("span",{staticClass:"after:content-['*']` after:text-red-700"},[e._v(" File Name: ")]),t("div",{staticClass:"flex flex-col lg:col-span-2"},[t("BaseInputWithValidation",{attrs:{type:"text",required:"","aria-required":"true",validator:e.checkZipFileExtension},model:{value:e.fileName,callback:function(s){e.fileName=s},expression:"fileName"}})],1)])],1)],1)]},proxy:!0}],null,!1,1711310911)}):e._e()},H=[];const C={};var K=F(b,z,H,!1,O,null,null,null);function O(e){for(let a in C)this[a]=C[a]}const re=function(){return K.exports}();export{re as default};
