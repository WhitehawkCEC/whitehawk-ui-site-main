import{aB as D,n as h,ax as V,d as p,b as g,az as G,bs as U,L as z,c7 as K,bG as O,aK as Y,aP as P,aQ as T}from"./index.e870dd6d.js";import{B as H,S as J}from"./StatusInput.4b1c4f9b.js";import{A as W}from"./AnalystSelect.f121e13a.js";import{e as c}from"./attributeValue.ea53a720.js";import{u as X}from"./useCompanyScorecardTemplates.914ac603.js";import{u as Z}from"./useScorecardTemplates.d881f8b9.js";import{u as ee}from"./useBlackKiteEntities.0e529114.js";import{u as te}from"./useUsers.fc806ac6.js";import"./ToolTip.a8062d0a.js";import"./ObjectDisplay.5ba89e6c.js";import"./DynamicForm.9519bcfa.js";const $={};$.props={value:{key:"value",required:!1,type:Array},options:{key:"options",required:!0,type:Array}};$.setup=(e,s)=>{const t=e,a=s.emit;return{proxy:D(t,a)}};var ae=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("BaseLabel",{staticClass:"flex flex-col p-4 lg:grid lg:grid-cols-3 lg:items-center lg:gap-1"},[t("span",{staticClass:"space-x-1"},[e._v(" Companies "),t("span",{staticClass:"text-red-500"},[e._v("*")])]),t("BaseSelect",{staticClass:"lg:col-span-2",attrs:{multiple:""},model:{value:e.proxy,callback:function(a){e.proxy=a},expression:"proxy"}},[t("option",{domProps:{value:null}}),e._l(e.options,function(a){return t("option",{key:a.id,domProps:{value:a}},[t("div",{staticClass:"flex space-x-2"},[t("span",{staticClass:"text-semibold"},[e._v(" "+e._s(a.name)+" ")]),t("span",{staticClass:"text-sm text-gray-500"},[e._v("("+e._s(a.domain)+")")])])])})],2)],1)},se=[];const E={};var ne=h($,ae,se,!1,le,null,null,null);function le(e){for(let s in E)this[s]=E[s]}const oe=function(){return ne.exports}(),S={};S.props={value:{key:"value",required:!1,type:String,default:void 0},options:{key:"options",required:!1,type:Array,default:void 0}};S.setup=(e,s)=>{const t=e,a=s.emit;return{proxy:D(t,a)}};var ie=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("BaseLabel",{staticClass:"flex flex-col space-y-1 p-4 lg:grid lg:grid-cols-3 lg:items-center lg:space-y-0"},[e._v(" Template "),t("BaseSelect",{staticClass:"flex flex-col lg:col-span-2",model:{value:e.proxy,callback:function(a){e.proxy=a},expression:"proxy"}},[t("option",{domProps:{value:null}}),e._l(e.options,function(a,i){return t("option",{key:i,domProps:{value:a.split("/")[1]}},[e._v(" "+e._s(a.split("/")[1])+" ")])})],2)],1)},re=[];const R={};var ce=h(S,ie,re,!1,ue,null,null,null);function ue(e){for(let s in R)this[s]=R[s]}const pe=function(){return ce.exports}(),x={};x.props={value:{key:"value",required:!1,type:null},users:{key:"users",required:!0,type:Array},entities:{key:"entities",required:!0,type:Array},templates:{key:"templates",required:!0,type:Array},companies:{key:"companies",required:!0,type:Array}};x.setup=(e,s)=>{const t=e,a=s.emit,i=V(t,a),y=p(()=>t.companies.filter(n=>n.status==="ACTIVE")),v=p(()=>t.users.filter(n=>c(n,"email").includes("@whitehawk")).map(n=>({id:c(n,"sub"),name:c(n,"name"),title:c(n,"custom:title"),email:c(n,"email"),phone:c(n,"phone_number")})).sort((n,l)=>n.email.localeCompare(l.email))),m=p(()=>t.entities.map(n=>({id:n.CompanyId,name:n.CompanyName,domain:n.DomainName}))),b=p(()=>t.templates.map(({key:n})=>n)),u=g({year:i.value.year,quarter:i.value.quarter,state:i.value.status});return G(u,n=>{n&&(i.value.status=u.value.state,i.value.year=u.value.year,i.value.quarter=u.value.quarter)},{immediate:!0}),{proxy:i,consumerOptions:y,analystOptions:v,entityOptions:m,templateOptions:b,status:u}};x.components=Object.assign({TemplateSelect:pe,BatchCompanySelect:H,AnalystSelect:W,StatusInput:J,BatchEntitiesSelect:oe},x.components);var me=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",{staticClass:"flex flex-col divide-y"},[t("div",{staticClass:"flex flex-col divide-y"},[t("h3",{staticClass:"p-4 font-display text-lg font-semibold"},[e._v("Template")]),t("TemplateSelect",{attrs:{options:e.templateOptions},model:{value:e.proxy.template,callback:function(a){e.$set(e.proxy,"template",a)},expression:"proxy.template"}})],1),t("div",{staticClass:"flex flex-col divide-y"},[t("h3",{staticClass:"p-4 font-display text-lg font-semibold"},[e._v("Buyer Information")]),t("BatchCompanySelect",{attrs:{options:e.consumerOptions},model:{value:e.proxy.buyerCompany,callback:function(a){e.$set(e.proxy,"buyerCompany",a)},expression:"proxy.buyerCompany"}})],1),t("div",{staticClass:"flex flex-col divide-y"},[t("h3",{staticClass:"p-4 font-display text-lg font-semibold"},[e._v(" Analyst Information ")]),t("AnalystSelect",{attrs:{options:e.analystOptions},model:{value:e.proxy.analystInfo,callback:function(a){e.$set(e.proxy,"analystInfo",a)},expression:"proxy.analystInfo"}})],1),t("div",{staticClass:"flex flex-col divide-y"},[t("h3",{staticClass:"p-4 font-display text-lg font-semibold"},[e._v("Status")]),t("StatusInput",{model:{value:e.status,callback:function(a){e.status=a},expression:"status"}})],1),t("div",{staticClass:"flex flex-col divide-y"},[t("h3",{staticClass:"p-4 font-display text-lg font-semibold"},[e._v("Select Companies")]),t("BatchEntitiesSelect",{attrs:{options:e.entityOptions},model:{value:e.proxy.entities,callback:function(a){e.$set(e.proxy,"entities",a)},expression:"proxy.entities"}})],1)])},de=[];const j={};var ve=h(x,me,de,!1,ye,null,null,null);function ye(e){for(let s in j)this[s]=j[s]}const fe=function(){return ve.exports}(),C={};C.setup=(e,s)=>{const t=K("id"),a=g(!1),i=[O.list(),ee.list(t),Z.list()],y=X.get(t),v=te.list(),m=p(()=>{var o;return(o=v.data.value)==null?void 0:o.map(r=>({id:c(r,"sub"),email:c(r,"email"),name:c(r,"name"),title:c(r,"custom:title"),phone:c(r,"phone_number")})).find(r=>r.email==="consultingservices@whitehawk.com")}),b=O.read(t),u=p(()=>b.data.value),n=g(),l=p({get(){var d,_;if(n.value)return n.value;const o=new Date,r=o.getUTCFullYear(),f=`Q${Math.ceil((o.getMonth()+1)/4)}`;return{id:(d=u.value)==null?void 0:d.id,buyerCompany:u.value,analystInfo:m.value,template:((_=y.data.value)==null?void 0:_.split("/")[1])||"",year:r,quarter:"Q"+f,status:"IN_PROGRESS",includeCmmc:!0,entities:[]}},set(o){n.value=o}}),M=p(()=>l.value?!(l.value.entities.length>0&&l.value.analystInfo&&l.value.buyerCompany&&l.value.status&&l.value.template):!0);async function F(){var r,f,d,_,k,q,w,I,A;a.value=!0;const{data:o}=await P.post(`${T}/companies/${t.value}/batch/generate/scorecards-v2`,{id:(r=l.value)==null?void 0:r.id,buyerCompany:(f=l.value)==null?void 0:f.buyerCompany,analystInfo:(d=l.value)==null?void 0:d.analystInfo,status:{year:(_=l.value)==null?void 0:_.year,quarter:(k=l.value)==null?void 0:k.quarter,state:(q=l.value)==null?void 0:q.status},includeCmmc:(w=l.value)==null?void 0:w.includeCmmc,template:(I=l.value)==null?void 0:I.template,supplierInfos:(A=l.value)==null?void 0:A.entities});B(o.id),o&&B(o.id)}const N=Y();async function B(o){await Q(o),a.value=!1,N.push(`/admin/companies/${t.value}/scorecards/batch/rating-service-2/${o}`)}async function Q(o){let r=!0;do(await P.get(`${T}/companies/${t.value}/scorecards/docx/${o}/status`)).data.length===0?r=!1:await new Promise(d=>setTimeout(d,2e3));while(r)}return{isLoading:a,queries:i,users:v,batch:l,isDisabled:M,generate:F}};C.components=Object.assign({BackButton:U,BatchScorecardInputV2:fe,LoadingSpinner:z},C.components);var _e=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"space-y-6"},[t("div",{staticClass:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4"},[t("BackButton"),t("BaseTypography",{attrs:{variant:"h5",component:"h2"}},[e._v(" Create New Batch ")])],1),t("BaseSimpleCard",[t("BaseVueQueries",{attrs:{queries:e.queries},scopedSlots:e._u([{key:"success",fn:function(a){var i=a[0],y=a[1],v=a[2];return[t("form",{staticClass:"divide-y",on:{submit:function(m){return m.preventDefault(),e.generate.apply(null,arguments)}}},[t("BatchScorecardInputV2",{attrs:{users:e.users.data.value||[],companies:i,entities:y,templates:v},model:{value:e.batch,callback:function(m){e.batch=m},expression:"batch"}}),t("div",{staticClass:"p-4"},[t("BaseButton",{staticClass:"w-full md:w-auto",attrs:{disabled:e.isDisabled}},[e.isLoading?t("LoadingSpinner"):t("span",[e._v("Generate Batch")])],1)],1)],1)]}}])})],1)],1)},xe=[];const L={};var Ce=h(C,_e,xe,!1,he,null,null,null);function he(e){for(let s in L)this[s]=L[s]}const Pe=function(){return Ce.exports}();export{Pe as default};
