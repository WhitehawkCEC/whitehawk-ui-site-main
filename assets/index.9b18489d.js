import{F as j}from"./FormButton.081dcc42.js";import{b1 as C,d as c,n as v,aB as R,d3 as $,cc as F,ce as w,cn as h,bO as L,bs as N,c7 as K,ch as U,aF as M,aK as Q}from"./index.f48e1264.js";import{D as G}from"./DynamicForm.9ee4d711.js";import{A as Y}from"./ApiTokenInput.721d2de3.js";import{u as z}from"./useBitsightCompanies.17325e37.js";import{A as W}from"./ApiKeyInput.49b28e10.js";import{u as H}from"./useBlackKiteEntities.3985d1c5.js";import{D as J}from"./DateRangeInput.a683ebc2.js";import{D as X}from"./DateRangeDisplay.36138187.js";import{u as Z}from"./useAccountSubscriptionValidity.636933e1.js";import{s as V}from"./index.25c17ed3.js";import{a as ee}from"./index.019e5bef.js";import"./arrow-down-on-square.bf61cdc5.js";import"./trash.78f57a7a.js";import"./arrow-top-right-on-square.b063d2af.js";import"./ApiKeyDescriptionDisplay.b598d8a9.js";import"./ApiKeyValidation.acee26b3.js";import"./index.081b21a1.js";import"./index.c628febe.js";import"./index.7a54c9f6.js";import"./index.87e44ac4.js";import"./index.d28d773a.js";import"./index.5e42fa50.js";import"./IsoDateTimeDisplay.240d3b45.js";import"./index.3804f75d.js";const f={};f.props={value:{key:"value",required:!1,type:null},id:{key:"id",required:!0,type:String}};f.setup=(e,s)=>{const t=e,n=s.emit,i=c({get(){var l;return(l=t.value)==null?void 0:l.value},set(l){n("input",l?{value:l}:void 0)}}),u=c(()=>t.id),p=z.list(u),r=c(()=>p.data.value?p.data.value.map(l=>({text:l.data.shortname,value:l.data.guid})).sort((l,a)=>l.text.localeCompare(a.text)):[]);return{proxy:i,companies:r}};f.components=Object.assign({SimpleSelect:C},f.components);var te=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("SimpleSelect",{attrs:{options:e.companies},model:{value:e.proxy,callback:function(n){e.proxy=n},expression:"proxy"}})},se=[];const T={};var ne=v(f,te,se,!1,ae,null,null,null);function ae(e){for(let s in T)this[s]=T[s]}const ie=function(){return ne.exports}(),_={};_.props={id:{key:"id",required:!0,type:String},value:{key:"value",required:!1,type:null}};_.setup=(e,s)=>{const t=e,n=s.emit,i=R(t,n),u=c({get(){var r;return(r=t.value)==null?void 0:r.apiToken},set(r){r&&(i.value.apiToken=r)}}),p=c({get(){var r;return((r=t.value)==null?void 0:r.mappedEntityId.oneofKind)==="value"?t.value.mappedEntityId.value:void 0},set(r){i.value.mappedEntityId=r?{oneofKind:"value",value:r}:{oneofKind:void 0}}});return{proxy:i,apiToken:u,mappedEntityId:p}};_.components=Object.assign({ApiTokenInput:Y,UuidInput:ie},_.components);var oe=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"flex flex-col space-y-6"},[t("BaseLabel",[t("span",[e._v("API Token")]),t("ApiTokenInput",{staticClass:"w-full",model:{value:e.apiToken,callback:function(n){e.apiToken=n},expression:"apiToken"}})],1),t("BaseLabel",[t("span",{staticClass:"block"},[e._v("Mapped Entity ID")]),t("UuidInput",{staticClass:"w-full lg:max-w-sm",attrs:{id:e.id},model:{value:e.mappedEntityId,callback:function(n){e.mappedEntityId=n},expression:"mappedEntityId"}})],1),t("BaseLabel",[t("span",{staticClass:"block"},[e._v("Domain")]),t("BaseInput",{staticClass:"w-full lg:max-w-sm",model:{value:e.proxy.domain,callback:function(n){e.$set(e.proxy,"domain",n)},expression:"proxy.domain"}})],1)],1)},re=[];const E={};var ce=v(_,oe,re,!1,le,null,null,null);function le(e){for(let s in E)this[s]=E[s]}const ue=function(){return ce.exports}(),b={};b.props={value:{key:"value",required:!1,type:null}};b.setup=(e,s)=>{const t=e,n=s.emit,i=R(t,n),u=[{text:" ",value:$.ScanProfileType.UNSPECIFIED},{text:"Continuous 60-day",value:$.ScanProfileType.CONTINUOUS_60_DAY},{text:"Continuous Annual",value:$.ScanProfileType.CONTINUOUS_ANNUAL}];return{proxy:i,options:u}};b.components=Object.assign({SimpleSelect:C},b.components);var pe=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("SimpleSelect",{staticClass:"w-full",attrs:{options:e.options},model:{value:e.proxy,callback:function(n){e.proxy=n},expression:"proxy"}})},de=[];const q={};var me=v(b,pe,de,!1,ve,null,null,null);function ve(e){for(let s in q)this[s]=q[s]}const ye=function(){return me.exports}(),k={};k.props={id:{key:"id",required:!0,type:String},subId:{key:"subId",required:!0,type:String},value:{key:"value",required:!1,type:null}};k.setup=(e,s)=>{const t=e,n=s.emit,i=R(t,n),u=c(()=>t.id),p=c(()=>t.subId),r=F.read(u,p),l=c(()=>{var o;return(o=r.data.value)==null?void 0:o.type}),a=c({get(){var o;return(o=t.value)==null?void 0:o.apiKey},set(o){o&&(i.value.apiKey=o)}}),d=c({get(){var o;return(o=t.value)==null?void 0:o.licenseType},set(o){o&&(i.value.licenseType=o)}}),I=H.list(u),m=c(()=>I.data.value?I.data.value.map(({CompanyId:o,CompanyName:S})=>({text:S,value:o})).sort((o,S)=>o.text.localeCompare(S.text)):[]),y=c({get(){var o;return(o=t.value)==null?void 0:o.mappedEntityId},set(o){o&&(i.value.mappedEntityId=o)}});return{SubscriptionType:w.SubscriptionType,proxy:i,subscriptionType:l,apiKey:a,licenseType:d,entities:m,mappedEntityId:y}};k.components=Object.assign({ApiKeyInput:W,ScanProfileTypeInput:ye,SimpleSelect:C},k.components);var fe=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"flex flex-col space-y-6"},[t("BaseLabel",[t("span",[e._v("API Key")]),t("ApiKeyInput",{staticClass:"w-full",model:{value:e.apiKey,callback:function(n){e.apiKey=n},expression:"apiKey"}})],1),t("BaseLabel",[t("span",[e._v("License Type")]),t("ScanProfileTypeInput",{staticClass:"w-full lg:max-w-xs",model:{value:e.licenseType,callback:function(n){e.licenseType=n},expression:"licenseType"}})],1),e.subscriptionType===e.SubscriptionType.INDIVIDUAL?t("BaseLabel",[t("span",{staticClass:"block"},[e._v("Mapped Entity ID")]),t("SimpleSelect",{staticClass:"w-full lg:max-w-sm",attrs:{options:e.entities},model:{value:e.mappedEntityId,callback:function(n){e.mappedEntityId=n},expression:"mappedEntityId"}})],1):e._e(),t("BaseLabel",[t("span",{staticClass:"block"},[e._v("Domain")]),t("BaseInput",{staticClass:"w-full lg:max-w-sm",model:{value:e.proxy.domain,callback:function(n){e.$set(e.proxy,"domain",n)},expression:"proxy.domain"}})],1)],1)},_e=[];const D={};var be=v(k,fe,_e,!1,ke,null,null,null);function ke(e){for(let s in D)this[s]=D[s]}const ge=function(){return be.exports}(),g={};g.props={id:{key:"id",required:!0,type:String},subId:{key:"subId",required:!0,type:String},value:{key:"value",required:!1,type:null}};g.setup=(e,s)=>{const t=e,n=s.emit,i=R(t,n),u=c({get(){var a;return(a=t.value)==null?void 0:a.value.oneofKind},set(a){if(a==="cyberRiskRatingBk")i.value={value:{oneofKind:"cyberRiskRatingBk",cyberRiskRatingBk:h.CyberRiskRatingBlackKiteConfig.create()}};else if(a==="cyberRiskRatingBs")i.value={value:{oneofKind:"cyberRiskRatingBs",cyberRiskRatingBs:h.CyberRiskRatingBitsightConfig.create()}};else throw new Error(`Unhandled case: ${a}`)}}),p=c({get(){var d;const a=(d=t.value)==null?void 0:d.value;if((a==null?void 0:a.oneofKind)==="cyberRiskRatingBk")return a.cyberRiskRatingBk},set(a){a?i.value={value:{oneofKind:"cyberRiskRatingBk",cyberRiskRatingBk:a}}:i.value={value:{oneofKind:void 0}}}}),r=c({get(){var d;const a=(d=t.value)==null?void 0:d.value;if((a==null?void 0:a.oneofKind)==="cyberRiskRatingBs")return a.cyberRiskRatingBs},set(a){a?i.value={value:{oneofKind:"cyberRiskRatingBs",cyberRiskRatingBs:a}}:i.value={value:{oneofKind:void 0}}}});return{type:u,blackKite:p,bitsight:r,typeOptions:[{text:"Cyber Risk (Black Kite)",value:"cyberRiskRatingBk"},{text:"Cyber Risk (BitSight)",value:"cyberRiskRatingBs"}]}};g.components=Object.assign({SimpleSelect:C,CyberRiskRatingBlackKiteConfigInput:ge,CyberRiskRatingBitsightConfigInput:ue},g.components);var xe=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"space-y-6"},[t("BaseLabel",[t("span",[e._v("Type")]),t("SimpleSelect",{staticClass:"w-full lg:max-w-sm",attrs:{options:e.typeOptions},model:{value:e.type,callback:function(n){e.type=n},expression:"type"}})],1),e.type==="cyberRiskRatingBk"?[t("CyberRiskRatingBlackKiteConfigInput",{attrs:{id:e.id,"sub-id":e.subId},model:{value:e.blackKite,callback:function(n){e.blackKite=n},expression:"blackKite"}})]:e.type==="cyberRiskRatingBs"?[t("CyberRiskRatingBitsightConfigInput",{attrs:{id:e.id},model:{value:e.bitsight,callback:function(n){e.bitsight=n},expression:"bitsight"}})]:e._e()],2)},Re=[];const A={};var Ie=v(g,xe,Re,!1,Be,null,null,null);function Be(e){for(let s in A)this[s]=A[s]}const Ce=function(){return Ie.exports}(),x={};x.props={id:{key:"id",required:!0,type:String},subId:{key:"subId",required:!0,type:String},value:{key:"value",required:!0,type:null}};x.setup=(e,s)=>{const t=e,n=s.emit,i=R(t,n),u=c(()=>t.id),p=c(()=>t.subId),r=[{name:"name",label:"Name",component:{is:L,attrs:{required:!0,class:"w-full lg:max-w-sm"}}},{name:"validity",label:"Validity",component:{is:J,attrs:{required:!0}}},{name:"config",label:"Config",component:{is:Ce,attrs:{required:!0,id:u.value,subId:p.value}}}];return{proxy:i,schema:r}};x.components=Object.assign({DynamicForm:G},x.components);var Se=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("DynamicForm",{attrs:{schema:e.schema},model:{value:e.proxy,callback:function(n){e.proxy=n},expression:"proxy"}})},$e=[];const O={};var he=v(x,Se,$e,!1,Ke,null,null,null);function Ke(e){for(let s in O)this[s]=O[s]}const Te=function(){return he.exports}(),B={};B.setup=(e,s)=>{const t=K("id"),n=K("subscriptionId"),i=new Date,u=ee(i,1),p=Z.get(t,n),r=V(c(()=>{var m,y;return{name:"",config:{value:{oneofKind:"cyberRiskRatingBk",cyberRiskRatingBk:h.CyberRiskRatingBlackKiteConfig.create()}},validity:{start:{value:i.toISOString()},end:{value:((y=(m=p.data.value)==null?void 0:m.end)==null?void 0:y.value)||u.toISOString()}}}})),l=U.create(t,n),a=M(),d=Q();async function I(){if(r.value){const{response:m}=await l.mutateAsync(r.value);if(a.success("Created product"),m&&m.productId){const y=m.productId.value;d.push({path:`../${y}/settings`,append:!0})}}}return{id:t,subscriptionId:n,validityGet:p,createRequest:r,submit:I}};B.components=Object.assign({BackButton:N,DateRangeDisplay:X,SubscriptionProductPartialCreateRequestInput:Te,FormButton:j},B.components);var Ee=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",{staticClass:"space-y-6"},[t("BackButton",{attrs:{link:`/admin/companies/${e.id}/subscriptions/${e.subscriptionId}`}}),t("BaseSimpleCard",{staticClass:"divide-y"},[t("div",{staticClass:"flex flex-col p-4"},[t("BaseVueQuery",{attrs:{query:e.validityGet},scopedSlots:e._u([{key:"success",fn:function(n){var i=n.data;return[t("BaseTypography",{staticClass:"text-gray-500",attrs:{variant:"overline"}},[t("DateRangeDisplay",{attrs:{value:i}})],1)]}}])}),t("BaseTypography",{attrs:{variant:"subtitle3"}},[e._v(" Create Subscription Product ")])],1),t("form",{staticClass:"divide-y",on:{submit:function(n){return n.preventDefault(),e.submit.apply(null,arguments)}}},[t("SubscriptionProductPartialCreateRequestInput",{attrs:{id:e.id,"sub-id":e.subscriptionId},model:{value:e.createRequest,callback:function(n){e.createRequest=n},expression:"createRequest"}}),t("FormButton",{attrs:{action:"create"}})],1)])],1)},qe=[];const P={};var De=v(B,Ee,qe,!1,Ae,null,null,null);function Ae(e){for(let s in P)this[s]=P[s]}const ot=function(){return De.exports}();export{ot as default};
