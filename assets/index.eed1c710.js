import{c as m,n as B,bR as I,aI as E,aS as D,ao as N,bQ as h,aF as R,r as T}from"./index.fc55cc4e.js";import{B as W}from"./BasicModal.3ab6e187.js";import{E as q}from"./exclamation-triangle.54812a62.js";import{A as V,T as O}from"./AppTanStackTable.68292bec.js";import{I as Q}from"./IsoDateTimeDisplay.e9c6838f.js";import{c as H}from"./createOnChangeFn.0cc5c1a4.js";import{u as L}from"./createSimpleTable.a6fc7c41.js";import"./magnifying-glass.b7cbe8fe.js";import"./TransitionExpand.666d84b4.js";import"./chevron-up.736f4142.js";const v={};v.props={bundlesTemplate:{key:"bundlesTemplate",required:!1,type:Array},products:{key:"products",required:!1,type:Array},categoryToBeDeleted:{key:"categoryToBeDeleted",required:!1,type:String}};v.setup=(e,a)=>{const t=e;return{toggleText:m(()=>{var n,p;return!!(((n=t==null?void 0:t.bundlesTemplate)==null?void 0:n.length)||((p=t==null?void 0:t.products)==null?void 0:p.length))})}};v.components=Object.assign({WarningSvg:q},v.components);var z=function(){var e=this,a=e.$createElement,t=e._self._c||a;return e.categoryToBeDeleted?t("div",{staticClass:"flex flex-col items-center justify-center space-y-8 px-5"},[t("BaseIcon",{staticClass:"mx-auto max-w-min lg:mx-0 lg:max-w-none",attrs:{color:"danger",shape:"round"}},[t("WarningSvg",{staticClass:"h-auto w-5"})],1),t("BaseTypography",{staticClass:"text-gray-500",attrs:{component:"h2",variant:"subtitle3"}},[e._v(" Are you sure you want to delete "),t("span",{staticClass:"text-red-500"},[e._v(e._s(e.categoryToBeDeleted))]),e._v(" category? "),e.toggleText?t("span",[e._v(" These bundle templates and products will be without category. ")]):e._e()]),e.toggleText?t("div",{staticClass:"grid grid-cols-1 sm:grid-cols-2 sm:gap-16"},[t("ul",{staticClass:"mx-auto"},[t("BaseTypography",{attrs:{component:"h2",variant:"subtitle3"}},[t("BaseTypography",{staticClass:"text-gray-00 pb-2 text-center",attrs:{component:"h2",variant:"subtitle3"}},[e._v(" Bundle Templates: ")]),e._l(e.bundlesTemplate,function(i,n){return t("li",{key:n,staticClass:"flex justify-center space-x-2 border border-gray-300 p-1"},[t("BaseTypography",{staticClass:"text-gray-500",attrs:{component:"span",variant:"p1"}},[e._v(" "+e._s(i)+" ")])],1)})],2)],1),t("ul",{staticClass:"mx-auto"},[t("BaseTypography",{attrs:{component:"h2",variant:"subtitle3"}},[t("BaseTypography",{staticClass:"pb-2 text-center",attrs:{component:"h2",variant:"subtitle3"}},[e._v(" Products: ")]),e._l(e.products,function(i,n){return t("li",{key:n,staticClass:"flex justify-center space-x-2 border border-gray-300 p-1"},[t("BaseTypography",{staticClass:"text-gray-500",attrs:{component:"span",variant:"p1"}},[e._v(" "+e._s(i)+" ")])],1)})],2)],1)]):e._e()],1):e._e()},U=[];const P={};var G=B(v,z,U,!1,J,null,null,null);function J(e){for(let a in P)this[a]=P[a]}const K=function(){return G.exports}(),f={};f.props={categories:{key:"categories",required:!0,type:Array}};f.setup=(e,a)=>{const t=e,{categories:i}=I(t),n=a.emit,p=E(),o=H(),x=[o.accessor(r=>{var l;return(l=r.id)==null?void 0:l.value},{id:"id",header:()=>"ID",enableColumnFilter:!1}),o.accessor("name",{header:()=>"Name",enableColumnFilter:!1}),o.accessor(r=>{var l;return(l=r.meta)==null?void 0:l.updatedAt},{id:"updatedAt",header:()=>"Last Updated",cell:r=>D(Q,{props:{value:r.getValue(),format:"date"}}),enableColumnFilter:!1}),o.accessor("description",{header:()=>"Description",enableColumnFilter:!1}),o.display({id:"actions",header:"Actions",cell:({row:r})=>D(O,{props:{actions:[{id:"edit",action(){var l;p.push(`/admin/products/categories/${(l=r.original.id)==null?void 0:l.value}`)}},{id:"delete",action(){n("delete",r.original)}}]}})})];return{instance:L(i,x)}};f.components=Object.assign({AppTanStackTable:V},f.components);var X=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("AppTanStackTable",{attrs:{table:e.instance}})},Y=[];const k={};var Z=B(f,X,Y,!1,ee,null,null,null);function ee(e){for(let a in k)this[a]=k[a]}const te=function(){return Z.exports}(),b={};b.setup=(e,a)=>{const t=h.list(),i=m(()=>t.data.value?t.data.value.sort((s,c)=>s.name.localeCompare(c.name)):[]),n=R(),p=h.delete(),o=T(),x=T();function $(s){var c;o.value={category:{...s}},x.value=(c=s==null?void 0:s.id)==null?void 0:c.value,C.value=!0}const r=m(()=>h.listIsolatedBundlesAndProducts(x.value)),l=m(()=>{var y,g,_,u;const s=(_=(g=(y=r.value)==null?void 0:y.data)==null?void 0:g.value)==null?void 0:_.bundleTemplates;return(u=s==null?void 0:s.map(d=>d==null?void 0:d.name))==null?void 0:u.sort((d,F)=>d.localeCompare(F))}),M=m(()=>{var y,g,_;const s=(_=(g=(y=r.value)==null?void 0:y.data)==null?void 0:g.value)==null?void 0:_.products;return s==null?void 0:s.map(u=>u==null?void 0:u.name).sort((u,d)=>u.localeCompare(d))}),S=m(()=>{var s,c;return(c=(s=o==null?void 0:o.value)==null?void 0:s.category)==null?void 0:c.name});async function j(){if(o.value)await p.mutateAsync(o.value),w(),n.success(`Category ${S.value}successfully deleted`);else throw new Error("Invalid request.")}const C=T(!1);function w(){C.value=!1}return{categories:i,setPayload:$,bundlesWithoutCategory:l,productsWithoutCategory:M,categoryToBeDeleted:S,deleteCategory:j,isModalVisible:C,closeModal:w}};b.components=Object.assign({PlusSvg:N,ProductCategoriesTable:te,BasicModal:W,ProductCategeoriesDeletionMessage:K},b.components);var ae=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("section",[t("BaseTablePageLayout",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v("Product Categories")]},proxy:!0},{key:"button",fn:function(){return[t("BaseButton",{staticClass:"space-x-1",attrs:{to:"/admin/products/categories/new"}},[t("PlusSvg",{staticClass:"mr-1 w-5 xl:w-5"}),e._v(" Category ")],1)]},proxy:!0},{key:"table",fn:function(){return[t("ProductCategoriesTable",{attrs:{categories:e.categories},on:{delete:e.setPayload}})]},proxy:!0}])}),t("BasicModal",{directives:[{name:"show",rawName:"v-show",value:e.isModalVisible,expression:"isModalVisible"}],on:{close:e.closeModal},scopedSlots:e._u([{key:"body",fn:function(){return[t("div",{staticClass:"flex flex-col space-y-4"},[t("ProductCategeoriesDeletionMessage",{attrs:{"bundles-template":e.bundlesWithoutCategory,products:e.productsWithoutCategory,"category-to-be-deleted":e.categoryToBeDeleted}}),t("div",{staticClass:"flex justify-center py-6"},[t("BaseButton",{attrs:{"display-type":"danger",action:"secondary"},on:{click:e.deleteCategory}},[e._v(" Delete Category ")])],1)],1)]},proxy:!0}])})],1)},se=[];const A={};var oe=B(b,ae,se,!1,re,null,null,null);function re(e){for(let a in A)this[a]=A[a]}const _e=function(){return oe.exports}();export{_e as default};
