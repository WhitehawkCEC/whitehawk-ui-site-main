import{aT as $,aD as w,ag as j,aP as b,aQ as S,br as q,aO as V,n as M,c as F,aI as N,aF as D,aS as g,bS as E,ao as O,r as x}from"./index.8f6ec485.js";import{B as L}from"./BasicConfirmModal.2ae0e957.js";import{A as z,R as H}from"./RowSelectionInput.cce06055.js";import{A as U,T as X}from"./AppTanStackTable.7825a901.js";import{c as Y}from"./createOnChangeFn.df2c9a93.js";import{u as G}from"./useProducts.8523b86d.js";import{u as J}from"./createSimpleTable.060ef3d9.js";import{u as A}from"./useManufacturers.0bcb4eca.js";import"./exclamation-triangle.54812a62.js";import"./BasicModal.930d8442.js";import"./magnifying-glass.b7cbe8fe.js";import"./TransitionExpand.3ed92a1e.js";import"./chevron-up.736f4142.js";const k={create(){const e=$();return w(s=>b.post(`${S}/featured-manufacturers`,s).then(a=>a.data),{onSuccess(){e.invalidateQueries(["manufacturers"],{exact:!0})}})},delete(){const e=$();return w(s=>b.delete(`${S}/featured-manufacturers/${s}`).then(a=>a.data),{onSuccess(){e.invalidateQueries(["manufacturers"],{exact:!0})}})},list(){return j(["featured-manufacturers"],()=>b.get(`${S}/featured-manufacturers`).then(e=>e.data))}},f={};f.props={value:{key:"value",required:!1,type:String},remove:{key:"remove",required:!0,type:Function}};f.setup=(e,s)=>({});f.components=Object.assign({DateIsoStringDisplay:q,XSvg:V},f.components);var K=function(){var e=this,s=e.$createElement,a=e._self._c||s;return e.value?a("div",{staticClass:"flex items-center space-x-1"},[a("DateIsoStringDisplay",{staticClass:"inline-flex items-center rounded bg-indigo-100 px-2 py-0.5 text-xs font-medium uppercase leading-4 tracking-widest text-indigo-800",attrs:{value:e.value,format:"date"}}),a("BaseIcon",{attrs:{color:"danger",size:"small",action:"secondary"},on:{click:e.remove}},[a("XSvg",{staticClass:"w-3"})],1)],1):e._e()},W=[];const T={};var Z=M(f,K,W,!1,ee,null,null,null);function ee(e){for(let s in T)this[s]=T[s]}const te=function(){return Z.exports}(),m={};m.props={manufacturers:{key:"manufacturers",required:!0,type:Array}};m.setup=(e,s)=>{const a=e,o=s.emit,l=F(()=>a.manufacturers.map(t=>{const{id:n,name:u,url:y,featured:Q}=t;return{id:n,name:u,url:y,featured:Q,productCount:P(n)}})),d=G.list(),p=F(()=>d.data.value||[]),c=N(),i=D(),_=k.create(),v=k.delete(),r=Y(),I=[r.display({id:"select",header:({table:t})=>g(z,{props:{table:t}}),cell:({row:t})=>g(H,{props:{row:t}})}),r.accessor("id",{header:()=>"ID",enableColumnFilter:!1}),r.accessor("name",{header:()=>"Name",enableColumnFilter:!1}),r.accessor("url",{header:()=>"URL",enableColumnFilter:!1}),r.accessor(t=>t.featured,{id:"featured",header:()=>"Featured",cell:t=>g(te,{props:{value:t.getValue(),async remove(){await v.mutateAsync(t.row.original.id)&&i.success("Featured removed successfully.")}}}),enableColumnFilter:!1}),r.accessor(t=>t.productCount,{id:"productCount",header:()=>"Product Count",enableColumnFilter:!1}),r.display({id:"actions",header:"Actions",cell:({row:t})=>g(X,{props:{actions:[{id:"view",action(){c.push(`/admin/manufacturers/${t.original.id}/products`)}},{id:"edit",action(){c.push(`/admin/manufacturers/${t.original.id}`)}},{id:"delete",action(){o("delete",t.original)}},{id:"setFeatured",async action(){await _.mutateAsync({id:t.original.id,name:t.original.name})&&i.success("Successfully featured manufacturer.")}}].filter(n=>t.original.featured?n.id!=="setFeatured"&&n.id!=="delete":t.original.productCount>1&&!t.original.featured?n.id!=="delete":n)}})})],C=J(l,I);function P(t){const n=[];return p.value.map(u=>{u.manufacturer.id===t&&n.push(u)}),n.length}return{instance:C,bulkActions:[{id:"setFeatured",async action(){const t=C.getSelectedRowModel().rows,n=[];if(t.length>0){for(const u of t)if(!u.original.featured){const y=await _.mutateAsync({id:u.original.id,name:u.original.name});y&&n.push(y.id)}i.success(`Successfully Featured ${n.length}/${t.length} Manufacturers(s).`)}else i.error("You must select a row.")}}]}};m.components=Object.assign({AppTanStackTable:U},m.components);var ae=function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("AppTanStackTable",{attrs:{table:e.instance,"table-actions":e.bulkActions}})},se=[];const B={};var ne=M(m,ae,se,!1,re,null,null,null);function re(e){for(let s in B)this[s]=B[s]}const ue=function(){return ne.exports}(),h={};h.setup=(e,s)=>{const a=A.list(),o=D(),l=A.delete(),d=x(""),p=x(""),c=x(!1);function i(r){d.value=r.id,p.value=r.name,c.value=!0}async function _(){d?(await l.mutateAsync(d.value),v(),o.success("Successfully deleted manufacturer.")):o.error("Something went wrong.")}function v(){c.value=!1}return{manufacturers:a,manufacturerName:p,isModalVisible:c,toggleModal:i,deleteManufacturer:_,closeModal:v}};h.components=Object.assign({BaseTablePageLayout:E,PlusSvg:O,ManufacturersTable:ue,BasicConfirmModal:L},h.components);var oe=function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("section",[a("BaseTablePageLayout",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v("Manufacturers")]},proxy:!0},{key:"button",fn:function(){return[a("BaseButton",{staticClass:"w-full space-x-2 md:w-auto",attrs:{to:"/admin/manufacturers/new"}},[a("PlusSvg",{staticClass:"h-auto w-4 xl:w-5"}),a("span",[e._v("Manufacturer")])],1)]},proxy:!0},{key:"table",fn:function(){return[a("BaseVueQuery",{attrs:{query:e.manufacturers},scopedSlots:e._u([{key:"success",fn:function(o){var l=o.data;return[a("ManufacturersTable",{attrs:{manufacturers:l},on:{delete:e.toggleModal}})]}}])})]},proxy:!0}])}),a("BasicConfirmModal",{directives:[{name:"show",rawName:"v-show",value:e.isModalVisible,expression:"isModalVisible"}],attrs:{name:e.manufacturerName},on:{delete:e.deleteManufacturer,close:e.closeModal}})],1)},ce=[];const R={};var ie=M(h,oe,ce,!1,le,null,null,null);function le(e){for(let s in R)this[s]=R[s]}const $e=function(){return ie.exports}();export{$e as default};
