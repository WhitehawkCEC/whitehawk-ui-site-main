import{E as V}from"./exclamation-triangle.54812a62.js";import{aT as T,aD as I,ag as O,aP as F,aQ as $,br as L,aO as z,n as B,bR as H,aI as U,aF as Q,aS as b,aZ as w,bS as W,ao as X,r as R,bT as G,c as k}from"./index.d43a5311.js";import{B as Y}from"./BasicModal.d9b387dd.js";import{A as Z,R as J}from"./RowSelectionInput.b85d4eda.js";import{A as K,T as ee}from"./AppTanStackTable.1815d5f1.js";import{u as te,c as ae,i as S,r as se,h as ne,g as re,f as oe,e as ue,d as ce}from"./createOnChangeFn.6d17c86d.js";import{u as D}from"./useManufacturers.a6cd3056.js";import"./magnifying-glass.b7cbe8fe.js";import"./TransitionExpand.781ea287.js";import"./chevron-up.736f4142.js";const j={create(){const e=T();return I(s=>F.post(`${$}/featured-manufacturers`,s).then(t=>t.data),{onSuccess(){e.invalidateQueries(["manufacturers"],{exact:!0})}})},delete(){const e=T();return I(s=>F.delete(`${$}/featured-manufacturers/${s}`).then(t=>t.data),{onSuccess(){e.invalidateQueries(["manufacturers"],{exact:!0})}})},list(){return O(["featured-manufacturers"],()=>F.get(`${$}/featured-manufacturers`).then(e=>e.data))}},d={};d.props={value:{key:"value",required:!1,type:String},remove:{key:"remove",required:!0,type:Function}};d.setup=(e,s)=>({});d.components=Object.assign({DateIsoStringDisplay:L,XSvg:z},d.components);var le=function(){var e=this,s=e.$createElement,t=e._self._c||s;return e.value?t("div",{staticClass:"flex items-center space-x-1"},[t("DateIsoStringDisplay",{staticClass:"inline-flex items-center rounded bg-indigo-100 px-2 py-0.5 text-xs font-medium uppercase leading-4 tracking-widest text-indigo-800",attrs:{value:e.value,format:"date"}}),t("BaseIcon",{attrs:{color:"danger",size:"small",action:"secondary"},on:{click:e.remove}},[t("XSvg",{staticClass:"w-3"})],1)],1):e._e()},ie=[];const N={};var de=B(d,le,ie,!1,fe,null,null,null);function fe(e){for(let s in N)this[s]=N[s]}const me=function(){return de.exports}(),f={};f.props={manufacturers:{key:"manufacturers",required:!0,type:Array}};f.setup=(e,s)=>{const t=e,o=s.emit,{manufacturers:n}=H(t),m=U(),l=Q(),u=j.create(),p=j.delete(),c=ae(),C=[c.display({id:"select",header:({table:a})=>b(Z,{props:{table:a}}),cell:({row:a})=>b(J,{props:{row:a}})}),c.accessor("id",{header:()=>"Id",enableColumnFilter:!1}),c.accessor("name",{header:()=>"Name",enableColumnFilter:!1}),c.accessor("url",{header:()=>"URL",enableColumnFilter:!1}),c.accessor(a=>a.featured,{id:"featured",header:()=>"Featured",cell:a=>b(me,{props:{value:a.getValue(),async remove(){await p.mutateAsync(a.row.original.id)&&(l.success("Featured removed successfully."),window.location.reload())}}}),enableColumnFilter:!1}),c.display({id:"actions",header:"Actions",cell:({row:a})=>b(ee,{props:{actions:[{id:"view",action(){m.push(`/admin/manufacturers/${a.original.id}/products`)}},{id:"edit",action(){m.push(`/admin/manufacturers/${a.original.id}`)}},{id:"delete",action(){o("delete",a.original)}},{id:"setFeatured",async action(){await u.mutateAsync({id:a.original.id,name:a.original.name})&&l.success("Successfully featured manufacturer.")}}].filter(r=>a.original.featured?r.id!=="setFeatured":r)}})})],g=w([]),_=w({pageIndex:0,pageSize:10}),v=w(""),y=w({}),h=te({get data(){return n.value},columns:C,state:{get sorting(){return g.value},get pagination(){return _.value},get globalFilter(){return v.value},get rowSelection(){return y.value}},onSortingChange:S(g),onPaginationChange:S(_),onGlobalFilterChange:S(v),globalFilterFn:(a,r,i,x)=>{const A=se(a.getValue(r),i,{threshold:ne.CONTAINS});return x(A),A.passed},onRowSelectionChange:S(y),getCoreRowModel:re(),getSortedRowModel:oe(),getPaginationRowModel:ue(),getFilteredRowModel:ce()});return{instance:h,bulkActions:[{id:"setFeatured",async action(){const a=h.getSelectedRowModel().rows,r=[];if(a.length>0){for(const i of a)if(!i.original.featured){const x=await u.mutateAsync({id:i.original.id,name:i.original.name});x&&r.push(x.id)}l.success(`Successfully Featured ${r.length}/${a.length} Manufacturers(s).`),window.location.reload()}else l.error("You must select a row.")}}]}};f.components=Object.assign({AppTanStackTable:K},f.components);var pe=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("AppTanStackTable",{attrs:{table:e.instance,"table-actions":e.bulkActions}})},ge=[];const q={};var _e=B(f,pe,ge,!1,ve,null,null,null);function ve(e){for(let s in q)this[s]=q[s]}const ye=function(){return _e.exports}(),M={};M.setup=(e,s)=>{const t=R(),o=R(),n=R(!1),m=D.list(),l=G.list(t),u=k(()=>l.data.value),p=k(()=>u!=null&&u.value?u.value.length:0);function c(h){const{id:P,name:a}=h;t.value=P,o.value=a,n.value=!0}const C=D.delete(t),g=Q();async function _(){if(t)await C.mutateAsync(),g.success("Successfully deleted manufacturer.");else throw new Error("Invalid request.")}function v(){n.value=!1}const y=k(()=>p.value>=1);return{manufacturerId:t,manufacturerName:o,isModalVisible:n,manufacturers:m,manufacturerTotalProducts:u,totalProducts:p,setPayload:c,deleteManufacturer:_,closeModal:v,totalProductByManufacturer:y}};M.components=Object.assign({BaseTablePageLayout:W,PlusSvg:X,ManufacturersTable:ye,BasicModal:Y,WarningSvg:V},M.components);var he=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("section",[t("BaseTablePageLayout",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v("Manufacturers")]},proxy:!0},{key:"button",fn:function(){return[t("BaseButton",{staticClass:"w-full space-x-2 md:w-auto",attrs:{to:"/admin/manufacturers/new"}},[t("PlusSvg",{staticClass:"h-auto w-4 xl:w-5"}),t("span",[e._v("Add Manufacturer")])],1)]},proxy:!0},{key:"table",fn:function(){return[t("BaseVueQuery",{attrs:{query:e.manufacturers},scopedSlots:e._u([{key:"success",fn:function(o){var n=o.data;return[t("ManufacturersTable",{attrs:{manufacturers:n},on:{delete:e.setPayload}})]}}])})]},proxy:!0}])}),t("BasicModal",{directives:[{name:"show",rawName:"v-show",value:e.isModalVisible,expression:"isModalVisible"}],on:{close:e.closeModal},scopedSlots:e._u([{key:"body",fn:function(){return[t("div",{staticClass:"flex flex-col items-center justify-center space-y-8 px-5"},[t("BaseIcon",{staticClass:"mx-auto max-w-min lg:mx-0 lg:max-w-none",attrs:{color:"danger",shape:"round"}},[t("WarningSvg",{staticClass:"h-auto w-5"})],1),t("BaseTypography",{staticClass:"text-gray-500",attrs:{component:"h2",variant:"subtitle3"}},[e._v(" Are you sure you want to delete "),t("span",{staticClass:"text-red-500"},[e._v(e._s(e.manufacturerName))]),e._v(" manufacturer? "),e.totalProductByManufacturer?t("span",[t("span",{staticClass:"text-red-500"},[e._v(e._s(e.manufacturerName))]),e._v(" has the following "),t("span",{staticClass:"text-red-500"},[e._v(" "+e._s(e.totalProducts)+" ")]),e._v(" products. Please delete these Products first. ")]):e._e()]),e.totalProductByManufacturer?t("ul",[t("BaseTypography",{attrs:{component:"h2",variant:"subtitle3"}},[t("BaseTypography",{staticClass:"pb-2 text-center",attrs:{component:"h2",variant:"subtitle3"}},[e._v(" Products: ")]),e._l(e.manufacturerTotalProducts,function(o,n){return t("li",{key:n,staticClass:"flex justify-center space-x-2 border border-gray-300 px-4"},[t("BaseLink",{staticClass:"text-gray-500",attrs:{to:`/admin/manufacturers/${e.manufacturerId}/products`}},[e._v(" "+e._s(o.name)+" ")])],1)})],2)],1):e._e(),t("div",{staticClass:"py-4"},[t("BaseButton",{attrs:{disabled:e.totalProductByManufacturer,"display-type":"danger",action:"secondary"},on:{click:e.deleteManufacturer}},[e._v(" Delete Manufacturer ")])],1)],1)]},proxy:!0}])})],1)},xe=[];const E={};var be=B(M,he,xe,!1,we,null,null,null);function we(e){for(let s in E)this[s]=E[s]}const Te=function(){return be.exports}();export{Te as default};
