import{bT as F,aJ as I,aT as S,n as N,ao as D,bS as A,c as p,aG as V,r as h,bU as j}from"./index.2cafd56c.js";import{B as E}from"./BasicConfirmModal.381d4dcc.js";import{A as R,T as W}from"./AppTanStackTable.6db3b074.js";import{I as L}from"./IsoDateTimeDisplay.4089d4a0.js";import{c as q}from"./createOnChangeFn.b1b54b6d.js";import{u as H}from"./createSimpleTable.f710d83a.js";import"./BasicModal.80d4891d.js";import"./magnifying-glass.b7cbe8fe.js";import"./TransitionExpand.0c148b5a.js";import"./chevron-up.736f4142.js";const f={};f.props={categories:{key:"categories",required:!0,type:Array}};f.setup=(e,s)=>{const a=e,{categories:g}=F(a),y=s.emit,C=I(),o=q(),v=[o.accessor(n=>{var r;return(r=n.id)==null?void 0:r.value},{id:"id",header:()=>"ID",enableColumnFilter:!1}),o.accessor("name",{header:()=>"Name",enableColumnFilter:!1}),o.accessor(n=>{var r;return(r=n.meta)==null?void 0:r.updatedAt},{id:"updatedAt",header:()=>"Last Updated",cell:n=>S(L,{props:{value:n.getValue(),format:"date"}}),enableColumnFilter:!1}),o.accessor("description",{header:()=>"Description",enableColumnFilter:!1}),o.display({id:"actions",header:"Actions",cell:({row:n})=>S(W,{props:{actions:[{id:"edit",action(){var r;C.push(`/admin/products/categories/${(r=n.original.id)==null?void 0:r.value}`)}},{id:"delete",action(){y("delete",n.original)}}]}})})];return{instance:H(g,v)}};f.components=Object.assign({AppTanStackTable:R},f.components);var O=function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("AppTanStackTable",{attrs:{table:e.instance}})},Q=[];const $={};var U=N(f,O,Q,!1,z,null,null,null);function z(e){for(let s in $)this[s]=$[s]}const G=function(){return U.exports}(),_={};_.setup=(e,s)=>{const a=A.list(),g=p(()=>a.data.value?a.data.value.sort((t,c)=>t.name.localeCompare(c.name)):[]),y=V(),C=A.delete(),o=h(),v=h();function x(t){var c;o.value={category:{...t}},v.value=(c=t==null?void 0:t.id)==null?void 0:c.value,b.value=!0}const n=p(()=>j.get(v.value)),r=p(()=>{var u,d,m,l;const t=(m=(d=(u=n.value)==null?void 0:u.data)==null?void 0:d.value)==null?void 0:m.bundleSets;return(l=t==null?void 0:t.map(i=>i==null?void 0:i.name))==null?void 0:l.sort((i,k)=>i.localeCompare(k))}),w=p(()=>{var u,d,m;const t=(m=(d=(u=n.value)==null?void 0:u.data)==null?void 0:d.value)==null?void 0:m.products;return t==null?void 0:t.map(l=>l==null?void 0:l.name).sort((l,i)=>l.localeCompare(i))}),T=p(()=>{var t,c;return(c=(t=o==null?void 0:o.value)==null?void 0:t.category)==null?void 0:c.name});async function B(){if(o.value)await C.mutateAsync(o.value),P(),y.success(`Category ${T.value}successfully deleted`);else throw new Error("Invalid request.")}const b=h(!1);function P(){b.value=!1}return{categories:g,setPayload:x,bundlesWithoutCategory:r,productsWithoutCategory:w,categoryName:T,deleteCategory:B,isModalVisible:b,closeModal:P}};_.components=Object.assign({PlusSvg:D,ProductCategoriesTable:G,BasicConfirmModal:E},_.components);var J=function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("section",[a("BaseTablePageLayout",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v("Product Categories")]},proxy:!0},{key:"button",fn:function(){return[a("BaseButton",{staticClass:"space-x-1",attrs:{to:"/admin/products/categories/new"}},[a("PlusSvg",{staticClass:"mr-1 w-5 xl:w-5"}),e._v(" Category ")],1)]},proxy:!0},{key:"table",fn:function(){return[a("ProductCategoriesTable",{attrs:{categories:e.categories},on:{delete:e.setPayload}})]},proxy:!0}])}),a("BasicConfirmModal",{directives:[{name:"show",rawName:"v-show",value:e.isModalVisible,expression:"isModalVisible"}],attrs:{name:e.categoryName,"bundles-template":e.bundlesWithoutCategory,products:e.productsWithoutCategory},on:{click:e.deleteCategory,close:e.closeModal}})],1)},K=[];const M={};var X=N(_,J,K,!1,Y,null,null,null);function Y(e){for(let s in M)this[s]=M[s]}const ie=function(){return X.exports}();export{ie as default};
