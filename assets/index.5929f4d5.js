import{aB as R,n as h,ax as D,d as c,bs as L,L as P,c7 as g,du as j,b as M,bG as S,dn as x,aK as V}from"./index.454062da.js";import{A as Q,S as F}from"./StatusInput.e23556ff.js";import{T as G}from"./TemplateSelect.111ec7d1.js";import{u as K}from"./useCompanyScorecardTemplates.e2155997.js";import{u as N}from"./useScorecardTemplates.d510bf0b.js";import{u as U}from"./useBlackKiteEntities.1f753faa.js";import{u as z}from"./useUsers.1afafbd7.js";import{e as d}from"./attributeValue.ea53a720.js";import{s as W}from"./index.a885f488.js";import{t as Y}from"./index.a9e2d71c.js";import"./ToolTip.b3716f9d.js";import"./ObjectDisplay.996997b8.js";import"./DynamicForm.34adc282.js";const C={};C.props={value:{key:"value",required:!1,type:Array},options:{key:"options",required:!0,type:Array}};C.setup=(t,a)=>{const e=t,s=a.emit;return{proxy:R(e,s)}};var H=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("BaseLabel",{staticClass:"flex flex-col p-4 lg:grid lg:grid-cols-3 lg:items-center lg:gap-1"},[e("span",{staticClass:"space-x-1"},[t._v(" Companies "),e("span",{staticClass:"text-red-500"},[t._v("*")])]),e("SimpleSelect",{staticClass:"lg:col-span-2",attrs:{multiple:""},model:{value:t.proxy,callback:function(s){t.proxy=s},expression:"proxy"}},[e("option",{domProps:{value:null}}),t._l(t.options,function(s){return e("option",{key:s.id,domProps:{value:s}},[e("div",{staticClass:"flex space-x-2"},[e("span",{staticClass:"text-semibold"},[t._v(" "+t._s(s.name)+" ")]),e("span",{staticClass:"text-sm text-gray-500"},[t._v("("+t._s(s.domain)+")")])])])})],2)],1)},J=[];const B={};var X=h(C,H,J,!1,Z,null,null,null);function Z(t){for(let a in B)this[a]=B[a]}const tt=function(){return X.exports}(),v={};v.props={value:{key:"value",required:!1,type:null},users:{key:"users",required:!0,type:Array},entities:{key:"entities",required:!0,type:Array},templates:{key:"templates",required:!0,type:Array},companies:{key:"companies",required:!0,type:Array}};v.setup=(t,a)=>{const e=t,s=a.emit,r=D(e,s),u=c(()=>e.entities.map(i=>({id:parseInt(i.CompanyId),name:i.CompanyName,domain:i.DomainName}))),p=c(()=>e.templates.map(({key:i})=>i));return{proxy:r,entityOptions:u,templateOptions:p}};v.components=Object.assign({TemplateSelect:G,AnalystInput:Q,StatusInput:F,BatchEntitiesSelectV3:tt},v.components);var et=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("section",{staticClass:"flex flex-col divide-y"},[e("div",{staticClass:"flex flex-col divide-y"},[e("h3",{staticClass:"p-4 font-display text-lg font-semibold"},[t._v("Template")]),e("TemplateSelect",{attrs:{options:t.templateOptions},model:{value:t.proxy.template,callback:function(s){t.$set(t.proxy,"template",s)},expression:"proxy.template"}})],1),e("div",{staticClass:"flex flex-col divide-y"},[e("h3",{staticClass:"p-4 font-display text-lg font-semibold"},[t._v(" Analyst Information ")]),e("AnalystInput",{attrs:{users:t.users},model:{value:t.proxy.analyst,callback:function(s){t.$set(t.proxy,"analyst",s)},expression:"proxy.analyst"}})],1),e("div",{staticClass:"flex flex-col divide-y"},[e("h3",{staticClass:"p-4 font-display text-lg font-semibold"},[t._v("Status")]),e("StatusInput",{model:{value:t.proxy.status,callback:function(s){t.$set(t.proxy,"status",s)},expression:"proxy.status"}})],1),e("div",{staticClass:"flex flex-col divide-y"},[e("h3",{staticClass:"p-4 font-display text-lg font-semibold"},[t._v("Select Companies")]),e("BatchEntitiesSelectV3",{attrs:{options:t.entityOptions},model:{value:t.proxy.entities,callback:function(s){t.$set(t.proxy,"entities",s)},expression:"proxy.entities"}})],1)])},st=[];const $={};var at=h(v,et,st,!1,nt,null,null,null);function nt(t){for(let a in $)this[a]=$[a]}const ot=function(){return at.exports}(),f={};f.setup=(t,a)=>{const e=g("id"),s=g("subscriptionId"),r=j.create(e,s),u=M(!1),p=[S.list(),U.list(e),N.list()],i=K.get(e),b=z.list(),q=c(()=>{var l;return(l=b.data.value)==null?void 0:l.map(o=>({id:{value:d(o,"sub")},name:d(o,"name")||"",title:d(o,"custom:title")||"",email:d(o,"email"),phone:d(o,"phone_number")||""})).find(o=>o.email==="consultingservices@whitehawk.com")}),_=S.read(e),A=c(()=>{if(_.data.value)return{id:{value:_.data.value.id},name:_.data.value.name}}),n=W(c(()=>{var m;const l=new Date,o=l.getUTCFullYear(),y=`Q${Math.ceil((l.getMonth()+1)/4)}`;return{id:e,company:A.value,analyst:q.value,template:((m=i.data.value)==null?void 0:m.split("/")[1])||"",status:{state:x.State.IN_PROGRESS,year:o,quarter:Y(y)},includeCmmc:!0,entities:[]}})),I=c(()=>n.value?!(n.value.entities.length>0&&n.value.analyst&&n.value.company&&n.value.status&&n.value.template):!0),E=V();async function T(){var l,o,y,m;if(n.value){const w={company:n.value.company,analyst:(l=n.value)==null?void 0:l.analyst,status:{year:2023,quarter:x.Quarter.Q1,state:x.State.COMPLETE},includeCmmc:(o=n.value)==null?void 0:o.includeCmmc,template:n.value.template,entities:(y=n.value)==null?void 0:y.entities},{response:O}=await r.mutateAsync(w);(m=O.batchId)!=null&&m.value&&E.push(`/admin/companies/${e.value}/subscriptions/${s.value}/integrations/2/scorecards/batch`)}}return{isLoading:u,queries:p,users:b,batch:n,isDisabled:I,createBatch:T}};f.components=Object.assign({BackButton:L,BatchScorecardInputV3:ot,LoadingSpinner:P},f.components);var it=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"space-y-6"},[e("div",{staticClass:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4"},[e("BackButton"),e("div",{staticClass:"flex flex-col -space-y-1"},[e("BaseTypography",{staticClass:"uppercase text-gray-500",attrs:{variant:"overline"}},[t._v(" Black Kite ")]),e("BaseTypography",{attrs:{variant:"h5",component:"h2"}},[t._v(" Batch Scorecard ")])],1)],1),e("BaseSimpleCard",[e("form",{staticClass:"divide-y",on:{submit:function(s){return s.preventDefault(),t.createBatch.apply(null,arguments)}}},[e("BaseVueQueries",{attrs:{queries:t.queries},scopedSlots:t._u([{key:"success",fn:function(s){var r=s[0],u=s[1],p=s[2];return[e("BatchScorecardInputV3",{attrs:{users:t.users.data.value||[],companies:r,entities:u,templates:p},model:{value:t.batch,callback:function(i){t.batch=i},expression:"batch"}})]}}])}),e("div",{staticClass:"p-4"},[e("BaseButton",{staticClass:"w-full md:w-auto",attrs:{disabled:t.isDisabled}},[t.isLoading?e("LoadingSpinner"):e("span",[t._v("Generate Batch")])],1)],1)],1)])],1)},lt=[];const k={};var rt=h(f,it,lt,!1,ct,null,null,null);function ct(t){for(let a in k)this[a]=k[a]}const St=function(){return rt.exports}();export{St as default};
