import{ah as I,aP as h,aQ as $,aT as R,aD as G,d as u,aS as r,br as A,n as F,bs as q,c7 as x}from"./index.c975f769.js";import{A as K,T as U}from"./AppTanStackTable.e77b08be.js";import{G as c}from"./GradeLetterDisplay.42b011c8.js";import{c as j}from"./createOnChangeFn.3ff3c8ff.js";import{u as P}from"./createSimpleTable.7a560502.js";import{u as Q}from"./useBlackKiteEntities.279fb865.js";import"./magnifying-glass.b7cbe8fe.js";import"./TransitionExpand.f3df4458.js";import"./chevron-up.736f4142.js";const M={list(e){return I(["companies",e,"black-kite","report-summaries"],()=>h.get(`${$}/companies/${e.value}/black-kite/report-summaries`).then(s=>s.data))}},B={set(e){const s=R();return G(()=>h.post(`${$}/companies/${e.value}/black-kite/sync`).then(t=>t.data),{onSuccess(){s.invalidateQueries(["companies",e,"black-kite","sync"],{exact:!0})}})},get(e){return I(["companies",e,"black-kite","sync"],()=>h.get(`${$}/companies/${e.value}/black-kite/sync`).then(s=>s.data))}},l={};l.props={id:{key:"id",required:!0,type:String},subId:{key:"subId",required:!1,type:String},entities:{key:"entities",required:!0,type:Array},summaries:{key:"summaries",required:!0,type:Array}};l.setup=(e,s)=>{const t=e,i=u(()=>t.id),o=u(()=>t.subId),p=u(()=>{const a=[];return t.entities.map(b=>{var f;const{CompanyId:g,DomainName:d,CompanyName:k}=b,y=(f=t.summaries.find(S=>S.data.DomainValue===d))==null?void 0:f.data;y&&a.push({id:g,name:k,domain:d,summary:y})}),a}),m=u(()=>p.value.map(a=>{const{id:b,name:g,domain:d,summary:k}=a,{GradeLetter:y,Reputation:f,Privacy:S,Resiliency:D,Safeguard:V,LastUpdatedAt:E}=k;return{id:b,name:g,domain:d,summary:y,reputation:f.GradeLetter,privacy:S.GradeLetter,resiliency:D.GradeLetter,safeguard:V.GradeLetter,lastUpdated:E}})),n=j(),_=[n.accessor("name",{header:()=>"Name",enableColumnFilter:!1}),n.accessor("domain",{header:()=>"Domain",enableColumnFilter:!1}),n.accessor("summary",{header:()=>"Summary",cell:a=>r(c,{props:{grade:a.getValue()}}),enableColumnFilter:!1}),n.accessor("reputation",{header:()=>"Reputation",cell:a=>r(c,{props:{grade:a.getValue()}}),enableColumnFilter:!1}),n.accessor("privacy",{header:()=>"Privacy",cell:a=>r(c,{props:{grade:a.getValue()}}),enableColumnFilter:!1}),n.accessor("resiliency",{header:()=>"Resiliency",cell:a=>r(c,{props:{grade:a.getValue()}}),enableColumnFilter:!1}),n.accessor("safeguard",{header:()=>"Safeguard",cell:a=>r(c,{props:{grade:a.getValue()}}),enableColumnFilter:!1}),n.accessor("lastUpdated",{header:()=>"LastUpdated",cell:a=>r(A,{props:{value:a.getValue(),format:"date"}}),enableColumnFilter:!1}),n.display({id:"actions",header:"Actions",cell:({row:a})=>r(U,{props:{actions:[{id:"view",to:o.value?`/admin/companies/${i.value}/subscriptions/${o.value}/integrations/2/entities/${a.original.id}`:`/admin/companies/${i.value}/cyber-risk-rating/rating-service-2/entities/${a.original.id}`}]}})})];return{instance:P(m,_)}};l.components=Object.assign({AppTanStackTable:K},l.components);var N=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("AppTanStackTable",{attrs:{table:e.instance}})},w=[];const L={};var H=F(l,N,w,!1,O,null,null,null);function O(e){for(let s in L)this[s]=L[s]}const z=function(){return H.exports}(),v={};v.setup=(e,s)=>{const t=x("id"),i=x("subscriptionId"),o=B.get(t),p=B.set(t),m=Q.list(t),n=M.list(t),_=u(()=>p.isLoading.value||m.isLoading.value||n.isLoading.value);async function C(){await p.mutateAsync()}return{id:t,subscriptionId:i,syncStatus:o,entities:m,summaries:n,isLoading:_,createSync:C}};v.components=Object.assign({BackButton:q,DateIsoStringDisplay:A,BlackKiteEntitiesTable:z},v.components);var J=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("BaseTablePageLayout",{scopedSlots:e._u([{key:"backButton",fn:function(){return[t("BackButton",{attrs:{link:".."}})]},proxy:!0},{key:"overline",fn:function(){return[e._v("Black Kite")]},proxy:!0},{key:"title",fn:function(){return[e._v("Entities")]},proxy:!0},{key:"button",fn:function(){return[t("div",{staticClass:"flex flex-col items-end justify-end"},[t("div",{staticClass:"space-y-1"},[t("BaseButton",{attrs:{shape:"rectangle",type:"button",disabled:e.isLoading},on:{click:e.createSync}},[e._v(" Update ")])],1),t("BaseVueQuery",{attrs:{query:e.syncStatus},scopedSlots:e._u([{key:"success",fn:function(i){var o=i.data;return[t("BaseTypography",{staticClass:"uppercase text-gray-500",attrs:{variant:"overline"}},[e._v(" Last Synced: "),t("DateIsoStringDisplay",{attrs:{value:o.meta.updatedAt}})],1)]}}])})],1)]},proxy:!0},{key:"table",fn:function(){return[t("BlackKiteEntitiesTable",{attrs:{id:e.id,"sub-id":e.subscriptionId,entities:e.entities.data.value||[],summaries:e.summaries.data.value||[]}})]},proxy:!0}])})},W=[];const T={};var X=F(v,J,W,!1,Y,null,null,null);function Y(e){for(let s in T)this[s]=T[s]}const ce=function(){return X.exports}();export{ce as default};
