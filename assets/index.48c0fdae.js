import{I as V,c as F,G as I,d as u,$ as q,v as d,g as _,h,n as T,P as B,bG as P}from"./index.61046fbe.js";import{A as U,R as j}from"./RowSelectionInput.da42a64a.js";import{A as D,T as N}from"./AppTanStackTable.a89d8f92.js";import{S as Q}from"./ScorecardStatusBadge.e2b5de10.js";import{u as E,c as O,i as p,r as G,h as z,g as H,f as Y,b as L,e as J,d as K}from"./createOnChangeFn.edc79ae8.js";import{F as W}from"./FileSaver.min.a81c6a61.js";import{u as X}from"./useInDepthScorecards.764ddc37.js";import"./magnifying-glass.b7cbe8fe.js";import"./chevron-left.0808b01b.js";import"./TransitionExpand.fd086ee6.js";import"./chevron-up.736f4142.js";const g={};g.props={id:{key:"id",required:!0,type:String},scorecards:{key:"scorecards",required:!0,type:Array}};g.setup=(s,a)=>{const t=s,i=V(),v=F(()=>t.scorecards.map(e=>{var c,f;const r=new Date,o=((c=e.yearQuarterValue.split("/")[0])==null?void 0:c.trim())||r.getUTCFullYear().toString(),l=((f=e.yearQuarterValue.split("/")[1])==null?void 0:f.trim())||`Q${Math.ceil((r.getMonth()+1)/3)}`;return{id:e.id,supplier:e.data["Supplier Name"]||"",status:e.status,year:o,quarter:l,updatedAt:e.data.updatedAt||r.toString()}})),M=F(()=>v.value.filter(e=>e.supplier!==void 0)),S=I(),n=O(),k=[n.display({id:"select",header:({table:e})=>u(U,{props:{table:e}}),cell:({row:e})=>u(j,{props:{row:e}})}),n.accessor(e=>e.supplier,{id:"supplier",header:()=>"Supplier",cell:e=>e.getValue()}),n.accessor("status",{header:()=>"Status",cell:e=>u(Q,{props:{value:e.getValue()}}),enableColumnFilter:!1}),n.accessor("quarter",{header:()=>"Quarter",cell:e=>e.getValue()}),n.accessor("year",{header:()=>"Year",cell:e=>e.getValue(),filterFn:"weakEquals"}),n.accessor("updatedAt",{header:()=>"Last Updated",cell:e=>u(q,{props:{value:e.getValue(),format:"date"}}),enableColumnFilter:!1}),n.display({id:"actions",header:"Actions",cell:({row:e})=>u(N,{props:{actions:[{id:"edit",action(){i.push(`/admin/companies/${encodeURIComponent(t.id)}/scorecards/in-depth/rating-service-1/${e.original.id}`)}},{id:"download",async action(){const r=await _(`${h}/companies/${t.id}/scorecards/${e.original.id}/docx`,{responseType:"blob"}),o=`${e.original.supplier} Scorecard ${e.original.quarter} ${e.original.id}.docx`;W.exports.saveAs(r.data,o)}},{id:"archive",async action(){(await _.delete(`${h}/companies/${t.id}/scorecards/${e.original.id}`)).status===200&&S.success("Archived Scorecard Successfully")}}]}})})],y=d([]),$=d({pageIndex:0,pageSize:10}),b=d(""),w=d([]),R=d({}),C=E({get data(){return M.value},columns:k,state:{get sorting(){return y.value},get pagination(){return $.value},get globalFilter(){return b.value},get columnFilters(){return w.value},get rowSelection(){return R.value}},onSortingChange:p(y),onPaginationChange:p($),onColumnFiltersChange:p(w),onGlobalFilterChange:p(b),globalFilterFn:(e,r,o,l)=>{const c=G(e.getValue(r),o,{threshold:z.CONTAINS});return l(c),c.passed},onRowSelectionChange:p(R),getCoreRowModel:H(),getSortedRowModel:Y(),getFacetedUniqueValues:L(),getPaginationRowModel:J(),getFilteredRowModel:K()});return{instance:C,bulkActions:[{id:"archive",async action(){const e=C.getSelectedRowModel().rows,r=e.length;let o=0;if(r>0){for(const l of e){const c=l.original.id;(await _.delete(`${h}/companies/${t.id}/scorecards/${c}`)).status===200&&o++}S.success(`Archived ${o}/${r} Scorecard(s) Successfully`),i.push(`/admin/companies/${t.id}/scorecards/in-depth/rating-service-1`)}}}]}};g.components=Object.assign({AppTanStackTable:D},g.components);var Z=function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("AppTanStackTable",{attrs:{table:s.instance,"table-actions":s.bulkActions}})},ee=[];const A={};var te=T(g,Z,ee,!1,se,null,null,null);function se(s){for(let a in A)this[a]=A[a]}const ae=function(){return te.exports}(),m={};m.setup=(s,a)=>{const t=P("id"),i=X.list(t);return{id:t,scorecards:i}};m.components=Object.assign({PlusSvg:B,ScorecardsTable:ae},m.components);var re=function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("div",{staticClass:"space-y-6"},[t("div",{staticClass:"flex items-center justify-between"},[t("div",{staticClass:"flex flex-col"},[t("BaseTypography",{staticClass:"uppercase text-gray-500",attrs:{variant:"overline"}},[s._v(" Rating Service 1 ")]),t("BaseTypography",{attrs:{variant:"h5",component:"h3"}},[s._v(" In-Depth Scorecards ")])],1),t("BaseButton",{staticClass:"space-x-1",attrs:{type:"button",to:`/admin/companies/${s.id}/scorecards/in-depth/rating-service-1/new`}},[t("PlusSvg",{staticClass:"w-5"}),t("span",[s._v("Scorecard")])],1)],1),t("BaseVueQuery",{attrs:{query:s.scorecards},scopedSlots:s._u([{key:"success",fn:function(i){var v=i.data;return[t("ScorecardsTable",{attrs:{id:s.id,scorecards:v}})]}}])})],1)},oe=[];const x={};var ne=T(m,re,oe,!1,ce,null,null,null);function ce(s){for(let a in x)this[a]=x[a]}const ye=function(){return ne.exports}();export{ye as default};
