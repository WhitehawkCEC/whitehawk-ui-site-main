import{aT as g,aD as h,aP as T,aQ as x,d as c,bl as I,aG as $,aH as k,aS as _,n as S,an as E,bH as V,aF as F}from"./index.b7e0aeb0.js";import{A as B,T as D}from"./AppTanStackTable.5fcd85b2.js";import{C as N}from"./CompanyStatusBadge.8db9c5cc.js";import{c as Q}from"./createOnChangeFn.f6fb3471.js";import{u as j}from"./createSimpleTable.a313dc21.js";import"./magnifying-glass.b7cbe8fe.js";import"./chevron-up.736f4142.js";const H={set(){const e=g();return h(t=>T.put(`${x}/companies/${t.id}`,t).then(n=>n.data),{onSuccess(t){console.log(t.id+" "+t.status),e.invalidateQueries(["companies"],{exact:!0}),e.invalidateQueries(["companies",t.id],{exact:!0})}})}},m={};m.props={value:{key:"value",required:!0,type:Array}};m.setup=(e,t)=>{const n=e,o=t.emit,r=c(()=>n.value),d=I(),v=c(()=>d.companies),u=$(),i=k(),b=c(()=>i.isAdmin),y=c(()=>{var s;return((s=i.email)==null?void 0:s.split("@")[1])==="whitehawk.com"&&b.value}),l=Q(),A=[l.accessor("id",{header:()=>"ID",enableColumnFilter:!1}),l.accessor("name",{header:()=>"Name",enableColumnFilter:!1}),l.accessor("domain",{header:()=>"Domain",enableColumnFilter:!1}),l.accessor(a=>{var s;return(s=a.industry)==null?void 0:s.name},{id:"industry",header:()=>"Industry",enableColumnFilter:!1}),l.accessor(a=>a.status,{id:"status",header:()=>"Status",enableColumnFilter:!1,cell:a=>_(N,{props:{value:a.getValue()}})}),l.display({id:"actions",header:"Actions",cell:({row:a})=>_(D,{props:{actions:[{id:"edit",to:`/admin/companies/${a.original.id}/settings`},{id:"view",async action(){await u.setCompanyId(a.original.id)},isDisabled:c(()=>!v.value.find(s=>s.id===a.original.id))},{id:"activate",action(){o("activate",a.original)},isDisabled:c(()=>!y.value||a.original.status==="ACTIVE")},{id:"inactivate",action(){o("inactivate",a.original)},isDisabled:c(()=>{var s;return!y.value||a.original.status==="INACTIVE"||((s=u.company)==null?void 0:s.id)===a.original.id})}].filter(s=>a.original.status==="ACTIVE"&&s.id!=="activate"||a.original.status==="INACTIVE"&&s.id!=="inactivate")}})})];return{instance:j(r,A)}};m.components=Object.assign({AppTanStackTable:B},m.components);var P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("AppTanStackTable",{attrs:{table:e.instance}})},U=[];const f={};var q=S(m,P,U,!1,L,null,null,null);function L(e){for(let t in f)this[t]=f[t]}const M=function(){return q.exports}(),p={};p.setup=(e,t)=>{const n=V.list(),o=F(),r=H.set();async function d(u){const i={...u,status:"ACTIVE"};await r.mutateAsync(i),o.success("Successfully activated company "+i.name+".")}async function v(u){const i={...u,status:"INACTIVE"};await r.mutateAsync(i),o.success("Successfully inactivated company "+i.name+".")}return{companyList:n,activateCompany:d,inactivateCompany:v}};p.components=Object.assign({PlusSvg:E,CompaniesTable:M},p.components);var O=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("BaseTablePageLayout",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v("Companies")]},proxy:!0},{key:"button",fn:function(){return[n("BaseButton",{staticClass:"space-x-1",attrs:{to:"/admin/companies/new",type:"button"}},[n("PlusSvg",{staticClass:"w-5"}),n("span",[e._v("Company")])],1)]},proxy:!0},{key:"table",fn:function(){return[n("BaseVueQuery",{attrs:{query:e.companyList},scopedSlots:e._u([{key:"success",fn:function(o){var r=o.data;return[n("CompaniesTable",{attrs:{value:r},on:{activate:e.activateCompany,inactivate:e.inactivateCompany}})]}}])})]},proxy:!0}])})},R=[];const C={};var w=S(p,O,R,!1,z,null,null,null);function z(e){for(let t in C)this[t]=C[t]}const te=function(){return w.exports}();export{te as default};
