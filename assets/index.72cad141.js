import{D}from"./document-arrow-down.8787241b.js";import{ah as M,aP as V,aQ as q,aB as T,d as $,aS as g,br as N,a_ as x,az as P,n as w,ax as j,bs as L,L as O,ca as R,b as F,aK as E}from"./index.37a35517.js";import{A as U,R as Z}from"./RowSelectionInput.72bcc815.js";import{A as z,T as Q}from"./AppTanStackTable.ee70b5c3.js";import{S as H}from"./ScorecardStatusBadge.736a4ee7.js";import{u as K,c as G,i as S,r as Y,h as J,g as W,f as X,b as ee,e as ae,d as te}from"./createOnChangeFn.3130612c.js";import"./magnifying-glass.b7cbe8fe.js";import"./chevron-up.736f4142.js";const se={list(e){return M(["companies",e,"scorecards-v2"],()=>V.get(`${q}/companies/${e.value}/scorecards-v2`).then(s=>s.data))}},f={};f.props={id:{key:"id",required:!0,type:String},value:{key:"value",required:!1,type:Array},scorecards:{key:"scorecards",required:!0,type:Array}};f.setup=(e,s)=>{const a=e,r=s.emit,l=T(a,r),o=$(()=>a.scorecards.map(({id:t,data:i,meta:c})=>{const{supplier:C,status:u}=i;return{id:t,supplier:C.name,status:u.state,year:u.year,quarter:u.quarter,updatedAt:c.updatedAt}})),n=G(),b=[n.display({id:"select",header:({table:t})=>g(U,{props:{table:t}}),cell:({row:t})=>g(Z,{props:{row:t}})}),n.accessor(t=>t.supplier,{id:"supplier",header:()=>"Supplier",cell:t=>t.getValue(),enableColumnFilter:!1}),n.accessor("status",{header:()=>"Status",cell:t=>g(H,{props:{value:t.getValue()}}),enableColumnFilter:!1}),n.accessor("quarter",{header:()=>"Quarter",cell:t=>t.getValue(),enableColumnFilter:!1}),n.accessor("year",{header:()=>"Year",cell:t=>t.getValue(),enableColumnFilter:!1}),n.accessor("updatedAt",{header:()=>"Last Updated",cell:t=>g(N,{props:{value:t.getValue(),format:"date"}}),enableColumnFilter:!1}),n.display({id:"actions",header:"Actions",cell:({row:t})=>g(Q,{props:{actions:[{id:"edit",to:`/admin/companies/${encodeURIComponent(a.id)}/scorecards/in-depth/rating-service-2/${t.original.id}`}]}})})],_=x([]),y=x({pageIndex:0,pageSize:10}),p=x(""),d=x({}),m=K({get data(){return o.value},columns:b,state:{get sorting(){return _.value},get pagination(){return y.value},get globalFilter(){return p.value},get rowSelection(){return d.value}},onSortingChange:S(_),onPaginationChange:S(y),onGlobalFilterChange:S(p),globalFilterFn:(t,i,c,C)=>{const u=Y(t.getValue(i),c,{threshold:J.CONTAINS});return C(u),u.passed},onRowSelectionChange:S(d),getCoreRowModel:W(),getSortedRowModel:X(),getFacetedUniqueValues:ee(),getPaginationRowModel:ae(),getFilteredRowModel:te()}),A=$(()=>m.getSelectedRowModel().rows);return P(A,t=>{const i=[];t.forEach(c=>{c.original&&i.push({scorecardId:c.original.id,supplierName:c.original.supplier})}),l.value=i},{immediate:!0}),{instance:m}};f.components=Object.assign({AppTanStackTable:z},f.components);var re=function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("AppTanStackTable",{attrs:{table:e.instance}})},oe=[];const k={};var ne=w(f,re,oe,!1,le,null,null,null);function le(e){for(let s in k)this[s]=k[s]}const ce=function(){return ne.exports}(),v={};v.props={id:{key:"id",required:!0,type:String},value:{key:"value",required:!1,type:null},scorecards:{key:"scorecards",required:!0,type:Array}};v.setup=(e,s)=>{const a=e,r=s.emit;return{proxy:j(a,r)}};v.components=Object.assign({ConvertScorecardsV2Table:ce},v.components);var ie=function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("section",{staticClass:"grid gap-6"},[a("ConvertScorecardsV2Table",{attrs:{id:e.id,scorecards:e.scorecards},model:{value:e.proxy.scorecards,callback:function(r){e.$set(e.proxy,"scorecards",r)},expression:"proxy.scorecards"}}),a("BaseSimpleCard",[a("BaseLabel",{staticClass:"flex flex-col p-4 lg:grid lg:grid-cols-3 lg:items-center"},[a("span",{staticClass:"after:content-['*']` after:text-red-700"},[e._v("File Name")]),a("div",{staticClass:"flex flex-col lg:col-span-2"},[a("BaseInput",{attrs:{type:"text",required:"","aria-required":"true"},model:{value:e.proxy.fileName,callback:function(r){e.$set(e.proxy,"fileName",r)},expression:"proxy.fileName"}})],1)])],1)],1)},ue=[];const B={};var pe=w(v,ie,ue,!1,de,null,null,null);function de(e){for(let s in B)this[s]=B[s]}const me=function(){return pe.exports}(),h={};h.setup=(e,s)=>{const a=R("id"),r=R("subscriptionId"),l=F(!1),o=F(),n=se.list(a),b=$(()=>{var p,d,m;return!((p=o.value)!=null&&p.fileName)||!((m=(d=o.value)==null?void 0:d.scorecards)!=null&&m.length)}),_=E();async function y(){if(!!o.value){l.value=!0;try{await V.post(`${q}/companies/${a.value}/batch/scorecards`,{fileName:o.value.fileName,supplierScorecardInfos:o.value.scorecards})}finally{l.value=!1}_.push(`/admin/companies/${a.value}/subscriptions/${r.value}/integrations/2/scorecards/zip-files`)}}return{id:a,isLoading:l,fileZip:o,scorecards:n,isDisabled:b,convert:y}};h.components=Object.assign({BackButton:L,ConvertScorecardsV2Input:me,LoadingSpinner:O,DocumentDownloadSvg:D},h.components);var ge=function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("div",{staticClass:"space-y-6"},[a("div",{staticClass:"flex flex-col space-y-4 lg:flex-row lg:items-center lg:space-x-4 lg:space-y-0"},[a("BackButton"),a("div",{staticClass:"flex flex-col -space-y-1"},[a("BaseOverline",{staticClass:"uppercase text-gray-500"},[e._v("Black Kite")]),a("BaseTypography",{attrs:{variant:"h5"}},[e._v("ZIP Files")])],1)],1),a("form",{staticClass:"space-y-6",on:{submit:function(r){return r.preventDefault(),e.convert.apply(null,arguments)}}},[a("BaseVueQuery",{attrs:{query:e.scorecards},scopedSlots:e._u([{key:"success",fn:function(r){var l=r.data;return[a("ConvertScorecardsV2Input",{attrs:{id:e.id,scorecards:l},model:{value:e.fileZip,callback:function(o){e.fileZip=o},expression:"fileZip"}})]}}])}),a("BaseButton",{staticClass:"space-x-2",attrs:{disabled:e.isDisabled}},[e.isLoading?a("LoadingSpinner"):[a("DocumentDownloadSvg",{staticClass:"-ml-1 w-5"}),a("span",[e._v("Convert")])]],2)],1)])},fe=[];const I={};var ve=w(h,ge,fe,!1,_e,null,null,null);function _e(e){for(let s in I)this[s]=I[s]}const Re=function(){return ve.exports}();export{Re as default};
