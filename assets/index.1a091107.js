import{R as D}from"./arrow-path.24b87f73.js";import{c,aS as I,n as k,L as B,aF as L,cF as F,cG as h,cH as j,cI as w,cJ as q,cK as V,b$ as G,cL as M,cM as N}from"./index.25835af6.js";import{A as H}from"./AppTanStackTable.e35b7de3.js";import{S as R,V as P,a as Y}from"./SyncStatusDisplay.261be18b.js";import{c as z}from"./createOnChangeFn.5167f836.js";import{u as J}from"./createSimpleTable.185c786c.js";import"./magnifying-glass.b7cbe8fe.js";import"./TransitionExpand.77f19c45.js";import"./check-circle.48e4a9f5.js";import"./chevron-up.736f4142.js";const S={};S.props={value:{key:"value",required:!0,type:Array}};S.setup=(e,s)=>{const n=e,l=c(()=>n.value),i=z(),u=[i.accessor("toBeSynced",{header:()=>"To Be Synced",cell:r=>I(R,{props:{value:r.getValue()}}),enableColumnFilter:!1}),i.group({id:"supplier",header:()=>"Supplier",columns:[i.accessor(r=>r.supplier.name,{id:"name",header:()=>"Name",enableColumnFilter:!1}),i.accessor(r=>r.supplier.name,{id:"domain",header:()=>"Domain",enableColumnFilter:!1})]}),i.accessor("syncedFromBlackKite",{header:()=>"Synced From Black Kite?",cell:r=>I(R,{props:{value:r.getValue()}}),enableColumnFilter:!1}),i.accessor("syncedFromCyberOne",{header:()=>"Synced From CyberOne?",cell:r=>I(R,{props:{value:r.getValue()}}),enableColumnFilter:!1})];return{instance:J(l,u)}};S.components=Object.assign({AppTanStackTable:H},S.components);var U=function(){var e=this,s=e.$createElement,n=e._self._c||s;return n("AppTanStackTable",{attrs:{table:e.instance}})},Q=[];const O={};var W=k(S,U,Q,!1,X,null,null,null);function X(e){for(let s in O)this[s]=O[s]}const Z=function(){return W.exports}(),f={};f.props={accountId:{key:"accountId",required:!0,type:String},vrmSync:{key:"vrmSync",required:!0,type:null},assets:{key:"assets",required:!0,type:Array},entities:{key:"entities",required:!0,type:Array}};f.setup=(e,s)=>{const n=e,l=c(()=>n.accountId),i=c(()=>n.entities.map(({domain:t})=>t)),u=c(()=>n.assets.map(({domain:t})=>t)),p=c(()=>n.assets.map(({referenceId:t,name:a,domain:o})=>{var y;return{blackKiteId:(y=n.entities.find(b=>b.domain===o))==null?void 0:y.id,cyberOneId:t,name:a,domain:o}})),r=c(()=>p.value.map(t=>({supplier:t,syncedFromBlackKite:t.domain?i.value.includes(t.domain):void 0,syncedFromCyberOne:t.domain?u.value.includes(t.domain):void 0,toBeSynced:t.domain?i.value.includes(t.domain)&&u.value.includes(t.domain):void 0}))),d=c(()=>{const t=[];return r.value.forEach(a=>{if(a.toBeSynced){const{blackKiteId:o,cyberOneId:y}=a.supplier;o&&t.push({target:{oneofKind:"cyberOneAssetId",cyberOneAssetId:y},source:{oneofKind:"blackKiteEntityId",blackKiteEntityId:o}})}}),t}),m=L(),_=F.create(l);async function v(){const t={syncType:h.SyncType.BLACK_KITE_TO_CYBER_ONE,entries:d.value},a=await _.mutateAsync(t);if(a){const o=a.response.syncId;m.success(`Sync ID: ${o}`)}}return{rows:r,mappings:d,syncCreate:_,createSync:v}};f.components=Object.assign({VrmSyncStatusDisplay:P,LoadingSpinner:B,SyncSvg:D,CyberRiskRatingSyncTable:Z},f.components);var ee=function(){var e=this,s=e.$createElement,n=e._self._c||s;return n("section",{staticClass:"space-y-6"},[n("div",{staticClass:"flex flex-col space-y-4 md:flex-row md:items-center md:justify-between md:space-y-0"},[n("VrmSyncStatusDisplay",{attrs:{header:"Cyber Risk Rating Sync",sync:e.vrmSync}}),n("BaseButton",{staticClass:"space-x-1",attrs:{disabled:e.mappings.length===0,shape:"rectangle"},on:{click:e.createSync}},[e.syncCreate.isLoading.value?n("LoadingSpinner"):n("SyncSvg",{staticClass:"w-4 xl:w-5"}),n("span",[e._v("Sync")])],1)],1),n("CyberRiskRatingSyncTable",{attrs:{value:e.rows}})],1)},te=[];const K={};var ne=k(f,ee,te,!1,se,null,null,null);function se(e){for(let s in K)this[s]=K[s]}const ae=function(){return ne.exports}(),g={};g.props={accountId:{key:"accountId",required:!0,type:String},syncType:{key:"syncType",required:!0,type:null}};g.setup=(e,s)=>{const n=e,l=c(()=>n.accountId),i=j.get(l),u=c(()=>{var a;return(a=i.data.value)==null?void 0:a.mappedEcosystemId}),p=w.get(l),r=c(()=>{var a;return(a=p.data.value)==null?void 0:a.mappedAssetId}),d=q.get(l),m=c(()=>d.data.value),_=V.get(l),v=c(()=>_.data.value);return{syncStatus:c(()=>{var a,o,y,b,T,$,A;return{source:{mappedSource:(a=u.value)==null?void 0:a.toString(),syncDate:(y=(o=m.value)==null?void 0:o.lastSynced)==null?void 0:y.value,syncedReports:(b=m.value)==null?void 0:b.reportsSynced},target:{mappedTarget:r.value,syncDate:($=(T=v.value)==null?void 0:T.lastSynced)==null?void 0:$.value,syncedReports:(A=v.value)==null?void 0:A.reportsSynced}}})}};g.components=Object.assign({SyncStatusDisplay:Y},g.components);var ce=function(){var e=this,s=e.$createElement,n=e._self._c||s;return n("SyncStatusDisplay",{attrs:{"sync-status":e.syncStatus,"sync-type":e.syncType}})},re=[];const x={};var oe=k(g,ce,re,!1,ie,null,null,null);function ie(e){for(let s in x)this[s]=x[s]}const le=function(){return oe.exports}(),C={};C.setup=(e,s)=>{const n=G("id"),l=F.list(n),i=c(()=>l.data.value?l.data.value.sort((t,a)=>{let o="",y="";return t.lastSynced&&t.lastSynced.value&&a.lastSynced&&a.lastSynced.value&&(o=t.lastSynced.value,y=a.lastSynced.value),o.localeCompare(y)}):[]),u=c(()=>i.value.find(t=>t.syncType===h.SyncType.BLACK_KITE_TO_CYBER_ONE)),p=M.list(n),r=c(()=>p.data.value||[]),d=N.list(n),m=c(()=>d.data.value||[]),_=c(()=>{var t,a,o;return{syncDate:(a=(t=u.value)==null?void 0:t.lastSynced)==null?void 0:a.value,syncedReports:(o=u.value)==null?void 0:o.numSynced}}),v=c(()=>{var t;return((t=u.value)==null?void 0:t.syncType)||h.SyncType.UNSPECIFIED});return{id:n,entities:r,assets:m,sync:_,syncType:v}};C.components=Object.assign({CyberRiskRatingSyncStatusDisplay:le,CyberRiskRatingSyncDisplay:ae},C.components);var ue=function(){var e=this,s=e.$createElement,n=e._self._c||s;return n("main",{staticClass:"space-y-6"},[n("CyberRiskRatingSyncStatusDisplay",{attrs:{"account-id":e.id,"sync-type":e.syncType}}),n("CyberRiskRatingSyncDisplay",{attrs:{"account-id":e.id,"vrm-sync":e.sync,entities:e.entities,assets:e.assets}})],1)},ye=[];const E={};var pe=k(C,ue,ye,!1,de,null,null,null);function de(e){for(let s in E)this[s]=E[s]}const Re=function(){return pe.exports}();export{Re as default};
