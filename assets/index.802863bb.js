import{ag as x,aP as k,aQ as B,c as u,n as y,bs as w,b$ as v,d9 as T,da as $}from"./index.8f31c2ce.js";import{T as M}from"./ToolTip.7e9e11ce.js";import{B as S}from"./BlackKiteReportCompliance.ff11b7e1.js";import{b as R}from"./BlackKiteProgressBar.28712be8.js";import{B as K,a as D}from"./BlackKiteSummaryDescription.36458199.js";import{T as A}from"./TodosChart.028a529b.js";import{C as H}from"./CmmcAnalysisDisplay.180af586.js";import"./exclamation-triangle.54812a62.js";import"./GradeLetterDisplay.2aaa3f09.js";import"./ratingScoreDescription.3b48b1ea.js";import"./TabbedPanel.4bc0e0d6.js";import"./BarChart.48daaa15.js";import"./chart.f4078cab.js";import"./_baseOrderBy.6d5d6e27.js";import"./_arrayMap.dcea68f3.js";import"./_baseIteratee.c7765c74.js";import"./_Uint8Array.dec0f9b0.js";import"./keys.e58e7c02.js";import"./_baseIsEqual.a570c06d.js";import"./_baseEach.4d556a10.js";const j={list(e,a){return x(["companies",e,"black-kite","entities",a,"performance"],()=>k.get(`${B}/companies/${e.value}/black-kite/entities/${a.value}/performance`).then(t=>t.data))}},_={};_.props={findings:{key:"findings",required:!0,type:null}};_.setup=(e,a)=>{const t=e,s=u(()=>["Critical","High","Medium","Low"]),r=u(()=>{const i=new Map;for(const p of Object.entries(t.findings)){const[n,l]=p,d=n.split(/(?=[A-Z])/)[0];if(d){const g=i.get(d);g?g.push({key:n,value:l}):i.set(d,[{key:n,value:l}])}}return i}),c=u(()=>[{header:"Failed",data:r.value.get("failed")||[]},{header:"Warning",data:r.value.get("warning")||[]},{header:"Passed",data:r.value.get("passed")||[]}]);function o(i){switch(i){case"failedCritical":return{bgColor:"bg-gradient-to-r from-red-900 to-red-800",textColor:"text-red-50"};case"failedHigh":return{bgColor:"bg-gradient-to-r from-red-800 to-red-700",textColor:"text-red-50"};case"failedMedium":return{bgColor:"bg-gradient-to-r from-red-700 to-red-600",textColor:"text-red-50"};case"failedLow":return{bgColor:"bg-gradient-to-r from-red-600 to-red-500",textColor:"text-red-50"};case"warningCritical":return{bgColor:"bg-gradient-to-r from-amber-900 to-amber-800",textColor:"text-amber-50"};case"warningHigh":return{bgColor:"bg-gradient-to-r from-amber-800 to-amber-700",textColor:"text-amber-50"};case"warningMedium":return{bgColor:"bg-gradient-to-r from-amber-700 to-amber-600",textColor:"text-amber-50"};case"warningLow":return{bgColor:"bg-gradient-to-r from-amber-600 to-amber-500",textColor:"text-amber-50"};case"passedCritical":return{bgColor:"bg-gradient-to-r from-green-900 to-green-800",textColor:"text-green-50"};case"passedHigh":return{bgColor:"bg-gradient-to-r from-green-800 to-green-700",textColor:"text-green-50"};case"passedMedium":return{bgColor:"bg-gradient-to-r from-green-700 to-green-600",textColor:"text-green-50"};case"passedLow":return{bgColor:"bg-gradient-to-r from-green-600 to-green-500",textColor:"text-green-50"};default:return{bgColor:"bg-gray-500",textColor:"text-white"}}}return{headers:s,rows:c,display:o}};var F=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("section",{staticClass:"overflow-x-auto pr-4 pb-4"},[t("table",{staticClass:"w-full text-center sm:table-fixed md:table-auto lg:table-fixed"},[t("thead",[t("tr",[t("td"),e._l(e.headers,function(s){return t("th",{key:s,staticClass:"px-4 py-4 text-center",attrs:{scope:"col",colspan:"1"}},[t("BaseTypography",{staticClass:"uppercase text-gray-700",attrs:{variant:"overline"}},[e._v(" "+e._s(s)+" ")])],1)})],2)]),t("tbody",e._l(e.rows,function(s){return t("tr",{key:s.header},[t("th",{staticClass:"px-4 py-2",attrs:{scope:"row"}},[t("BaseTypography",{staticClass:"uppercase text-gray-700",attrs:{variant:"overline"}},[e._v(" "+e._s(s.header)+" ")])],1),e._l(s.data,function(r){return t("td",{key:r.key,staticClass:"p-1"},[t("span",{staticClass:"flex justify-center space-y-1 rounded-xl p-3",class:e.display(r.key).bgColor},[t("BaseTypography",{class:e.display(r.key).textColor,attrs:{variant:"h3",component:"h6"}},[e._v(" "+e._s(r.value||"-")+" ")])],1)])})],2)}),0)])])},L=[];const C={};var O=y(_,F,L,!1,q,null,null,null);function q(e){for(let a in C)this[a]=C[a]}const I=function(){return O.exports}(),m={};m.props={id:{key:"id",required:!0,type:String},value:{key:"value",required:!0,type:Array}};m.setup=(e,a)=>{const t=e,s=u(()=>t.id),r=u(()=>{var i;const o={};for(const p of t.value){const{control:{number:n,description:l,type:d},isSatisfied:g}=p;d in o||(o[d]=[]),(i=o[d])==null||i.push({id:n,itemComplete:g,todoText:l})}for(const p of Object.values(o))p.sort((n,l)=>Number(n.id)-Number(l.id));return o});return{companyId:s,chartData:r,categories:["basic","foundational","organizational"]}};m.components=Object.assign({TodosChart:A},m.components);var P=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("TodosChart",{attrs:{value:e.chartData,"company-id":e.companyId,categories:e.categories,"can-add-notes":!1}})},Q=[];const h={};var z=y(m,P,Q,!1,E,null,null,null);function E(e){for(let a in h)this[a]=h[a]}const V=function(){return z.exports}(),f={};f.setup=(e,a)=>{const t=v("id"),s=v("entityId"),r=j.list(t,s),c=T.get(t),o=u(()=>{var i;return((i=c.data.value)==null?void 0:i.findings)||$.Findings.create()});return{id:t,performanceQuery:r,findings:o}};f.components=Object.assign({BackButton:w,BlackKiteSummaryDescription:K,BlackKiteReportSummary:D,ToolTip:M,BlackKiteHeatmap:I,BlackKiteReportRisk:R,BlackKiteReportCompliance:S,CisMaturityDisplay:V,CmmcAnalysisDisplay:H},f.components);var G=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("BaseVueQuery",{attrs:{query:e.performanceQuery},scopedSlots:e._u([{key:"success",fn:function(s){var r=s.data,c=r.reports,o=c.summary,i=c.risk,p=c.compliance,n=r.cmmcAnalysis,l=r.cisMaturity;return[t("section",{staticClass:"space-y-8"},[t("div",{staticClass:"flex flex-col sm:flex-row sm:items-center sm:space-x-4"},[t("BackButton"),t("BaseTypography",{staticClass:"capitalize",attrs:{variant:"h5",component:"h2"}},[e._v(" "+e._s(o.DomainValue)+" ")])],1),t("BaseSimpleCard",{staticClass:"divide-y"},[t("BaseTypography",{staticClass:"p-4",attrs:{component:"h3",variant:"subtitle3"}},[e._v(" Summary ")]),t("BlackKiteSummaryDescription",{attrs:{score:parseInt(o.GradeOver100),date:o.LastUpdatedAt}}),t("BlackKiteReportSummary",{attrs:{summary:o}})],1),t("BaseSimpleCard",{staticClass:"divide-y"},[t("div",{staticClass:"flex items-center space-x-2 p-4"},[t("BaseTypography",{attrs:{component:"h3",variant:"subtitle3"}},[e._v(" Vulnerability Heat Map ")]),t("ToolTip",[e._v(" This heat map is the graphical distribution of vulnerabilities where the status and the severity of each finding are represented as the total number in each cell. Please note that 'Leaked Credentials' are represented as 1 (even if there are thousands) in order not to skew the chart. ")])],1),t("BlackKiteHeatmap",{attrs:{findings:e.findings}})],1),t("BaseSimpleCard",{staticClass:"divide-y"},[t("BaseTypography",{staticClass:"p-4",attrs:{component:"h3",variant:"subtitle3"}},[e._v(" Risk ")]),t("BlackKiteReportRisk",{attrs:{risk:i}})],1),t("BaseSimpleCard",{staticClass:"divide-y"},[t("BaseTypography",{staticClass:"p-4",attrs:{component:"h3",variant:"subtitle3"}},[e._v(" Compliance ")]),t("BlackKiteReportCompliance",{attrs:{compliance:p}})],1),t("BaseSimpleCard",{staticClass:"divide-y"},[t("BaseTypography",{staticClass:"p-4",attrs:{component:"h3",variant:"subtitle3"}},[e._v(" CIS Maturity ")]),t("CisMaturityDisplay",{attrs:{id:e.id,value:l}})],1),t("div",{staticClass:"space-y-2"},[t("div",{staticClass:"flex items-start space-x-2"},[t("BaseTypography",{attrs:{component:"h3",variant:"subtitle3"}},[e._v(" CMMC Analysis ")]),t("ToolTip",[e._v(" WhiteHawk is aware of the ongoing changes to CMMC and will update our offerings accordingly as the Office of the Secretary of Defense publishes their updated guidance and timelines between now and 2nd quarter 2023. ")])],1),t("CmmcAnalysisDisplay",{attrs:{value:n}})],1)],1)]}}])})},N=[];const b={};var U=y(f,G,N,!1,W,null,null,null);function W(e){for(let a in b)this[a]=b[a]}const yt=function(){return U.exports}();export{yt as default};
