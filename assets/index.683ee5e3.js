import{c as v,a9 as h,n as _,ao as D,c0 as A,aI as x,cR as $,r as L,cW as C}from"./index.fcbecd88.js";import{A as w}from"./AppVueGoodTable.01d91c80.js";import{L as S}from"./LicenseTypeMapQuantitiesInput.c0fd5ac1.js";import"./index.022de84c.js";import"./DynamicForm.e1313da4.js";const d={};d.props={licenseBatches:{key:"licenseBatches",required:!0,type:Array}};d.setup=(e,n)=>{const t=e;return{rows:v(()=>t.licenseBatches.map(c=>{const{usage:a}=c,o=a.validity.start,r=h(o),u=a.validity.end,l=h(u);return{id:a.id,startDate:r,startDateDisplay:r.toLocaleString(),endDate:l,endDateDisplay:l.toLocaleString(),oneTimeQuantity:a.counts.oneTime.quantity,oneTimeAvailable:a.counts.oneTime.available,oneTimeUsed:a.counts.oneTime.used,annualQuantity:a.counts.annual.quantity,annualAvailable:a.counts.annual.available,annualUsed:a.counts.annual.used}})),columns:[{label:"Batch ID",field:"id"},{label:"Start Date",field:"startDate"},{label:"End Date",field:"endDate"},{label:"One Time Total",field:"oneTimeQuantity"},{label:"One Time Available",field:"oneTimeAvailable"},{label:"One Time Used",field:"oneTimeUsed"},{label:"Annual Total",field:"annualQuantity"},{label:"Annual Available",field:"annualAvailable"},{label:"Annual Used",field:"annualUsed"}]}};d.components=Object.assign({AppVueGoodTable:w},d.components);var U=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("AppVueGoodTable",{staticClass:"p-4",attrs:{columns:e.columns,rows:e.rows},scopedSlots:e._u([{key:"table-row",fn:function(s){var i=s.row,c=s.column,a=s.formattedRow;return[c.field==="startDate"?[t("time",{attrs:{datetime:i.startDate}},[e._v(" "+e._s(i.startDateDisplay)+" ")])]:c.field==="endDate"?[t("time",{attrs:{datetime:i.endDate}},[e._v(" "+e._s(i.endDateDisplay)+" ")])]:[e._v(" "+e._s(a[c.field])+" ")]]}}])})},q=[];const T={};var O=_(d,U,q,!1,R,null,null,null);function R(e){for(let n in T)this[n]=T[n]}const I=function(){return O.exports}(),p={};p.props={value:{key:"value",required:!0,type:Array}};p.setup=(e,n)=>{const t=e;function s(a){return a||{quantity:0,available:0,used:0}}function i(a){var o,r,u,l,f,y,b;return{id:((o=a.id)==null?void 0:o.value)||"",validity:{start:((u=(r=a.validity)==null?void 0:r.start)==null?void 0:u.value)||"",end:((f=(l=a.validity)==null?void 0:l.end)==null?void 0:f.value)||""},counts:{annual:s((y=a.counts)==null?void 0:y.annual),oneTime:s((b=a.counts)==null?void 0:b.oneTime)}}}return{converted:v(()=>t.value.map(a=>{var o;return{id:((o=a.id)==null?void 0:o.value)||"",usage:i(a.usage||{}),meta:{createdAt:"",updatedAt:""}}}))}};p.components=Object.assign({PortfolioOrdersTable:I},p.components);var Q=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("PortfolioOrdersTable",{attrs:{"license-batches":e.converted}})},j=[];const g={};var k=_(p,Q,j,!1,M,null,null,null);function M(e){for(let n in g)this[n]=g[n]}const P=function(){return k.exports}(),m={};m.setup=(e,n)=>{const t=A("id"),s=A("groupId"),i=x(),c=$.list(t),a=v(()=>{var l;return((l=c.data.value)==null?void 0:l.values)||[]}),o=L({annual:0,oneTime:0}),r=C.create(t,s);async function u(){await r.mutateAsync({quantities:o.value}),i.push(`/admin/companies/${t.value}/scorecards/portfolio/groups/${s.value}`)}return{accountLicenseBatches:c,licenseBatchUsages:a,quantities:o,create:u}};m.components=Object.assign({LicenseTypeMapQuantitiesInput:S,PlusSvg:D,AccountLicenseBatchUsageTable:P},m.components);var E=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("section",{staticClass:"space-y-6"},[t("BaseSimpleCard",{staticClass:"divide-y"},[t("h2",{staticClass:"p-4 font-display text-lg font-semibold"},[e._v(" Add Group License Batch ")]),t("form",{staticClass:"divide-y",on:{submit:function(s){return s.preventDefault(),e.create.apply(null,arguments)}}},[t("LicenseTypeMapQuantitiesInput",{model:{value:e.quantities,callback:function(s){e.quantities=s},expression:"quantities"}}),t("div",{staticClass:"p-4"},[t("div",{staticClass:"md:inline-flex"},[t("BaseButton",{staticClass:"w-full space-x-2 md:w-auto",attrs:{"display-type":"info"}},[t("PlusSvg",{staticClass:"h-auto w-4 xl:w-5"}),t("span",[e._v("Add License Batch")])],1)],1)])],1)]),t("BaseSimpleCard",{staticClass:"divide-y"},[t("h2",{staticClass:"p-4 font-display text-lg font-semibold"},[e._v(" Available Account Licenses ")]),t("div",[t("BaseVueQuery",{attrs:{query:e.accountLicenseBatches},scopedSlots:e._u([{key:"success",fn:function(){return[t("AccountLicenseBatchUsageTable",{attrs:{value:e.licenseBatchUsages}})]},proxy:!0}])})],1)])],1)},G=[];const B={};var F=_(m,E,G,!1,V,null,null,null);function V(e){for(let n in B)this[n]=B[n]}const N=function(){return F.exports}();export{N as default};
